import{j as u}from"./radix-iWwMWcLP.js";import{a as Jw,r as b,R as co}from"./vendor-nf7bT_Uh.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var yc={},nd=Jw;yc.createRoot=nd.createRoot,yc.hydrateRoot=nd.hydrateRoot;/**
 * react-router v7.7.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var sd="popstate";function Zw(t={}){function e(s,r){let{pathname:i,search:o,hash:c}=s.location;return _c("",{pathname:i,search:o,hash:c},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:Lr(r)}return tx(e,n,null,t)}function pe(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function gt(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ex(){return Math.random().toString(36).substring(2,10)}function rd(t,e){return{usr:t.state,key:t.key,idx:e}}function _c(t,e,n=null,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Vs(e):e,state:n,key:e&&e.key||s||ex()}}function Lr({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Vs(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substring(s),t=t.substring(0,s)),t&&(e.pathname=t)}return e}function tx(t,e,n,s={}){let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,c="POP",l=null,h=d();h==null&&(h=0,o.replaceState({...o.state,idx:h},""));function d(){return(o.state||{idx:null}).idx}function m(){c="POP";let C=d(),S=C==null?null:C-h;h=C,l&&l({action:c,location:P.location,delta:S})}function p(C,S){c="PUSH";let T=_c(P.location,C,S);h=d()+1;let k=rd(T,h),L=P.createHref(T);try{o.pushState(k,"",L)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;r.location.assign(L)}i&&l&&l({action:c,location:P.location,delta:1})}function y(C,S){c="REPLACE";let T=_c(P.location,C,S);h=d();let k=rd(T,h),L=P.createHref(T);o.replaceState(k,"",L),i&&l&&l({action:c,location:P.location,delta:0})}function x(C){return nx(C)}let P={get action(){return c},get location(){return t(r,o)},listen(C){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(sd,m),l=C,()=>{r.removeEventListener(sd,m),l=null}},createHref(C){return e(r,C)},createURL:x,encodeLocation(C){let S=x(C);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:p,replace:y,go(C){return o.go(C)}};return P}function nx(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),pe(n,"No window.location.(origin|href) available to create URL");let s=typeof t=="string"?t:Lr(t);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=n+s),new URL(s,n)}function Ap(t,e,n="/"){return sx(t,e,n,!1)}function sx(t,e,n,s){let r=typeof e=="string"?Vs(e):e,i=Bt(r.pathname||"/",n);if(i==null)return null;let o=Sp(t);rx(o);let c=null;for(let l=0;c==null&&l<o.length;++l){let h=px(i);c=fx(o[l],h,s)}return c}function Sp(t,e=[],n=[],s=""){let r=(i,o,c)=>{let l={relativePath:c===void 0?i.path||"":c,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(pe(l.relativePath.startsWith(s),`Absolute route path "${l.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(s.length));let h=$t([s,l.relativePath]),d=n.concat(l);i.children&&i.children.length>0&&(pe(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),Sp(i.children,e,d,h)),!(i.path==null&&!i.index)&&e.push({path:h,score:hx(h,i.index),routesMeta:d})};return t.forEach((i,o)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))r(i,o);else for(let l of Np(i.path))r(i,o,l)}),e}function Np(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=Np(s.join("/")),c=[];return c.push(...o.map(l=>l===""?i:[i,l].join("/"))),r&&c.push(...o),c.map(l=>t.startsWith("/")&&l===""?"/":l)}function rx(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:dx(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}var ix=/^:[\w-]+$/,ox=3,ax=2,cx=1,lx=10,ux=-2,id=t=>t==="*";function hx(t,e){let n=t.split("/"),s=n.length;return n.some(id)&&(s+=ux),e&&(s+=ax),n.filter(r=>!id(r)).reduce((r,i)=>r+(ix.test(i)?ox:i===""?cx:lx),s)}function dx(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function fx(t,e,n=!1){let{routesMeta:s}=t,r={},i="/",o=[];for(let c=0;c<s.length;++c){let l=s[c],h=c===s.length-1,d=i==="/"?e:e.slice(i.length)||"/",m=lo({path:l.relativePath,caseSensitive:l.caseSensitive,end:h},d),p=l.route;if(!m&&h&&n&&!s[s.length-1].route.index&&(m=lo({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},d)),!m)return null;Object.assign(r,m.params),o.push({params:r,pathname:$t([i,m.pathname]),pathnameBase:wx($t([i,m.pathnameBase])),route:p}),m.pathnameBase!=="/"&&(i=$t([i,m.pathnameBase]))}return o}function lo(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=mx(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),c=r.slice(1);return{params:s.reduce((h,{paramName:d,isOptional:m},p)=>{if(d==="*"){let x=c[p]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const y=c[p];return m&&!y?h[d]=void 0:h[d]=(y||"").replace(/%2F/g,"/"),h},{}),pathname:i,pathnameBase:o,pattern:t}}function mx(t,e=!1,n=!0){gt(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,l)=>(s.push({paramName:c,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function px(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return gt(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Bt(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}function gx(t,e="/"){let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?Vs(t):t;return{pathname:n?n.startsWith("/")?n:yx(n,e):e,search:xx(s),hash:vx(r)}}function yx(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function Va(t,e,n,s){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function _x(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function pl(t){let e=_x(t);return e.map((n,s)=>s===e.length-1?n.pathname:n.pathnameBase)}function gl(t,e,n,s=!1){let r;typeof t=="string"?r=Vs(t):(r={...t},pe(!r.pathname||!r.pathname.includes("?"),Va("?","pathname","search",r)),pe(!r.pathname||!r.pathname.includes("#"),Va("#","pathname","hash",r)),pe(!r.search||!r.search.includes("#"),Va("#","search","hash",r)));let i=t===""||r.pathname==="",o=i?"/":r.pathname,c;if(o==null)c=n;else{let m=e.length-1;if(!s&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),m-=1;r.pathname=p.join("/")}c=m>=0?e[m]:"/"}let l=gx(r,c),h=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(h||d)&&(l.pathname+="/"),l}var $t=t=>t.join("/").replace(/\/\/+/g,"/"),wx=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),xx=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,vx=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function bx(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var Pp=["POST","PUT","PATCH","DELETE"];new Set(Pp);var Tx=["GET",...Pp];new Set(Tx);var Ms=b.createContext(null);Ms.displayName="DataRouter";var Fo=b.createContext(null);Fo.displayName="DataRouterState";b.createContext(!1);var Cp=b.createContext({isTransitioning:!1});Cp.displayName="ViewTransition";var Ex=b.createContext(new Map);Ex.displayName="Fetchers";var Ix=b.createContext(null);Ix.displayName="Await";var wt=b.createContext(null);wt.displayName="Navigation";var oi=b.createContext(null);oi.displayName="Location";var Mt=b.createContext({outlet:null,matches:[],isDataRoute:!1});Mt.displayName="Route";var yl=b.createContext(null);yl.displayName="RouteError";function Ax(t,{relative:e}={}){pe(Ls(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=b.useContext(wt),{hash:r,pathname:i,search:o}=ai(t,{relative:e}),c=i;return n!=="/"&&(c=i==="/"?n:$t([n,i])),s.createHref({pathname:c,search:o,hash:r})}function Ls(){return b.useContext(oi)!=null}function xt(){return pe(Ls(),"useLocation() may be used only in the context of a <Router> component."),b.useContext(oi).location}var Rp="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function kp(t){b.useContext(wt).static||b.useLayoutEffect(t)}function Os(){let{isDataRoute:t}=b.useContext(Mt);return t?Fx():Sx()}function Sx(){pe(Ls(),"useNavigate() may be used only in the context of a <Router> component.");let t=b.useContext(Ms),{basename:e,navigator:n}=b.useContext(wt),{matches:s}=b.useContext(Mt),{pathname:r}=xt(),i=JSON.stringify(pl(s)),o=b.useRef(!1);return kp(()=>{o.current=!0}),b.useCallback((l,h={})=>{if(gt(o.current,Rp),!o.current)return;if(typeof l=="number"){n.go(l);return}let d=gl(l,JSON.parse(i),r,h.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:$t([e,d.pathname])),(h.replace?n.replace:n.push)(d,h.state,h)},[e,n,i,r,t])}b.createContext(null);function ai(t,{relative:e}={}){let{matches:n}=b.useContext(Mt),{pathname:s}=xt(),r=JSON.stringify(pl(n));return b.useMemo(()=>gl(t,JSON.parse(r),s,e==="path"),[t,r,s,e])}function Nx(t,e){return Dp(t,e)}function Dp(t,e,n,s){var S;pe(Ls(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:r}=b.useContext(wt),{matches:i}=b.useContext(Mt),o=i[i.length-1],c=o?o.params:{},l=o?o.pathname:"/",h=o?o.pathnameBase:"/",d=o&&o.route;{let T=d&&d.path||"";jp(l,!d||T.endsWith("*")||T.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${T}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${T}"> to <Route path="${T==="/"?"*":`${T}/*`}">.`)}let m=xt(),p;if(e){let T=typeof e=="string"?Vs(e):e;pe(h==="/"||((S=T.pathname)==null?void 0:S.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${T.pathname}" was given in the \`location\` prop.`),p=T}else p=m;let y=p.pathname||"/",x=y;if(h!=="/"){let T=h.replace(/^\//,"").split("/");x="/"+y.replace(/^\//,"").split("/").slice(T.length).join("/")}let P=Ap(t,{pathname:x});gt(d||P!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),gt(P==null||P[P.length-1].route.element!==void 0||P[P.length-1].route.Component!==void 0||P[P.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let C=Dx(P&&P.map(T=>Object.assign({},T,{params:Object.assign({},c,T.params),pathname:$t([h,r.encodeLocation?r.encodeLocation(T.pathname).pathname:T.pathname]),pathnameBase:T.pathnameBase==="/"?h:$t([h,r.encodeLocation?r.encodeLocation(T.pathnameBase).pathname:T.pathnameBase])})),i,n,s);return e&&C?b.createElement(oi.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...p},navigationType:"POP"}},C):C}function Px(){let t=Ox(),e=bx(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:s},i={padding:"2px 4px",backgroundColor:s},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=b.createElement(b.Fragment,null,b.createElement("p",null,"💿 Hey developer 👋"),b.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",b.createElement("code",{style:i},"ErrorBoundary")," or"," ",b.createElement("code",{style:i},"errorElement")," prop on your route.")),b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),n?b.createElement("pre",{style:r},n):null,o)}var Cx=b.createElement(Px,null),Rx=class extends b.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?b.createElement(Mt.Provider,{value:this.props.routeContext},b.createElement(yl.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function kx({routeContext:t,match:e,children:n}){let s=b.useContext(Ms);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),b.createElement(Mt.Provider,{value:t},n)}function Dx(t,e=[],n=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let r=t,i=n==null?void 0:n.errors;if(i!=null){let l=r.findIndex(h=>h.route.id&&(i==null?void 0:i[h.route.id])!==void 0);pe(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),r=r.slice(0,Math.min(r.length,l+1))}let o=!1,c=-1;if(n)for(let l=0;l<r.length;l++){let h=r[l];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=l),h.route.id){let{loaderData:d,errors:m}=n,p=h.route.loader&&!d.hasOwnProperty(h.route.id)&&(!m||m[h.route.id]===void 0);if(h.route.lazy||p){o=!0,c>=0?r=r.slice(0,c+1):r=[r[0]];break}}}return r.reduceRight((l,h,d)=>{let m,p=!1,y=null,x=null;n&&(m=i&&h.route.id?i[h.route.id]:void 0,y=h.route.errorElement||Cx,o&&(c<0&&d===0?(jp("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,x=null):c===d&&(p=!0,x=h.route.hydrateFallbackElement||null)));let P=e.concat(r.slice(0,d+1)),C=()=>{let S;return m?S=y:p?S=x:h.route.Component?S=b.createElement(h.route.Component,null):h.route.element?S=h.route.element:S=l,b.createElement(kx,{match:h,routeContext:{outlet:l,matches:P,isDataRoute:n!=null},children:S})};return n&&(h.route.ErrorBoundary||h.route.errorElement||d===0)?b.createElement(Rx,{location:n.location,revalidation:n.revalidation,component:y,error:m,children:C(),routeContext:{outlet:null,matches:P,isDataRoute:!0}}):C()},null)}function _l(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function jx(t){let e=b.useContext(Ms);return pe(e,_l(t)),e}function Vx(t){let e=b.useContext(Fo);return pe(e,_l(t)),e}function Mx(t){let e=b.useContext(Mt);return pe(e,_l(t)),e}function wl(t){let e=Mx(t),n=e.matches[e.matches.length-1];return pe(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function Lx(){return wl("useRouteId")}function Ox(){var s;let t=b.useContext(yl),e=Vx("useRouteError"),n=wl("useRouteError");return t!==void 0?t:(s=e.errors)==null?void 0:s[n]}function Fx(){let{router:t}=jx("useNavigate"),e=wl("useNavigate"),n=b.useRef(!1);return kp(()=>{n.current=!0}),b.useCallback(async(r,i={})=>{gt(n.current,Rp),n.current&&(typeof r=="number"?t.navigate(r):await t.navigate(r,{fromRouteId:e,...i}))},[t,e])}var od={};function jp(t,e,n){!e&&!od[t]&&(od[t]=!0,gt(!1,n))}b.memo(Ux);function Ux({routes:t,future:e,state:n}){return Dp(t,void 0,n,e)}function $x({to:t,replace:e,state:n,relative:s}){pe(Ls(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=b.useContext(wt);gt(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=b.useContext(Mt),{pathname:o}=xt(),c=Os(),l=gl(t,pl(i),o,s==="path"),h=JSON.stringify(l);return b.useEffect(()=>{c(JSON.parse(h),{replace:e,state:n,relative:s})},[c,h,s,e,n]),null}function pr(t){pe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Bx({basename:t="/",children:e=null,location:n,navigationType:s="POP",navigator:r,static:i=!1}){pe(!Ls(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),c=b.useMemo(()=>({basename:o,navigator:r,static:i,future:{}}),[o,r,i]);typeof n=="string"&&(n=Vs(n));let{pathname:l="/",search:h="",hash:d="",state:m=null,key:p="default"}=n,y=b.useMemo(()=>{let x=Bt(l,o);return x==null?null:{location:{pathname:x,search:h,hash:d,state:m,key:p},navigationType:s}},[o,l,h,d,m,p,s]);return gt(y!=null,`<Router basename="${o}"> is not able to match the URL "${l}${h}${d}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:b.createElement(wt.Provider,{value:c},b.createElement(oi.Provider,{children:e,value:y}))}function qx({children:t,location:e}){return Nx(wc(t),e)}function wc(t,e=[]){let n=[];return b.Children.forEach(t,(s,r)=>{if(!b.isValidElement(s))return;let i=[...e,r];if(s.type===b.Fragment){n.push.apply(n,wc(s.props.children,i));return}pe(s.type===pr,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),pe(!s.props.index||!s.props.children,"An index route cannot have child routes.");let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=wc(s.props.children,i)),n.push(o)}),n}var Hi="get",Gi="application/x-www-form-urlencoded";function Uo(t){return t!=null&&typeof t.tagName=="string"}function Wx(t){return Uo(t)&&t.tagName.toLowerCase()==="button"}function zx(t){return Uo(t)&&t.tagName.toLowerCase()==="form"}function Hx(t){return Uo(t)&&t.tagName.toLowerCase()==="input"}function Gx(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Kx(t,e){return t.button===0&&(!e||e==="_self")&&!Gx(t)}var ji=null;function Qx(){if(ji===null)try{new FormData(document.createElement("form"),0),ji=!1}catch{ji=!0}return ji}var Yx=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ma(t){return t!=null&&!Yx.has(t)?(gt(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Gi}"`),null):t}function Xx(t,e){let n,s,r,i,o;if(zx(t)){let c=t.getAttribute("action");s=c?Bt(c,e):null,n=t.getAttribute("method")||Hi,r=Ma(t.getAttribute("enctype"))||Gi,i=new FormData(t)}else if(Wx(t)||Hx(t)&&(t.type==="submit"||t.type==="image")){let c=t.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=t.getAttribute("formaction")||c.getAttribute("action");if(s=l?Bt(l,e):null,n=t.getAttribute("formmethod")||c.getAttribute("method")||Hi,r=Ma(t.getAttribute("formenctype"))||Ma(c.getAttribute("enctype"))||Gi,i=new FormData(c,t),!Qx()){let{name:h,type:d,value:m}=t;if(d==="image"){let p=h?`${h}.`:"";i.append(`${p}x`,"0"),i.append(`${p}y`,"0")}else h&&i.append(h,m)}}else{if(Uo(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Hi,s=null,r=Gi,o=t}return i&&r==="text/plain"&&(o=i,i=void 0),{action:s,method:n.toLowerCase(),encType:r,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function xl(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Jx(t,e,n){let s=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return s.pathname==="/"?s.pathname=`_root.${n}`:e&&Bt(s.pathname,e)==="/"?s.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:s.pathname=`${s.pathname.replace(/\/$/,"")}.${n}`,s}async function Zx(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function ev(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function tv(t,e,n){let s=await Promise.all(t.map(async r=>{let i=e.routes[r.route.id];if(i){let o=await Zx(i,n);return o.links?o.links():[]}return[]}));return iv(s.flat(1).filter(ev).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function ad(t,e,n,s,r,i){let o=(l,h)=>n[h]?l.route.id!==n[h].route.id:!0,c=(l,h)=>{var d;return n[h].pathname!==l.pathname||((d=n[h].route.path)==null?void 0:d.endsWith("*"))&&n[h].params["*"]!==l.params["*"]};return i==="assets"?e.filter((l,h)=>o(l,h)||c(l,h)):i==="data"?e.filter((l,h)=>{var m;let d=s.routes[l.route.id];if(!d||!d.hasLoader)return!1;if(o(l,h)||c(l,h))return!0;if(l.route.shouldRevalidate){let p=l.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((m=n[0])==null?void 0:m.params)||{},nextUrl:new URL(t,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function nv(t,e,{includeHydrateFallback:n}={}){return sv(t.map(s=>{let r=e.routes[s.route.id];if(!r)return[];let i=[r.module];return r.clientActionModule&&(i=i.concat(r.clientActionModule)),r.clientLoaderModule&&(i=i.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(i=i.concat(r.hydrateFallbackModule)),r.imports&&(i=i.concat(r.imports)),i}).flat(1))}function sv(t){return[...new Set(t)]}function rv(t){let e={},n=Object.keys(t).sort();for(let s of n)e[s]=t[s];return e}function iv(t,e){let n=new Set;return new Set(e),t.reduce((s,r)=>{let i=JSON.stringify(rv(r));return n.has(i)||(n.add(i),s.push({key:i,link:r})),s},[])}function Vp(){let t=b.useContext(Ms);return xl(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function ov(){let t=b.useContext(Fo);return xl(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var vl=b.createContext(void 0);vl.displayName="FrameworkContext";function Mp(){let t=b.useContext(vl);return xl(t,"You must render this element inside a <HydratedRouter> element"),t}function av(t,e){let n=b.useContext(vl),[s,r]=b.useState(!1),[i,o]=b.useState(!1),{onFocus:c,onBlur:l,onMouseEnter:h,onMouseLeave:d,onTouchStart:m}=e,p=b.useRef(null);b.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let P=S=>{S.forEach(T=>{o(T.isIntersecting)})},C=new IntersectionObserver(P,{threshold:.5});return p.current&&C.observe(p.current),()=>{C.disconnect()}}},[t]),b.useEffect(()=>{if(s){let P=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(P)}}},[s]);let y=()=>{r(!0)},x=()=>{r(!1),o(!1)};return n?t!=="intent"?[i,p,{}]:[i,p,{onFocus:dr(c,y),onBlur:dr(l,x),onMouseEnter:dr(h,y),onMouseLeave:dr(d,x),onTouchStart:dr(m,y)}]:[!1,p,{}]}function dr(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function cv({page:t,...e}){let{router:n}=Vp(),s=b.useMemo(()=>Ap(n.routes,t,n.basename),[n.routes,t,n.basename]);return s?b.createElement(uv,{page:t,matches:s,...e}):null}function lv(t){let{manifest:e,routeModules:n}=Mp(),[s,r]=b.useState([]);return b.useEffect(()=>{let i=!1;return tv(t,e,n).then(o=>{i||r(o)}),()=>{i=!0}},[t,e,n]),s}function uv({page:t,matches:e,...n}){let s=xt(),{manifest:r,routeModules:i}=Mp(),{basename:o}=Vp(),{loaderData:c,matches:l}=ov(),h=b.useMemo(()=>ad(t,e,l,r,s,"data"),[t,e,l,r,s]),d=b.useMemo(()=>ad(t,e,l,r,s,"assets"),[t,e,l,r,s]),m=b.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let x=new Set,P=!1;if(e.forEach(S=>{var k;let T=r.routes[S.route.id];!T||!T.hasLoader||(!h.some(L=>L.route.id===S.route.id)&&S.route.id in c&&((k=i[S.route.id])!=null&&k.shouldRevalidate)||T.hasClientLoader?P=!0:x.add(S.route.id))}),x.size===0)return[];let C=Jx(t,o,"data");return P&&x.size>0&&C.searchParams.set("_routes",e.filter(S=>x.has(S.route.id)).map(S=>S.route.id).join(",")),[C.pathname+C.search]},[o,c,s,r,h,e,t,i]),p=b.useMemo(()=>nv(d,r),[d,r]),y=lv(d);return b.createElement(b.Fragment,null,m.map(x=>b.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...n})),p.map(x=>b.createElement("link",{key:x,rel:"modulepreload",href:x,...n})),y.map(({key:x,link:P})=>b.createElement("link",{key:x,...P})))}function hv(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Lp=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Lp&&(window.__reactRouterVersion="7.7.1")}catch{}function dv({basename:t,children:e,window:n}){let s=b.useRef();s.current==null&&(s.current=Zw({window:n,v5Compat:!0}));let r=s.current,[i,o]=b.useState({action:r.action,location:r.location}),c=b.useCallback(l=>{b.startTransition(()=>o(l))},[o]);return b.useLayoutEffect(()=>r.listen(c),[r,c]),b.createElement(Bx,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:r})}var Op=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Fp=b.forwardRef(function({onClick:e,discover:n="render",prefetch:s="none",relative:r,reloadDocument:i,replace:o,state:c,target:l,to:h,preventScrollReset:d,viewTransition:m,...p},y){let{basename:x}=b.useContext(wt),P=typeof h=="string"&&Op.test(h),C,S=!1;if(typeof h=="string"&&P&&(C=h,Lp))try{let I=new URL(window.location.href),N=h.startsWith("//")?new URL(I.protocol+h):new URL(h),A=Bt(N.pathname,x);N.origin===I.origin&&A!=null?h=A+N.search+N.hash:S=!0}catch{gt(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let T=Ax(h,{relative:r}),[k,L,D]=av(s,p),V=gv(h,{replace:o,state:c,target:l,preventScrollReset:d,relative:r,viewTransition:m});function E(I){e&&e(I),I.defaultPrevented||V(I)}let v=b.createElement("a",{...p,...D,href:C||T,onClick:S||i?e:E,ref:hv(y,L),target:l,"data-discover":!P&&n==="render"?"true":void 0});return k&&!P?b.createElement(b.Fragment,null,v,b.createElement(cv,{page:T})):v});Fp.displayName="Link";var fv=b.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:s="",end:r=!1,style:i,to:o,viewTransition:c,children:l,...h},d){let m=ai(o,{relative:h.relative}),p=xt(),y=b.useContext(Fo),{navigator:x,basename:P}=b.useContext(wt),C=y!=null&&vv(m)&&c===!0,S=x.encodeLocation?x.encodeLocation(m).pathname:m.pathname,T=p.pathname,k=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;n||(T=T.toLowerCase(),k=k?k.toLowerCase():null,S=S.toLowerCase()),k&&P&&(k=Bt(k,P)||k);const L=S!=="/"&&S.endsWith("/")?S.length-1:S.length;let D=T===S||!r&&T.startsWith(S)&&T.charAt(L)==="/",V=k!=null&&(k===S||!r&&k.startsWith(S)&&k.charAt(S.length)==="/"),E={isActive:D,isPending:V,isTransitioning:C},v=D?e:void 0,I;typeof s=="function"?I=s(E):I=[s,D?"active":null,V?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let N=typeof i=="function"?i(E):i;return b.createElement(Fp,{...h,"aria-current":v,className:I,ref:d,style:N,to:o,viewTransition:c},typeof l=="function"?l(E):l)});fv.displayName="NavLink";var mv=b.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:s,replace:r,state:i,method:o=Hi,action:c,onSubmit:l,relative:h,preventScrollReset:d,viewTransition:m,...p},y)=>{let x=wv(),P=xv(c,{relative:h}),C=o.toLowerCase()==="get"?"get":"post",S=typeof c=="string"&&Op.test(c),T=k=>{if(l&&l(k),k.defaultPrevented)return;k.preventDefault();let L=k.nativeEvent.submitter,D=(L==null?void 0:L.getAttribute("formmethod"))||o;x(L||k.currentTarget,{fetcherKey:e,method:D,navigate:n,replace:r,state:i,relative:h,preventScrollReset:d,viewTransition:m})};return b.createElement("form",{ref:y,method:C,action:P,onSubmit:s?l:T,...p,"data-discover":!S&&t==="render"?"true":void 0})});mv.displayName="Form";function pv(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Up(t){let e=b.useContext(Ms);return pe(e,pv(t)),e}function gv(t,{target:e,replace:n,state:s,preventScrollReset:r,relative:i,viewTransition:o}={}){let c=Os(),l=xt(),h=ai(t,{relative:i});return b.useCallback(d=>{if(Kx(d,e)){d.preventDefault();let m=n!==void 0?n:Lr(l)===Lr(h);c(t,{replace:m,state:s,preventScrollReset:r,relative:i,viewTransition:o})}},[l,c,h,n,s,e,t,r,i,o])}var yv=0,_v=()=>`__${String(++yv)}__`;function wv(){let{router:t}=Up("useSubmit"),{basename:e}=b.useContext(wt),n=Lx();return b.useCallback(async(s,r={})=>{let{action:i,method:o,encType:c,formData:l,body:h}=Xx(s,e);if(r.navigate===!1){let d=r.fetcherKey||_v();await t.fetch(d,n,r.action||i,{preventScrollReset:r.preventScrollReset,formData:l,body:h,formMethod:r.method||o,formEncType:r.encType||c,flushSync:r.flushSync})}else await t.navigate(r.action||i,{preventScrollReset:r.preventScrollReset,formData:l,body:h,formMethod:r.method||o,formEncType:r.encType||c,replace:r.replace,state:r.state,fromRouteId:n,flushSync:r.flushSync,viewTransition:r.viewTransition})},[t,e,n])}function xv(t,{relative:e}={}){let{basename:n}=b.useContext(wt),s=b.useContext(Mt);pe(s,"useFormAction must be used inside a RouteContext");let[r]=s.matches.slice(-1),i={...ai(t||".",{relative:e})},o=xt();if(t==null){i.search=o.search;let c=new URLSearchParams(i.search),l=c.getAll("index");if(l.some(d=>d==="")){c.delete("index"),l.filter(m=>m).forEach(m=>c.append("index",m));let d=c.toString();i.search=d?`?${d}`:""}}return(!t||t===".")&&r.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:$t([n,i.pathname])),Lr(i)}function vv(t,{relative:e}={}){let n=b.useContext(Cp);pe(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=Up("useViewTransitionState"),r=ai(t,{relative:e});if(!n.isTransitioning)return!1;let i=Bt(n.currentLocation.pathname,s)||n.currentLocation.pathname,o=Bt(n.nextLocation.pathname,s)||n.nextLocation.pathname;return lo(r.pathname,o)!=null||lo(r.pathname,i)!=null}const bl=b.createContext({});function Tl(t){const e=b.useRef(null);return e.current===null&&(e.current=t()),e.current}const El=typeof window<"u",$p=El?b.useLayoutEffect:b.useEffect,$o=b.createContext(null);function Il(t,e){t.indexOf(e)===-1&&t.push(e)}function Al(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const qt=(t,e,n)=>n>e?e:n<t?t:n;let Sl=()=>{};const Wt={},Bp=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function qp(t){return typeof t=="object"&&t!==null}const Wp=t=>/^0[^.\s]+$/u.test(t);function Nl(t){let e;return()=>(e===void 0&&(e=t()),e)}const ct=t=>t,bv=(t,e)=>n=>e(t(n)),ci=(...t)=>t.reduce(bv),Or=(t,e,n)=>{const s=e-t;return s===0?1:(n-t)/s};class Pl{constructor(){this.subscriptions=[]}add(e){return Il(this.subscriptions,e),()=>Al(this.subscriptions,e)}notify(e,n,s){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,n,s);else for(let i=0;i<r;i++){const o=this.subscriptions[i];o&&o(e,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const It=t=>t*1e3,At=t=>t/1e3;function zp(t,e){return e?t*(1e3/e):0}const Hp=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,Tv=1e-7,Ev=12;function Iv(t,e,n,s,r){let i,o,c=0;do o=e+(n-e)/2,i=Hp(o,s,r)-t,i>0?n=o:e=o;while(Math.abs(i)>Tv&&++c<Ev);return o}function li(t,e,n,s){if(t===e&&n===s)return ct;const r=i=>Iv(i,0,1,t,n);return i=>i===0||i===1?i:Hp(r(i),e,s)}const Gp=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,Kp=t=>e=>1-t(1-e),Qp=li(.33,1.53,.69,.99),Cl=Kp(Qp),Yp=Gp(Cl),Xp=t=>(t*=2)<1?.5*Cl(t):.5*(2-Math.pow(2,-10*(t-1))),Rl=t=>1-Math.sin(Math.acos(t)),Jp=Kp(Rl),Zp=Gp(Rl),Av=li(.42,0,1,1),Sv=li(0,0,.58,1),eg=li(.42,0,.58,1),Nv=t=>Array.isArray(t)&&typeof t[0]!="number",tg=t=>Array.isArray(t)&&typeof t[0]=="number",Pv={linear:ct,easeIn:Av,easeInOut:eg,easeOut:Sv,circIn:Rl,circInOut:Zp,circOut:Jp,backIn:Cl,backInOut:Yp,backOut:Qp,anticipate:Xp},Cv=t=>typeof t=="string",cd=t=>{if(tg(t)){Sl(t.length===4);const[e,n,s,r]=t;return li(e,n,s,r)}else if(Cv(t))return Pv[t];return t},Vi=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Rv(t,e){let n=new Set,s=new Set,r=!1,i=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1};function l(d){o.has(d)&&(h.schedule(d),t()),d(c)}const h={schedule:(d,m=!1,p=!1)=>{const x=p&&r?n:s;return m&&o.add(d),x.has(d)||x.add(d),d},cancel:d=>{s.delete(d),o.delete(d)},process:d=>{if(c=d,r){i=!0;return}r=!0,[n,s]=[s,n],n.forEach(l),n.clear(),r=!1,i&&(i=!1,h.process(d))}};return h}const kv=40;function ng(t,e){let n=!1,s=!0;const r={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,o=Vi.reduce((k,L)=>(k[L]=Rv(i),k),{}),{setup:c,read:l,resolveKeyframes:h,preUpdate:d,update:m,preRender:p,render:y,postRender:x}=o,P=()=>{const k=Wt.useManualTiming?r.timestamp:performance.now();n=!1,Wt.useManualTiming||(r.delta=s?1e3/60:Math.max(Math.min(k-r.timestamp,kv),1)),r.timestamp=k,r.isProcessing=!0,c.process(r),l.process(r),h.process(r),d.process(r),m.process(r),p.process(r),y.process(r),x.process(r),r.isProcessing=!1,n&&e&&(s=!1,t(P))},C=()=>{n=!0,s=!0,r.isProcessing||t(P)};return{schedule:Vi.reduce((k,L)=>{const D=o[L];return k[L]=(V,E=!1,v=!1)=>(n||C(),D.schedule(V,E,v)),k},{}),cancel:k=>{for(let L=0;L<Vi.length;L++)o[Vi[L]].cancel(k)},state:r,steps:o}}const{schedule:me,cancel:pn,state:Ve,steps:La}=ng(typeof requestAnimationFrame<"u"?requestAnimationFrame:ct,!0);let Ki;function Dv(){Ki=void 0}const Ze={now:()=>(Ki===void 0&&Ze.set(Ve.isProcessing||Wt.useManualTiming?Ve.timestamp:performance.now()),Ki),set:t=>{Ki=t,queueMicrotask(Dv)}},sg=t=>e=>typeof e=="string"&&e.startsWith(t),kl=sg("--"),jv=sg("var(--"),Dl=t=>jv(t)?Vv.test(t.split("/*")[0].trim()):!1,Vv=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Fs={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Fr={...Fs,transform:t=>qt(0,1,t)},Mi={...Fs,default:1},br=t=>Math.round(t*1e5)/1e5,jl=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Mv(t){return t==null}const Lv=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,Vl=(t,e)=>n=>!!(typeof n=="string"&&Lv.test(n)&&n.startsWith(t)||e&&!Mv(n)&&Object.prototype.hasOwnProperty.call(n,e)),rg=(t,e,n)=>s=>{if(typeof s!="string")return s;const[r,i,o,c]=s.match(jl);return{[t]:parseFloat(r),[e]:parseFloat(i),[n]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},Ov=t=>qt(0,255,t),Oa={...Fs,transform:t=>Math.round(Ov(t))},Mn={test:Vl("rgb","red"),parse:rg("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:s=1})=>"rgba("+Oa.transform(t)+", "+Oa.transform(e)+", "+Oa.transform(n)+", "+br(Fr.transform(s))+")"};function Fv(t){let e="",n="",s="",r="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),s=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),s=t.substring(3,4),r=t.substring(4,5),e+=e,n+=n,s+=s,r+=r),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:r?parseInt(r,16)/255:1}}const xc={test:Vl("#"),parse:Fv,transform:Mn.transform},ui=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),nn=ui("deg"),St=ui("%"),Q=ui("px"),Uv=ui("vh"),$v=ui("vw"),ld={...St,parse:t=>St.parse(t)/100,transform:t=>St.transform(t*100)},ds={test:Vl("hsl","hue"),parse:rg("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:s=1})=>"hsla("+Math.round(t)+", "+St.transform(br(e))+", "+St.transform(br(n))+", "+br(Fr.transform(s))+")"},Ie={test:t=>Mn.test(t)||xc.test(t)||ds.test(t),parse:t=>Mn.test(t)?Mn.parse(t):ds.test(t)?ds.parse(t):xc.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Mn.transform(t):ds.transform(t),getAnimatableNone:t=>{const e=Ie.parse(t);return e.alpha=0,Ie.transform(e)}},Bv=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function qv(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(jl))==null?void 0:e.length)||0)+(((n=t.match(Bv))==null?void 0:n.length)||0)>0}const ig="number",og="color",Wv="var",zv="var(",ud="${}",Hv=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ur(t){const e=t.toString(),n=[],s={color:[],number:[],var:[]},r=[];let i=0;const c=e.replace(Hv,l=>(Ie.test(l)?(s.color.push(i),r.push(og),n.push(Ie.parse(l))):l.startsWith(zv)?(s.var.push(i),r.push(Wv),n.push(l)):(s.number.push(i),r.push(ig),n.push(parseFloat(l))),++i,ud)).split(ud);return{values:n,split:c,indexes:s,types:r}}function ag(t){return Ur(t).values}function cg(t){const{split:e,types:n}=Ur(t),s=e.length;return r=>{let i="";for(let o=0;o<s;o++)if(i+=e[o],r[o]!==void 0){const c=n[o];c===ig?i+=br(r[o]):c===og?i+=Ie.transform(r[o]):i+=r[o]}return i}}const Gv=t=>typeof t=="number"?0:Ie.test(t)?Ie.getAnimatableNone(t):t;function Kv(t){const e=ag(t);return cg(t)(e.map(Gv))}const gn={test:qv,parse:ag,createTransformer:cg,getAnimatableNone:Kv};function Fa(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function Qv({hue:t,saturation:e,lightness:n,alpha:s}){t/=360,e/=100,n/=100;let r=0,i=0,o=0;if(!e)r=i=o=n;else{const c=n<.5?n*(1+e):n+e-n*e,l=2*n-c;r=Fa(l,c,t+1/3),i=Fa(l,c,t),o=Fa(l,c,t-1/3)}return{red:Math.round(r*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:s}}function uo(t,e){return n=>n>0?e:t}const ge=(t,e,n)=>t+(e-t)*n,Ua=(t,e,n)=>{const s=t*t,r=n*(e*e-s)+s;return r<0?0:Math.sqrt(r)},Yv=[xc,Mn,ds],Xv=t=>Yv.find(e=>e.test(t));function hd(t){const e=Xv(t);if(!e)return!1;let n=e.parse(t);return e===ds&&(n=Qv(n)),n}const dd=(t,e)=>{const n=hd(t),s=hd(e);if(!n||!s)return uo(t,e);const r={...n};return i=>(r.red=Ua(n.red,s.red,i),r.green=Ua(n.green,s.green,i),r.blue=Ua(n.blue,s.blue,i),r.alpha=ge(n.alpha,s.alpha,i),Mn.transform(r))},vc=new Set(["none","hidden"]);function Jv(t,e){return vc.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function Zv(t,e){return n=>ge(t,e,n)}function Ml(t){return typeof t=="number"?Zv:typeof t=="string"?Dl(t)?uo:Ie.test(t)?dd:nb:Array.isArray(t)?lg:typeof t=="object"?Ie.test(t)?dd:eb:uo}function lg(t,e){const n=[...t],s=n.length,r=t.map((i,o)=>Ml(i)(i,e[o]));return i=>{for(let o=0;o<s;o++)n[o]=r[o](i);return n}}function eb(t,e){const n={...t,...e},s={};for(const r in n)t[r]!==void 0&&e[r]!==void 0&&(s[r]=Ml(t[r])(t[r],e[r]));return r=>{for(const i in s)n[i]=s[i](r);return n}}function tb(t,e){const n=[],s={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const i=e.types[r],o=t.indexes[i][s[i]],c=t.values[o]??0;n[r]=c,s[i]++}return n}const nb=(t,e)=>{const n=gn.createTransformer(e),s=Ur(t),r=Ur(e);return s.indexes.var.length===r.indexes.var.length&&s.indexes.color.length===r.indexes.color.length&&s.indexes.number.length>=r.indexes.number.length?vc.has(t)&&!r.values.length||vc.has(e)&&!s.values.length?Jv(t,e):ci(lg(tb(s,r),r.values),n):uo(t,e)};function ug(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?ge(t,e,n):Ml(t)(t,e)}const sb=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>me.update(e,n),stop:()=>pn(e),now:()=>Ve.isProcessing?Ve.timestamp:Ze.now()}},hg=(t,e,n=10)=>{let s="";const r=Math.max(Math.round(e/n),2);for(let i=0;i<r;i++)s+=Math.round(t(i/(r-1))*1e4)/1e4+", ";return`linear(${s.substring(0,s.length-2)})`},ho=2e4;function Ll(t){let e=0;const n=50;let s=t.next(e);for(;!s.done&&e<ho;)e+=n,s=t.next(e);return e>=ho?1/0:e}function rb(t,e=100,n){const s=n({...t,keyframes:[0,e]}),r=Math.min(Ll(s),ho);return{type:"keyframes",ease:i=>s.next(r*i).value/e,duration:At(r)}}const ib=5;function dg(t,e,n){const s=Math.max(e-ib,0);return zp(n-t(s),e-s)}const we={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},$a=.001;function ob({duration:t=we.duration,bounce:e=we.bounce,velocity:n=we.velocity,mass:s=we.mass}){let r,i,o=1-e;o=qt(we.minDamping,we.maxDamping,o),t=qt(we.minDuration,we.maxDuration,At(t)),o<1?(r=h=>{const d=h*o,m=d*t,p=d-n,y=bc(h,o),x=Math.exp(-m);return $a-p/y*x},i=h=>{const m=h*o*t,p=m*n+n,y=Math.pow(o,2)*Math.pow(h,2)*t,x=Math.exp(-m),P=bc(Math.pow(h,2),o);return(-r(h)+$a>0?-1:1)*((p-y)*x)/P}):(r=h=>{const d=Math.exp(-h*t),m=(h-n)*t+1;return-$a+d*m},i=h=>{const d=Math.exp(-h*t),m=(n-h)*(t*t);return d*m});const c=5/t,l=cb(r,i,c);if(t=It(t),isNaN(l))return{stiffness:we.stiffness,damping:we.damping,duration:t};{const h=Math.pow(l,2)*s;return{stiffness:h,damping:o*2*Math.sqrt(s*h),duration:t}}}const ab=12;function cb(t,e,n){let s=n;for(let r=1;r<ab;r++)s=s-t(s)/e(s);return s}function bc(t,e){return t*Math.sqrt(1-e*e)}const lb=["duration","bounce"],ub=["stiffness","damping","mass"];function fd(t,e){return e.some(n=>t[n]!==void 0)}function hb(t){let e={velocity:we.velocity,stiffness:we.stiffness,damping:we.damping,mass:we.mass,isResolvedFromDuration:!1,...t};if(!fd(t,ub)&&fd(t,lb))if(t.visualDuration){const n=t.visualDuration,s=2*Math.PI/(n*1.2),r=s*s,i=2*qt(.05,1,1-(t.bounce||0))*Math.sqrt(r);e={...e,mass:we.mass,stiffness:r,damping:i}}else{const n=ob(t);e={...e,...n,mass:we.mass},e.isResolvedFromDuration=!0}return e}function fo(t=we.visualDuration,e=we.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:s,restDelta:r}=n;const i=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],c={done:!1,value:i},{stiffness:l,damping:h,mass:d,duration:m,velocity:p,isResolvedFromDuration:y}=hb({...n,velocity:-At(n.velocity||0)}),x=p||0,P=h/(2*Math.sqrt(l*d)),C=o-i,S=At(Math.sqrt(l/d)),T=Math.abs(C)<5;s||(s=T?we.restSpeed.granular:we.restSpeed.default),r||(r=T?we.restDelta.granular:we.restDelta.default);let k;if(P<1){const D=bc(S,P);k=V=>{const E=Math.exp(-P*S*V);return o-E*((x+P*S*C)/D*Math.sin(D*V)+C*Math.cos(D*V))}}else if(P===1)k=D=>o-Math.exp(-S*D)*(C+(x+S*C)*D);else{const D=S*Math.sqrt(P*P-1);k=V=>{const E=Math.exp(-P*S*V),v=Math.min(D*V,300);return o-E*((x+P*S*C)*Math.sinh(v)+D*C*Math.cosh(v))/D}}const L={calculatedDuration:y&&m||null,next:D=>{const V=k(D);if(y)c.done=D>=m;else{let E=D===0?x:0;P<1&&(E=D===0?It(x):dg(k,D,V));const v=Math.abs(E)<=s,I=Math.abs(o-V)<=r;c.done=v&&I}return c.value=c.done?o:V,c},toString:()=>{const D=Math.min(Ll(L),ho),V=hg(E=>L.next(D*E).value,D,30);return D+"ms "+V},toTransition:()=>{}};return L}fo.applyToOptions=t=>{const e=rb(t,100,fo);return t.ease=e.ease,t.duration=It(e.duration),t.type="keyframes",t};function Tc({keyframes:t,velocity:e=0,power:n=.8,timeConstant:s=325,bounceDamping:r=10,bounceStiffness:i=500,modifyTarget:o,min:c,max:l,restDelta:h=.5,restSpeed:d}){const m=t[0],p={done:!1,value:m},y=v=>c!==void 0&&v<c||l!==void 0&&v>l,x=v=>c===void 0?l:l===void 0||Math.abs(c-v)<Math.abs(l-v)?c:l;let P=n*e;const C=m+P,S=o===void 0?C:o(C);S!==C&&(P=S-m);const T=v=>-P*Math.exp(-v/s),k=v=>S+T(v),L=v=>{const I=T(v),N=k(v);p.done=Math.abs(I)<=h,p.value=p.done?S:N};let D,V;const E=v=>{y(p.value)&&(D=v,V=fo({keyframes:[p.value,x(p.value)],velocity:dg(k,v,p.value),damping:r,stiffness:i,restDelta:h,restSpeed:d}))};return E(0),{calculatedDuration:null,next:v=>{let I=!1;return!V&&D===void 0&&(I=!0,L(v),E(v)),D!==void 0&&v>=D?V.next(v-D):(!I&&L(v),p)}}}function db(t,e,n){const s=[],r=n||Wt.mix||ug,i=t.length-1;for(let o=0;o<i;o++){let c=r(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||ct:e;c=ci(l,c)}s.push(c)}return s}function fb(t,e,{clamp:n=!0,ease:s,mixer:r}={}){const i=t.length;if(Sl(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const c=db(e,s,r),l=c.length,h=d=>{if(o&&d<t[0])return e[0];let m=0;if(l>1)for(;m<t.length-2&&!(d<t[m+1]);m++);const p=Or(t[m],t[m+1],d);return c[m](p)};return n?d=>h(qt(t[0],t[i-1],d)):h}function mb(t,e){const n=t[t.length-1];for(let s=1;s<=e;s++){const r=Or(0,e,s);t.push(ge(n,1,r))}}function pb(t){const e=[0];return mb(e,t.length-1),e}function gb(t,e){return t.map(n=>n*e)}function yb(t,e){return t.map(()=>e||eg).splice(0,t.length-1)}function Tr({duration:t=300,keyframes:e,times:n,ease:s="easeInOut"}){const r=Nv(s)?s.map(cd):cd(s),i={done:!1,value:e[0]},o=gb(n&&n.length===e.length?n:pb(e),t),c=fb(o,e,{ease:Array.isArray(r)?r:yb(e,r)});return{calculatedDuration:t,next:l=>(i.value=c(l),i.done=l>=t,i)}}const _b=t=>t!==null;function Ol(t,{repeat:e,repeatType:n="loop"},s,r=1){const i=t.filter(_b),c=r<0||e&&n!=="loop"&&e%2===1?0:i.length-1;return!c||s===void 0?i[c]:s}const wb={decay:Tc,inertia:Tc,tween:Tr,keyframes:Tr,spring:fo};function fg(t){typeof t.type=="string"&&(t.type=wb[t.type])}class Fl{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const xb=t=>t/100;class Ul extends Fl{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var s,r;const{motionValue:n}=this.options;n&&n.updatedAt!==Ze.now()&&this.tick(Ze.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(r=(s=this.options).onStop)==null||r.call(s))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;fg(e);const{type:n=Tr,repeat:s=0,repeatDelay:r=0,repeatType:i,velocity:o=0}=e;let{keyframes:c}=e;const l=n||Tr;l!==Tr&&typeof c[0]!="number"&&(this.mixKeyframes=ci(xb,ug(c[0],c[1])),c=[0,100]);const h=l({...e,keyframes:c});i==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...c].reverse(),velocity:-o})),h.calculatedDuration===null&&(h.calculatedDuration=Ll(h));const{calculatedDuration:d}=h;this.calculatedDuration=d,this.resolvedDuration=d+r,this.totalDuration=this.resolvedDuration*(s+1)-r,this.generator=h}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:s,totalDuration:r,mixKeyframes:i,mirroredGenerator:o,resolvedDuration:c,calculatedDuration:l}=this;if(this.startTime===null)return s.next(0);const{delay:h=0,keyframes:d,repeat:m,repeatType:p,repeatDelay:y,type:x,onUpdate:P,finalKeyframe:C}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-r/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const S=this.currentTime-h*(this.playbackSpeed>=0?1:-1),T=this.playbackSpeed>=0?S<0:S>r;this.currentTime=Math.max(S,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let k=this.currentTime,L=s;if(m){const v=Math.min(this.currentTime,r)/c;let I=Math.floor(v),N=v%1;!N&&v>=1&&(N=1),N===1&&I--,I=Math.min(I,m+1),!!(I%2)&&(p==="reverse"?(N=1-N,y&&(N-=y/c)):p==="mirror"&&(L=o)),k=qt(0,1,N)*c}const D=T?{done:!1,value:d[0]}:L.next(k);i&&(D.value=i(D.value));let{done:V}=D;!T&&l!==null&&(V=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const E=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&V);return E&&x!==Tc&&(D.value=Ol(d,this.options,C,this.speed)),P&&P(D.value),E&&this.finish(),D}then(e,n){return this.finished.then(e,n)}get duration(){return At(this.calculatedDuration)}get time(){return At(this.currentTime)}set time(e){var n;e=It(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Ze.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=At(this.currentTime))}play(){var r,i;if(this.isStopped)return;const{driver:e=sb,startTime:n}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),(i=(r=this.options).onPlay)==null||i.call(r);const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=n??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ze.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(e=this.options).onComplete)==null||n.call(e)}cancel(){var e,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(e=this.options).onCancel)==null||n.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),e.observe(this)}}function vb(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const Ln=t=>t*180/Math.PI,Ec=t=>{const e=Ln(Math.atan2(t[1],t[0]));return Ic(e)},bb={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Ec,rotateZ:Ec,skewX:t=>Ln(Math.atan(t[1])),skewY:t=>Ln(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Ic=t=>(t=t%360,t<0&&(t+=360),t),md=Ec,pd=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),gd=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),Tb={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:pd,scaleY:gd,scale:t=>(pd(t)+gd(t))/2,rotateX:t=>Ic(Ln(Math.atan2(t[6],t[5]))),rotateY:t=>Ic(Ln(Math.atan2(-t[2],t[0]))),rotateZ:md,rotate:md,skewX:t=>Ln(Math.atan(t[4])),skewY:t=>Ln(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Ac(t){return t.includes("scale")?1:0}function Sc(t,e){if(!t||t==="none")return Ac(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,r;if(n)s=Tb,r=n;else{const c=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=bb,r=c}if(!r)return Ac(e);const i=s[e],o=r[1].split(",").map(Ib);return typeof i=="function"?i(o):o[i]}const Eb=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return Sc(n,e)};function Ib(t){return parseFloat(t.trim())}const Us=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],$s=new Set(Us),yd=t=>t===Fs||t===Q,Ab=new Set(["x","y","z"]),Sb=Us.filter(t=>!Ab.has(t));function Nb(t){const e=[];return Sb.forEach(n=>{const s=t.getValue(n);s!==void 0&&(e.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),e}const $n={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>Sc(e,"x"),y:(t,{transform:e})=>Sc(e,"y")};$n.translateX=$n.x;$n.translateY=$n.y;const Bn=new Set;let Nc=!1,Pc=!1,Cc=!1;function mg(){if(Pc){const t=Array.from(Bn).filter(s=>s.needsMeasurement),e=new Set(t.map(s=>s.element)),n=new Map;e.forEach(s=>{const r=Nb(s);r.length&&(n.set(s,r),s.render())}),t.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const r=n.get(s);r&&r.forEach(([i,o])=>{var c;(c=s.getValue(i))==null||c.set(o)})}),t.forEach(s=>s.measureEndState()),t.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}Pc=!1,Nc=!1,Bn.forEach(t=>t.complete(Cc)),Bn.clear()}function pg(){Bn.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Pc=!0)})}function Pb(){Cc=!0,pg(),mg(),Cc=!1}class $l{constructor(e,n,s,r,i,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=s,this.motionValue=r,this.element=i,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(Bn.add(this),Nc||(Nc=!0,me.read(pg),me.resolveKeyframes(mg))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:s,motionValue:r}=this;if(e[0]===null){const i=r==null?void 0:r.get(),o=e[e.length-1];if(i!==void 0)e[0]=i;else if(s&&n){const c=s.readValue(n,o);c!=null&&(e[0]=c)}e[0]===void 0&&(e[0]=o),r&&i===void 0&&r.set(e[0])}vb(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Bn.delete(this)}cancel(){this.state==="scheduled"&&(Bn.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Cb=t=>t.startsWith("--");function Rb(t,e,n){Cb(e)?t.style.setProperty(e,n):t.style[e]=n}const kb=Nl(()=>window.ScrollTimeline!==void 0),Db={};function jb(t,e){const n=Nl(t);return()=>Db[e]??n()}const gg=jb(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),gr=([t,e,n,s])=>`cubic-bezier(${t}, ${e}, ${n}, ${s})`,_d={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:gr([0,.65,.55,1]),circOut:gr([.55,0,1,.45]),backIn:gr([.31,.01,.66,-.59]),backOut:gr([.33,1.53,.69,.99])};function yg(t,e){if(t)return typeof t=="function"?gg()?hg(t,e):"ease-out":tg(t)?gr(t):Array.isArray(t)?t.map(n=>yg(n,e)||_d.easeOut):_d[t]}function Vb(t,e,n,{delay:s=0,duration:r=300,repeat:i=0,repeatType:o="loop",ease:c="easeOut",times:l}={},h=void 0){const d={[e]:n};l&&(d.offset=l);const m=yg(c,r);Array.isArray(m)&&(d.easing=m);const p={delay:s,duration:r,easing:Array.isArray(m)?"linear":m,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"};return h&&(p.pseudoElement=h),t.animate(d,p)}function _g(t){return typeof t=="function"&&"applyToOptions"in t}function Mb({type:t,...e}){return _g(t)&&gg()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class Lb extends Fl{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:s,keyframes:r,pseudoElement:i,allowFlatten:o=!1,finalKeyframe:c,onComplete:l}=e;this.isPseudoElement=!!i,this.allowFlatten=o,this.options=e,Sl(typeof e.type!="string");const h=Mb(e);this.animation=Vb(n,s,r,h,i),h.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const d=Ol(r,this.options,c,this.speed);this.updateMotionValue?this.updateMotionValue(d):Rb(n,s,d),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,n;(n=(e=this.animation).finish)==null||n.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,n;this.isPseudoElement||(n=(e=this.animation).commitStyles)==null||n.call(e)}get duration(){var n,s;const e=((s=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:s.call(n).duration)||0;return At(Number(e))}get time(){return At(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=It(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){var s;return this.allowFlatten&&((s=this.animation.effect)==null||s.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&kb()?(this.animation.timeline=e,ct):n(this)}}const wg={anticipate:Xp,backInOut:Yp,circInOut:Zp};function Ob(t){return t in wg}function Fb(t){typeof t.ease=="string"&&Ob(t.ease)&&(t.ease=wg[t.ease])}const wd=10;class Ub extends Lb{constructor(e){Fb(e),fg(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:s,onComplete:r,element:i,...o}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const c=new Ul({...o,autoplay:!1}),l=It(this.finishedTime??this.time);n.setWithVelocity(c.sample(l-wd).value,c.sample(l).value,wd),c.stop()}}const xd=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(gn.test(t)||t==="0")&&!t.startsWith("url("));function $b(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function Bb(t,e,n,s){const r=t[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],o=xd(r,e),c=xd(i,e);return!o||!c?!1:$b(t)||(n==="spring"||_g(n))&&s}const qb=new Set(["opacity","clipPath","filter","transform"]),Wb=Nl(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function zb(t){var d;const{motionValue:e,name:n,repeatDelay:s,repeatType:r,damping:i,type:o}=t;if(!(((d=e==null?void 0:e.owner)==null?void 0:d.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:h}=e.owner.getProps();return Wb()&&n&&qb.has(n)&&(n!=="transform"||!h)&&!l&&!s&&r!=="mirror"&&i!==0&&o!=="inertia"}const Hb=40;class Gb extends Fl{constructor({autoplay:e=!0,delay:n=0,type:s="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:o="loop",keyframes:c,name:l,motionValue:h,element:d,...m}){var x;super(),this.stop=()=>{var P,C;this._animation&&(this._animation.stop(),(P=this.stopTimeline)==null||P.call(this)),(C=this.keyframeResolver)==null||C.cancel()},this.createdAt=Ze.now();const p={autoplay:e,delay:n,type:s,repeat:r,repeatDelay:i,repeatType:o,name:l,motionValue:h,element:d,...m},y=(d==null?void 0:d.KeyframeResolver)||$l;this.keyframeResolver=new y(c,(P,C,S)=>this.onKeyframesResolved(P,C,p,!S),l,h,d),(x=this.keyframeResolver)==null||x.scheduleResolve()}onKeyframesResolved(e,n,s,r){this.keyframeResolver=void 0;const{name:i,type:o,velocity:c,delay:l,isHandoff:h,onUpdate:d}=s;this.resolvedAt=Ze.now(),Bb(e,i,o,c)||((Wt.instantAnimations||!l)&&(d==null||d(Ol(e,s,n))),e[0]=e[e.length-1],s.duration=0,s.repeat=0);const p={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>Hb?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...s,keyframes:e},y=!h&&zb(p)?new Ub({...p,element:p.motionValue.owner.current}):new Ul(p);y.finished.then(()=>this.notifyFinished()).catch(ct),this.pendingTimeline&&(this.stopTimeline=y.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=y}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),Pb()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const Kb=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Qb(t){const e=Kb.exec(t);if(!e)return[,];const[,n,s,r]=e;return[`--${n??s}`,r]}function xg(t,e,n=1){const[s,r]=Qb(t);if(!s)return;const i=window.getComputedStyle(e).getPropertyValue(s);if(i){const o=i.trim();return Bp(o)?parseFloat(o):o}return Dl(r)?xg(r,e,n+1):r}function Bl(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const vg=new Set(["width","height","top","left","right","bottom",...Us]),Yb={test:t=>t==="auto",parse:t=>t},bg=t=>e=>e.test(t),Tg=[Fs,Q,St,nn,$v,Uv,Yb],vd=t=>Tg.find(bg(t));function Xb(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||Wp(t):!0}const Jb=new Set(["brightness","contrast","saturate","opacity"]);function Zb(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[s]=n.match(jl)||[];if(!s)return t;const r=n.replace(s,"");let i=Jb.has(e)?1:0;return s!==n&&(i*=100),e+"("+i+r+")"}const eT=/\b([a-z-]*)\(.*?\)/gu,Rc={...gn,getAnimatableNone:t=>{const e=t.match(eT);return e?e.map(Zb).join(" "):t}},bd={...Fs,transform:Math.round},tT={rotate:nn,rotateX:nn,rotateY:nn,rotateZ:nn,scale:Mi,scaleX:Mi,scaleY:Mi,scaleZ:Mi,skew:nn,skewX:nn,skewY:nn,distance:Q,translateX:Q,translateY:Q,translateZ:Q,x:Q,y:Q,z:Q,perspective:Q,transformPerspective:Q,opacity:Fr,originX:ld,originY:ld,originZ:Q},ql={borderWidth:Q,borderTopWidth:Q,borderRightWidth:Q,borderBottomWidth:Q,borderLeftWidth:Q,borderRadius:Q,radius:Q,borderTopLeftRadius:Q,borderTopRightRadius:Q,borderBottomRightRadius:Q,borderBottomLeftRadius:Q,width:Q,maxWidth:Q,height:Q,maxHeight:Q,top:Q,right:Q,bottom:Q,left:Q,padding:Q,paddingTop:Q,paddingRight:Q,paddingBottom:Q,paddingLeft:Q,margin:Q,marginTop:Q,marginRight:Q,marginBottom:Q,marginLeft:Q,backgroundPositionX:Q,backgroundPositionY:Q,...tT,zIndex:bd,fillOpacity:Fr,strokeOpacity:Fr,numOctaves:bd},nT={...ql,color:Ie,backgroundColor:Ie,outlineColor:Ie,fill:Ie,stroke:Ie,borderColor:Ie,borderTopColor:Ie,borderRightColor:Ie,borderBottomColor:Ie,borderLeftColor:Ie,filter:Rc,WebkitFilter:Rc},Eg=t=>nT[t];function Ig(t,e){let n=Eg(t);return n!==Rc&&(n=gn),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const sT=new Set(["auto","none","0"]);function rT(t,e,n){let s=0,r;for(;s<t.length&&!r;){const i=t[s];typeof i=="string"&&!sT.has(i)&&Ur(i).values.length&&(r=t[s]),s++}if(r&&n)for(const i of e)t[i]=Ig(n,r)}class iT extends $l{constructor(e,n,s,r,i){super(e,n,s,r,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:s}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let h=e[l];if(typeof h=="string"&&(h=h.trim(),Dl(h))){const d=xg(h,n.current);d!==void 0&&(e[l]=d),l===e.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!vg.has(s)||e.length!==2)return;const[r,i]=e,o=vd(r),c=vd(i);if(o!==c)if(yd(o)&&yd(c))for(let l=0;l<e.length;l++){const h=e[l];typeof h=="string"&&(e[l]=parseFloat(h))}else $n[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,s=[];for(let r=0;r<e.length;r++)(e[r]===null||Xb(e[r]))&&s.push(r);s.length&&rT(e,s,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:s}=this;if(!e||!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=$n[s](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&e.getValue(s,r).jump(r,!1)}measureEndState(){var c;const{element:e,name:n,unresolvedKeyframes:s}=this;if(!e||!e.current)return;const r=e.getValue(n);r&&r.jump(this.measuredOrigin,!1);const i=s.length-1,o=s[i];s[i]=$n[n](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(c=this.removedTransforms)!=null&&c.length&&this.removedTransforms.forEach(([l,h])=>{e.getValue(l).set(h)}),this.resolveNoneKeyframes()}}function oT(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let s=document;const r=(n==null?void 0:n[t])??s.querySelectorAll(t);return r?Array.from(r):[]}return Array.from(t)}const Ag=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function Sg(t){return qp(t)&&"offsetHeight"in t}const Td=30,aT=t=>!isNaN(parseFloat(t));class cT{constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=(s,r=!0)=>{var o,c;const i=Ze.now();if(this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&((o=this.events.change)==null||o.notify(this.current),this.dependents))for(const l of this.dependents)l.dirty();r&&((c=this.events.renderRequest)==null||c.notify(this.current))},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=Ze.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=aT(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new Pl);const s=this.events[e].add(n);return e==="change"?()=>{s(),me.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ze.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Td)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,Td);return zp(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,n;(e=this.dependents)==null||e.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Is(t,e){return new cT(t,e)}const{schedule:Wl}=ng(queueMicrotask,!1),dt={x:!1,y:!1};function Ng(){return dt.x||dt.y}function lT(t){return t==="x"||t==="y"?dt[t]?null:(dt[t]=!0,()=>{dt[t]=!1}):dt.x||dt.y?null:(dt.x=dt.y=!0,()=>{dt.x=dt.y=!1})}function Pg(t,e){const n=oT(t),s=new AbortController,r={passive:!0,...e,signal:s.signal};return[n,r,()=>s.abort()]}function Ed(t){return!(t.pointerType==="touch"||Ng())}function uT(t,e,n={}){const[s,r,i]=Pg(t,n),o=c=>{if(!Ed(c))return;const{target:l}=c,h=e(l,c);if(typeof h!="function"||!l)return;const d=m=>{Ed(m)&&(h(m),l.removeEventListener("pointerleave",d))};l.addEventListener("pointerleave",d,r)};return s.forEach(c=>{c.addEventListener("pointerenter",o,r)}),i}const Cg=(t,e)=>e?t===e?!0:Cg(t,e.parentElement):!1,zl=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,hT=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function dT(t){return hT.has(t.tagName)||t.tabIndex!==-1}const Qi=new WeakSet;function Id(t){return e=>{e.key==="Enter"&&t(e)}}function Ba(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const fT=(t,e)=>{const n=t.currentTarget;if(!n)return;const s=Id(()=>{if(Qi.has(n))return;Ba(n,"down");const r=Id(()=>{Ba(n,"up")}),i=()=>Ba(n,"cancel");n.addEventListener("keyup",r,e),n.addEventListener("blur",i,e)});n.addEventListener("keydown",s,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",s),e)};function Ad(t){return zl(t)&&!Ng()}function mT(t,e,n={}){const[s,r,i]=Pg(t,n),o=c=>{const l=c.currentTarget;if(!Ad(c))return;Qi.add(l);const h=e(l,c),d=(y,x)=>{window.removeEventListener("pointerup",m),window.removeEventListener("pointercancel",p),Qi.has(l)&&Qi.delete(l),Ad(y)&&typeof h=="function"&&h(y,{success:x})},m=y=>{d(y,l===window||l===document||n.useGlobalTarget||Cg(l,y.target))},p=y=>{d(y,!1)};window.addEventListener("pointerup",m,r),window.addEventListener("pointercancel",p,r)};return s.forEach(c=>{(n.useGlobalTarget?window:c).addEventListener("pointerdown",o,r),Sg(c)&&(c.addEventListener("focus",h=>fT(h,r)),!dT(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),i}function Rg(t){return qp(t)&&"ownerSVGElement"in t}function pT(t){return Rg(t)&&t.tagName==="svg"}const He=t=>!!(t&&t.getVelocity),gT=[...Tg,Ie,gn],yT=t=>gT.find(bg(t)),Hl=b.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class _T extends b.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const s=n.offsetParent,r=Sg(s)&&s.offsetWidth||0,i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft,i.right=r-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function wT({children:t,isPresent:e,anchorX:n,root:s}){const r=b.useId(),i=b.useRef(null),o=b.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=b.useContext(Hl);return b.useInsertionEffect(()=>{const{width:l,height:h,top:d,left:m,right:p}=o.current;if(e||!i.current||!l||!h)return;const y=n==="left"?`left: ${m}`:`right: ${p}`;i.current.dataset.motionPopId=r;const x=document.createElement("style");c&&(x.nonce=c);const P=s??document.head;return P.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${h}px !important;
            ${y}px !important;
            top: ${d}px !important;
          }
        `),()=>{P.contains(x)&&P.removeChild(x)}},[e]),u.jsx(_T,{isPresent:e,childRef:i,sizeRef:o,children:b.cloneElement(t,{ref:i})})}const xT=({children:t,initial:e,isPresent:n,onExitComplete:s,custom:r,presenceAffectsLayout:i,mode:o,anchorX:c,root:l})=>{const h=Tl(vT),d=b.useId();let m=!0,p=b.useMemo(()=>(m=!1,{id:d,initial:e,isPresent:n,custom:r,onExitComplete:y=>{h.set(y,!0);for(const x of h.values())if(!x)return;s&&s()},register:y=>(h.set(y,!1),()=>h.delete(y))}),[n,h,s]);return i&&m&&(p={...p}),b.useMemo(()=>{h.forEach((y,x)=>h.set(x,!1))},[n]),b.useEffect(()=>{!n&&!h.size&&s&&s()},[n]),o==="popLayout"&&(t=u.jsx(wT,{isPresent:n,anchorX:c,root:l,children:t})),u.jsx($o.Provider,{value:p,children:t})};function vT(){return new Map}function kg(t=!0){const e=b.useContext($o);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:s,register:r}=e,i=b.useId();b.useEffect(()=>{if(t)return r(i)},[t]);const o=b.useCallback(()=>t&&s&&s(i),[i,s,t]);return!n&&s?[!1,o]:[!0]}const Li=t=>t.key||"";function Sd(t){const e=[];return b.Children.forEach(t,n=>{b.isValidElement(n)&&e.push(n)}),e}const kc=({children:t,custom:e,initial:n=!0,onExitComplete:s,presenceAffectsLayout:r=!0,mode:i="sync",propagate:o=!1,anchorX:c="left",root:l})=>{const[h,d]=kg(o),m=b.useMemo(()=>Sd(t),[t]),p=o&&!h?[]:m.map(Li),y=b.useRef(!0),x=b.useRef(m),P=Tl(()=>new Map),[C,S]=b.useState(m),[T,k]=b.useState(m);$p(()=>{y.current=!1,x.current=m;for(let V=0;V<T.length;V++){const E=Li(T[V]);p.includes(E)?P.delete(E):P.get(E)!==!0&&P.set(E,!1)}},[T,p.length,p.join("-")]);const L=[];if(m!==C){let V=[...m];for(let E=0;E<T.length;E++){const v=T[E],I=Li(v);p.includes(I)||(V.splice(E,0,v),L.push(v))}return i==="wait"&&L.length&&(V=L),k(Sd(V)),S(m),null}const{forceRender:D}=b.useContext(bl);return u.jsx(u.Fragment,{children:T.map(V=>{const E=Li(V),v=o&&!h?!1:m===T||p.includes(E),I=()=>{if(P.has(E))P.set(E,!0);else return;let N=!0;P.forEach(A=>{A||(N=!1)}),N&&(D==null||D(),k(x.current),o&&(d==null||d()),s&&s())};return u.jsx(xT,{isPresent:v,initial:!y.current||n?void 0:!1,custom:e,presenceAffectsLayout:r,mode:i,root:l,onExitComplete:v?void 0:I,anchorX:c,children:V},E)})})},Dg=b.createContext({strict:!1}),Nd={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},As={};for(const t in Nd)As[t]={isEnabled:e=>Nd[t].some(n=>!!e[n])};function bT(t){for(const e in t)As[e]={...As[e],...t[e]}}const TT=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function mo(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||TT.has(t)}let jg=t=>!mo(t);function ET(t){typeof t=="function"&&(jg=e=>e.startsWith("on")?!mo(e):t(e))}try{ET(require("@emotion/is-prop-valid").default)}catch{}function IT(t,e,n){const s={};for(const r in t)r==="values"&&typeof t.values=="object"||(jg(r)||n===!0&&mo(r)||!e&&!mo(r)||t.draggable&&r.startsWith("onDrag"))&&(s[r]=t[r]);return s}const Bo=b.createContext({});function qo(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function $r(t){return typeof t=="string"||Array.isArray(t)}const Gl=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Kl=["initial",...Gl];function Wo(t){return qo(t.animate)||Kl.some(e=>$r(t[e]))}function Vg(t){return!!(Wo(t)||t.variants)}function AT(t,e){if(Wo(t)){const{initial:n,animate:s}=t;return{initial:n===!1||$r(n)?n:void 0,animate:$r(s)?s:void 0}}return t.inherit!==!1?e:{}}function ST(t){const{initial:e,animate:n}=AT(t,b.useContext(Bo));return b.useMemo(()=>({initial:e,animate:n}),[Pd(e),Pd(n)])}function Pd(t){return Array.isArray(t)?t.join(" "):t}const Br={};function NT(t){for(const e in t)Br[e]=t[e],kl(e)&&(Br[e].isCSSVariable=!0)}function Mg(t,{layout:e,layoutId:n}){return $s.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Br[t]||t==="opacity")}const PT={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},CT=Us.length;function RT(t,e,n){let s="",r=!0;for(let i=0;i<CT;i++){const o=Us[i],c=t[o];if(c===void 0)continue;let l=!0;if(typeof c=="number"?l=c===(o.startsWith("scale")?1:0):l=parseFloat(c)===0,!l||n){const h=Ag(c,ql[o]);if(!l){r=!1;const d=PT[o]||o;s+=`${d}(${h}) `}n&&(e[o]=h)}}return s=s.trim(),n?s=n(e,r?"":s):r&&(s="none"),s}function Ql(t,e,n){const{style:s,vars:r,transformOrigin:i}=t;let o=!1,c=!1;for(const l in e){const h=e[l];if($s.has(l)){o=!0;continue}else if(kl(l)){r[l]=h;continue}else{const d=Ag(h,ql[l]);l.startsWith("origin")?(c=!0,i[l]=d):s[l]=d}}if(e.transform||(o||n?s.transform=RT(e,t.transform,n):s.transform&&(s.transform="none")),c){const{originX:l="50%",originY:h="50%",originZ:d=0}=i;s.transformOrigin=`${l} ${h} ${d}`}}const Yl=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Lg(t,e,n){for(const s in e)!He(e[s])&&!Mg(s,n)&&(t[s]=e[s])}function kT({transformTemplate:t},e){return b.useMemo(()=>{const n=Yl();return Ql(n,e,t),Object.assign({},n.vars,n.style)},[e])}function DT(t,e){const n=t.style||{},s={};return Lg(s,n,t),Object.assign(s,kT(t,e)),s}function jT(t,e){const n={},s=DT(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=s,n}const VT={offset:"stroke-dashoffset",array:"stroke-dasharray"},MT={offset:"strokeDashoffset",array:"strokeDasharray"};function LT(t,e,n=1,s=0,r=!0){t.pathLength=1;const i=r?VT:MT;t[i.offset]=Q.transform(-s);const o=Q.transform(e),c=Q.transform(n);t[i.array]=`${o} ${c}`}function Og(t,{attrX:e,attrY:n,attrScale:s,pathLength:r,pathSpacing:i=1,pathOffset:o=0,...c},l,h,d){if(Ql(t,c,h),l){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:m,style:p}=t;m.transform&&(p.transform=m.transform,delete m.transform),(p.transform||m.transformOrigin)&&(p.transformOrigin=m.transformOrigin??"50% 50%",delete m.transformOrigin),p.transform&&(p.transformBox=(d==null?void 0:d.transformBox)??"fill-box",delete m.transformBox),e!==void 0&&(m.x=e),n!==void 0&&(m.y=n),s!==void 0&&(m.scale=s),r!==void 0&&LT(m,r,i,o,!1)}const Fg=()=>({...Yl(),attrs:{}}),Ug=t=>typeof t=="string"&&t.toLowerCase()==="svg";function OT(t,e,n,s){const r=b.useMemo(()=>{const i=Fg();return Og(i,e,Ug(s),t.transformTemplate,t.style),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};Lg(i,t.style,t),r.style={...i,...r.style}}return r}const FT=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Xl(t){return typeof t!="string"||t.includes("-")?!1:!!(FT.indexOf(t)>-1||/[A-Z]/u.test(t))}function UT(t,e,n,{latestValues:s},r,i=!1){const c=(Xl(t)?OT:jT)(e,s,r,t),l=IT(e,typeof t=="string",i),h=t!==b.Fragment?{...l,...c,ref:n}:{},{children:d}=e,m=b.useMemo(()=>He(d)?d.get():d,[d]);return b.createElement(t,{...h,children:m})}function Cd(t){const e=[{},{}];return t==null||t.values.forEach((n,s)=>{e[0][s]=n.get(),e[1][s]=n.getVelocity()}),e}function Jl(t,e,n,s){if(typeof e=="function"){const[r,i]=Cd(s);e=e(n!==void 0?n:t.custom,r,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[r,i]=Cd(s);e=e(n!==void 0?n:t.custom,r,i)}return e}function Yi(t){return He(t)?t.get():t}function $T({scrapeMotionValuesFromProps:t,createRenderState:e},n,s,r){return{latestValues:BT(n,s,r,t),renderState:e()}}function BT(t,e,n,s){const r={},i=s(t,{});for(const p in i)r[p]=Yi(i[p]);let{initial:o,animate:c}=t;const l=Wo(t),h=Vg(t);e&&h&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),c===void 0&&(c=e.animate));let d=n?n.initial===!1:!1;d=d||o===!1;const m=d?c:o;if(m&&typeof m!="boolean"&&!qo(m)){const p=Array.isArray(m)?m:[m];for(let y=0;y<p.length;y++){const x=Jl(t,p[y]);if(x){const{transitionEnd:P,transition:C,...S}=x;for(const T in S){let k=S[T];if(Array.isArray(k)){const L=d?k.length-1:0;k=k[L]}k!==null&&(r[T]=k)}for(const T in P)r[T]=P[T]}}}return r}const $g=t=>(e,n)=>{const s=b.useContext(Bo),r=b.useContext($o),i=()=>$T(t,e,s,r);return n?i():Tl(i)};function Zl(t,e,n){var i;const{style:s}=t,r={};for(const o in s)(He(s[o])||e.style&&He(e.style[o])||Mg(o,t)||((i=n==null?void 0:n.getValue(o))==null?void 0:i.liveStyle)!==void 0)&&(r[o]=s[o]);return r}const qT=$g({scrapeMotionValuesFromProps:Zl,createRenderState:Yl});function Bg(t,e,n){const s=Zl(t,e,n);for(const r in t)if(He(t[r])||He(e[r])){const i=Us.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;s[i]=t[r]}return s}const WT=$g({scrapeMotionValuesFromProps:Bg,createRenderState:Fg}),zT=Symbol.for("motionComponentSymbol");function fs(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function HT(t,e,n){return b.useCallback(s=>{s&&t.onMount&&t.onMount(s),e&&(s?e.mount(s):e.unmount()),n&&(typeof n=="function"?n(s):fs(n)&&(n.current=s))},[e])}const eu=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),GT="framerAppearId",qg="data-"+eu(GT),Wg=b.createContext({});function KT(t,e,n,s,r){var P,C;const{visualElement:i}=b.useContext(Bo),o=b.useContext(Dg),c=b.useContext($o),l=b.useContext(Hl).reducedMotion,h=b.useRef(null);s=s||o.renderer,!h.current&&s&&(h.current=s(t,{visualState:e,parent:i,props:n,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:l}));const d=h.current,m=b.useContext(Wg);d&&!d.projection&&r&&(d.type==="html"||d.type==="svg")&&QT(h.current,n,r,m);const p=b.useRef(!1);b.useInsertionEffect(()=>{d&&p.current&&d.update(n,c)});const y=n[qg],x=b.useRef(!!y&&!((P=window.MotionHandoffIsComplete)!=null&&P.call(window,y))&&((C=window.MotionHasOptimisedAnimation)==null?void 0:C.call(window,y)));return $p(()=>{d&&(p.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),x.current&&d.animationState&&d.animationState.animateChanges())}),b.useEffect(()=>{d&&(!x.current&&d.animationState&&d.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var S;(S=window.MotionHandoffMarkAsComplete)==null||S.call(window,y)}),x.current=!1))}),d}function QT(t,e,n,s){const{layoutId:r,layout:i,drag:o,dragConstraints:c,layoutScroll:l,layoutRoot:h,layoutCrossfade:d}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:zg(t.parent)),t.projection.setOptions({layoutId:r,layout:i,alwaysMeasureLayout:!!o||c&&fs(c),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:s,crossfade:d,layoutScroll:l,layoutRoot:h})}function zg(t){if(t)return t.options.allowProjection!==!1?t.projection:zg(t.parent)}function qa(t,{forwardMotionProps:e=!1}={},n,s){n&&bT(n);const r=Xl(t)?WT:qT;function i(c,l){let h;const d={...b.useContext(Hl),...c,layoutId:YT(c)},{isStatic:m}=d,p=ST(c),y=r(c,m);if(!m&&El){XT();const x=JT(d);h=x.MeasureLayout,p.visualElement=KT(t,y,d,s,x.ProjectionNode)}return u.jsxs(Bo.Provider,{value:p,children:[h&&p.visualElement?u.jsx(h,{visualElement:p.visualElement,...d}):null,UT(t,c,HT(y,p.visualElement,l),y,m,e)]})}i.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const o=b.forwardRef(i);return o[zT]=t,o}function YT({layoutId:t}){const e=b.useContext(bl).id;return e&&t!==void 0?e+"-"+t:t}function XT(t,e){b.useContext(Dg).strict}function JT(t){const{drag:e,layout:n}=As;if(!e&&!n)return{};const s={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function ZT(t,e){if(typeof Proxy>"u")return qa;const n=new Map,s=(i,o)=>qa(i,o,t,e),r=(i,o)=>s(i,o);return new Proxy(r,{get:(i,o)=>o==="create"?s:(n.has(o)||n.set(o,qa(o,void 0,t,e)),n.get(o))})}function Hg({top:t,left:e,right:n,bottom:s}){return{x:{min:e,max:n},y:{min:t,max:s}}}function eE({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function tE(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function Wa(t){return t===void 0||t===1}function Dc({scale:t,scaleX:e,scaleY:n}){return!Wa(t)||!Wa(e)||!Wa(n)}function Dn(t){return Dc(t)||Gg(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function Gg(t){return Rd(t.x)||Rd(t.y)}function Rd(t){return t&&t!=="0%"}function po(t,e,n){const s=t-n,r=e*s;return n+r}function kd(t,e,n,s,r){return r!==void 0&&(t=po(t,r,s)),po(t,n,s)+e}function jc(t,e=0,n=1,s,r){t.min=kd(t.min,e,n,s,r),t.max=kd(t.max,e,n,s,r)}function Kg(t,{x:e,y:n}){jc(t.x,e.translate,e.scale,e.originPoint),jc(t.y,n.translate,n.scale,n.originPoint)}const Dd=.999999999999,jd=1.0000000000001;function nE(t,e,n,s=!1){const r=n.length;if(!r)return;e.x=e.y=1;let i,o;for(let c=0;c<r;c++){i=n[c],o=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(s&&i.options.layoutScroll&&i.scroll&&i!==i.root&&ps(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,Kg(t,o)),s&&Dn(i.latestValues)&&ps(t,i.latestValues))}e.x<jd&&e.x>Dd&&(e.x=1),e.y<jd&&e.y>Dd&&(e.y=1)}function ms(t,e){t.min=t.min+e,t.max=t.max+e}function Vd(t,e,n,s,r=.5){const i=ge(t.min,t.max,r);jc(t,e,n,i,s)}function ps(t,e){Vd(t.x,e.x,e.scaleX,e.scale,e.originX),Vd(t.y,e.y,e.scaleY,e.scale,e.originY)}function Qg(t,e){return Hg(tE(t.getBoundingClientRect(),e))}function sE(t,e,n){const s=Qg(t,n),{scroll:r}=e;return r&&(ms(s.x,r.offset.x),ms(s.y,r.offset.y)),s}const Md=()=>({translate:0,scale:1,origin:0,originPoint:0}),gs=()=>({x:Md(),y:Md()}),Ld=()=>({min:0,max:0}),xe=()=>({x:Ld(),y:Ld()}),Vc={current:null},Yg={current:!1};function rE(){if(Yg.current=!0,!!El)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Vc.current=t.matches;t.addEventListener("change",e),e()}else Vc.current=!1}const iE=new WeakMap;function oE(t,e,n){for(const s in e){const r=e[s],i=n[s];if(He(r))t.addValue(s,r);else if(He(i))t.addValue(s,Is(r,{owner:t}));else if(i!==r)if(t.hasValue(s)){const o=t.getValue(s);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=t.getStaticValue(s);t.addValue(s,Is(o!==void 0?o:r,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const Od=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class aE{scrapeMotionValuesFromProps(e,n,s){return{}}constructor({parent:e,props:n,presenceContext:s,reducedMotionConfig:r,blockInitialAnimation:i,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=$l,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const p=Ze.now();this.renderScheduledAt<p&&(this.renderScheduledAt=p,me.render(this.render,!1,!0))};const{latestValues:l,renderState:h}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=h,this.parent=e,this.props=n,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=c,this.blockInitialAnimation=!!i,this.isControllingVariants=Wo(n),this.isVariantNode=Vg(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...m}=this.scrapeMotionValuesFromProps(n,{},this);for(const p in m){const y=m[p];l[p]!==void 0&&He(y)&&y.set(l[p],!1)}}mount(e){this.current=e,iE.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),Yg.current||rE(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Vc.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),pn(this.notifyUpdate),pn(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const n=this.features[e];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const s=$s.has(e);s&&this.onBindTransform&&this.onBindTransform();const r=n.on("change",c=>{this.latestValues[e]=c,this.props.onUpdate&&me.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{r(),i(),o&&o(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in As){const n=As[e];if(!n)continue;const{isEnabled:s,Feature:r}=n;if(!this.features[e]&&r&&s(this.props)&&(this.features[e]=new r(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):xe()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<Od.length;s++){const r=Od[s];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const i="on"+r,o=e[i];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=oE(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const s=this.values.get(e);n!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&n!==void 0&&(s=Is(n===null?void 0:n,{owner:this}),this.addValue(e,s)),s}readValue(e,n){let s=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return s!=null&&(typeof s=="string"&&(Bp(s)||Wp(s))?s=parseFloat(s):!yT(s)&&gn.test(n)&&(s=Ig(e,n)),this.setBaseTarget(e,He(s)?s.get():s)),He(s)?s.get():s}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var i;const{initial:n}=this.props;let s;if(typeof n=="string"||typeof n=="object"){const o=Jl(this.props,n,(i=this.presenceContext)==null?void 0:i.custom);o&&(s=o[e])}if(n&&s!==void 0)return s;const r=this.getBaseTargetFromProps(this.props,e);return r!==void 0&&!He(r)?r:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new Pl),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){Wl.render(this.render)}}class Xg extends aE{constructor(){super(...arguments),this.KeyframeResolver=iT}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:s}){delete n[e],delete s[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;He(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function Jg(t,{style:e,vars:n},s,r){const i=t.style;let o;for(o in e)i[o]=e[o];r==null||r.applyProjectionStyles(i,s);for(o in n)i.setProperty(o,n[o])}function cE(t){return window.getComputedStyle(t)}class lE extends Xg{constructor(){super(...arguments),this.type="html",this.renderInstance=Jg}readValueFromInstance(e,n){var s;if($s.has(n))return(s=this.projection)!=null&&s.isProjecting?Ac(n):Eb(e,n);{const r=cE(e),i=(kl(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return Qg(e,n)}build(e,n,s){Ql(e,n,s.transformTemplate)}scrapeMotionValuesFromProps(e,n,s){return Zl(e,n,s)}}const Zg=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function uE(t,e,n,s){Jg(t,e,void 0,s);for(const r in e.attrs)t.setAttribute(Zg.has(r)?r:eu(r),e.attrs[r])}class hE extends Xg{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=xe}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if($s.has(n)){const s=Eg(n);return s&&s.default||0}return n=Zg.has(n)?n:eu(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,s){return Bg(e,n,s)}build(e,n,s){Og(e,n,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(e,n,s,r){uE(e,n,s,r)}mount(e){this.isSVGTag=Ug(e.tagName),super.mount(e)}}const dE=(t,e)=>Xl(t)?new hE(e):new lE(e,{allowProjection:t!==b.Fragment});function qr(t,e,n){const s=t.getProps();return Jl(s,e,n!==void 0?n:s.custom,t)}const Mc=t=>Array.isArray(t);function fE(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Is(n))}function mE(t){return Mc(t)?t[t.length-1]||0:t}function pE(t,e){const n=qr(t,e);let{transitionEnd:s={},transition:r={},...i}=n||{};i={...i,...s};for(const o in i){const c=mE(i[o]);fE(t,o,c)}}function gE(t){return!!(He(t)&&t.add)}function Lc(t,e){const n=t.getValue("willChange");if(gE(n))return n.add(e);if(!n&&Wt.WillChange){const s=new Wt.WillChange("auto");t.addValue("willChange",s),s.add(e)}}function ey(t){return t.props[qg]}const yE=t=>t!==null;function _E(t,{repeat:e,repeatType:n="loop"},s){const r=t.filter(yE),i=e&&n!=="loop"&&e%2===1?0:r.length-1;return r[i]}const wE={type:"spring",stiffness:500,damping:25,restSpeed:10},xE=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),vE={type:"keyframes",duration:.8},bE={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},TE=(t,{keyframes:e})=>e.length>2?vE:$s.has(t)?t.startsWith("scale")?xE(e[1]):wE:bE;function EE({when:t,delay:e,delayChildren:n,staggerChildren:s,staggerDirection:r,repeat:i,repeatType:o,repeatDelay:c,from:l,elapsed:h,...d}){return!!Object.keys(d).length}const tu=(t,e,n,s={},r,i)=>o=>{const c=Bl(s,t)||{},l=c.delay||s.delay||0;let{elapsed:h=0}=s;h=h-It(l);const d={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...c,delay:-h,onUpdate:p=>{e.set(p),c.onUpdate&&c.onUpdate(p)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:t,motionValue:e,element:i?void 0:r};EE(c)||Object.assign(d,TE(t,d)),d.duration&&(d.duration=It(d.duration)),d.repeatDelay&&(d.repeatDelay=It(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let m=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(d.duration=0,d.delay===0&&(m=!0)),(Wt.instantAnimations||Wt.skipAnimations)&&(m=!0,d.duration=0,d.delay=0),d.allowFlatten=!c.type&&!c.ease,m&&!i&&e.get()!==void 0){const p=_E(d.keyframes,c);if(p!==void 0){me.update(()=>{d.onUpdate(p),d.onComplete()});return}}return c.isSync?new Ul(d):new Gb(d)};function IE({protectedKeys:t,needsAnimating:e},n){const s=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,s}function ty(t,e,{delay:n=0,transitionOverride:s,type:r}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:o,...c}=e;s&&(i=s);const l=[],h=r&&t.animationState&&t.animationState.getState()[r];for(const d in c){const m=t.getValue(d,t.latestValues[d]??null),p=c[d];if(p===void 0||h&&IE(h,d))continue;const y={delay:n,...Bl(i||{},d)},x=m.get();if(x!==void 0&&!m.isAnimating&&!Array.isArray(p)&&p===x&&!y.velocity)continue;let P=!1;if(window.MotionHandoffAnimation){const S=ey(t);if(S){const T=window.MotionHandoffAnimation(S,d,me);T!==null&&(y.startTime=T,P=!0)}}Lc(t,d),m.start(tu(d,m,p,t.shouldReduceMotion&&vg.has(d)?{type:!1}:y,t,P));const C=m.animation;C&&l.push(C)}return o&&Promise.all(l).then(()=>{me.update(()=>{o&&pE(t,o)})}),l}function Oc(t,e,n={}){var l;const s=qr(t,e,n.type==="exit"?(l=t.presenceContext)==null?void 0:l.custom:void 0);let{transition:r=t.getDefaultTransition()||{}}=s||{};n.transitionOverride&&(r=n.transitionOverride);const i=s?()=>Promise.all(ty(t,s,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(h=0)=>{const{delayChildren:d=0,staggerChildren:m,staggerDirection:p}=r;return AE(t,e,h,d,m,p,n)}:()=>Promise.resolve(),{when:c}=r;if(c){const[h,d]=c==="beforeChildren"?[i,o]:[o,i];return h().then(()=>d())}else return Promise.all([i(),o(n.delay)])}function AE(t,e,n=0,s=0,r=0,i=1,o){const c=[],l=t.variantChildren.size,h=(l-1)*r,d=typeof s=="function",m=d?p=>s(p,l):i===1?(p=0)=>p*r:(p=0)=>h-p*r;return Array.from(t.variantChildren).sort(SE).forEach((p,y)=>{p.notify("AnimationStart",e),c.push(Oc(p,e,{...o,delay:n+(d?0:s)+m(y)}).then(()=>p.notify("AnimationComplete",e)))}),Promise.all(c)}function SE(t,e){return t.sortNodePosition(e)}function NE(t,e,n={}){t.notify("AnimationStart",e);let s;if(Array.isArray(e)){const r=e.map(i=>Oc(t,i,n));s=Promise.all(r)}else if(typeof e=="string")s=Oc(t,e,n);else{const r=typeof e=="function"?qr(t,e,n.custom):e;s=Promise.all(ty(t,r,n))}return s.then(()=>{t.notify("AnimationComplete",e)})}function ny(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}const PE=Kl.length;function sy(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?sy(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<PE;n++){const s=Kl[n],r=t.props[s];($r(r)||r===!1)&&(e[s]=r)}return e}const CE=[...Gl].reverse(),RE=Gl.length;function kE(t){return e=>Promise.all(e.map(({animation:n,options:s})=>NE(t,n,s)))}function DE(t){let e=kE(t),n=Fd(),s=!0;const r=l=>(h,d)=>{var p;const m=qr(t,d,l==="exit"?(p=t.presenceContext)==null?void 0:p.custom:void 0);if(m){const{transition:y,transitionEnd:x,...P}=m;h={...h,...P,...x}}return h};function i(l){e=l(t)}function o(l){const{props:h}=t,d=sy(t.parent)||{},m=[],p=new Set;let y={},x=1/0;for(let C=0;C<RE;C++){const S=CE[C],T=n[S],k=h[S]!==void 0?h[S]:d[S],L=$r(k),D=S===l?T.isActive:null;D===!1&&(x=C);let V=k===d[S]&&k!==h[S]&&L;if(V&&s&&t.manuallyAnimateOnMount&&(V=!1),T.protectedKeys={...y},!T.isActive&&D===null||!k&&!T.prevProp||qo(k)||typeof k=="boolean")continue;const E=jE(T.prevProp,k);let v=E||S===l&&T.isActive&&!V&&L||C>x&&L,I=!1;const N=Array.isArray(k)?k:[k];let A=N.reduce(r(S),{});D===!1&&(A={});const{prevResolvedValues:R={}}=T,_={...R,...A},B=te=>{v=!0,p.has(te)&&(I=!0,p.delete(te)),T.needsAnimating[te]=!0;const O=t.getValue(te);O&&(O.liveStyle=!1)};for(const te in _){const O=A[te],J=R[te];if(y.hasOwnProperty(te))continue;let fe=!1;Mc(O)&&Mc(J)?fe=!ny(O,J):fe=O!==J,fe?O!=null?B(te):p.add(te):O!==void 0&&p.has(te)?B(te):T.protectedKeys[te]=!0}T.prevProp=k,T.prevResolvedValues=A,T.isActive&&(y={...y,...A}),s&&t.blockInitialAnimation&&(v=!1),v&&(!(V&&E)||I)&&m.push(...N.map(te=>({animation:te,options:{type:S}})))}if(p.size){const C={};if(typeof h.initial!="boolean"){const S=qr(t,Array.isArray(h.initial)?h.initial[0]:h.initial);S&&S.transition&&(C.transition=S.transition)}p.forEach(S=>{const T=t.getBaseTarget(S),k=t.getValue(S);k&&(k.liveStyle=!0),C[S]=T??null}),m.push({animation:C})}let P=!!m.length;return s&&(h.initial===!1||h.initial===h.animate)&&!t.manuallyAnimateOnMount&&(P=!1),s=!1,P?e(m):Promise.resolve()}function c(l,h){var m;if(n[l].isActive===h)return Promise.resolve();(m=t.variantChildren)==null||m.forEach(p=>{var y;return(y=p.animationState)==null?void 0:y.setActive(l,h)}),n[l].isActive=h;const d=o(l);for(const p in n)n[p].protectedKeys={};return d}return{animateChanges:o,setActive:c,setAnimateFunction:i,getState:()=>n,reset:()=>{n=Fd(),s=!0}}}function jE(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!ny(e,t):!1}function kn(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Fd(){return{animate:kn(!0),whileInView:kn(),whileHover:kn(),whileTap:kn(),whileDrag:kn(),whileFocus:kn(),exit:kn()}}class En{constructor(e){this.isMounted=!1,this.node=e}update(){}}class VE extends En{constructor(e){super(e),e.animationState||(e.animationState=DE(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();qo(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let ME=0;class LE extends En{constructor(){super(...arguments),this.id=ME++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const r=this.node.animationState.setActive("exit",!e);n&&!e&&r.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const OE={animation:{Feature:VE},exit:{Feature:LE}};function Wr(t,e,n,s={passive:!0}){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n)}function hi(t){return{point:{x:t.pageX,y:t.pageY}}}const FE=t=>e=>zl(e)&&t(e,hi(e));function Er(t,e,n,s){return Wr(t,e,FE(n),s)}const ry=1e-4,UE=1-ry,$E=1+ry,iy=.01,BE=0-iy,qE=0+iy;function Xe(t){return t.max-t.min}function WE(t,e,n){return Math.abs(t-e)<=n}function Ud(t,e,n,s=.5){t.origin=s,t.originPoint=ge(e.min,e.max,t.origin),t.scale=Xe(n)/Xe(e),t.translate=ge(n.min,n.max,t.origin)-t.originPoint,(t.scale>=UE&&t.scale<=$E||isNaN(t.scale))&&(t.scale=1),(t.translate>=BE&&t.translate<=qE||isNaN(t.translate))&&(t.translate=0)}function Ir(t,e,n,s){Ud(t.x,e.x,n.x,s?s.originX:void 0),Ud(t.y,e.y,n.y,s?s.originY:void 0)}function $d(t,e,n){t.min=n.min+e.min,t.max=t.min+Xe(e)}function zE(t,e,n){$d(t.x,e.x,n.x),$d(t.y,e.y,n.y)}function Bd(t,e,n){t.min=e.min-n.min,t.max=t.min+Xe(e)}function Ar(t,e,n){Bd(t.x,e.x,n.x),Bd(t.y,e.y,n.y)}function rt(t){return[t("x"),t("y")]}const oy=({current:t})=>t?t.ownerDocument.defaultView:null,qd=(t,e)=>Math.abs(t-e);function HE(t,e){const n=qd(t.x,e.x),s=qd(t.y,e.y);return Math.sqrt(n**2+s**2)}class ay{constructor(e,n,{transformPagePoint:s,contextWindow:r=window,dragSnapToOrigin:i=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const p=Ha(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,x=HE(p.offset,{x:0,y:0})>=this.distanceThreshold;if(!y&&!x)return;const{point:P}=p,{timestamp:C}=Ve;this.history.push({...P,timestamp:C});const{onStart:S,onMove:T}=this.handlers;y||(S&&S(this.lastMoveEvent,p),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,p)},this.handlePointerMove=(p,y)=>{this.lastMoveEvent=p,this.lastMoveEventInfo=za(y,this.transformPagePoint),me.update(this.updatePoint,!0)},this.handlePointerUp=(p,y)=>{this.end();const{onEnd:x,onSessionEnd:P,resumeAnimation:C}=this.handlers;if(this.dragSnapToOrigin&&C&&C(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const S=Ha(p.type==="pointercancel"?this.lastMoveEventInfo:za(y,this.transformPagePoint),this.history);this.startEvent&&x&&x(p,S),P&&P(p,S)},!zl(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=s,this.distanceThreshold=o,this.contextWindow=r||window;const c=hi(e),l=za(c,this.transformPagePoint),{point:h}=l,{timestamp:d}=Ve;this.history=[{...h,timestamp:d}];const{onSessionStart:m}=n;m&&m(e,Ha(l,this.history)),this.removeListeners=ci(Er(this.contextWindow,"pointermove",this.handlePointerMove),Er(this.contextWindow,"pointerup",this.handlePointerUp),Er(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),pn(this.updatePoint)}}function za(t,e){return e?{point:e(t.point)}:t}function Wd(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Ha({point:t},e){return{point:t,delta:Wd(t,cy(e)),offset:Wd(t,GE(e)),velocity:KE(e,.1)}}function GE(t){return t[0]}function cy(t){return t[t.length-1]}function KE(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,s=null;const r=cy(t);for(;n>=0&&(s=t[n],!(r.timestamp-s.timestamp>It(e)));)n--;if(!s)return{x:0,y:0};const i=At(r.timestamp-s.timestamp);if(i===0)return{x:0,y:0};const o={x:(r.x-s.x)/i,y:(r.y-s.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function QE(t,{min:e,max:n},s){return e!==void 0&&t<e?t=s?ge(e,t,s.min):Math.max(t,e):n!==void 0&&t>n&&(t=s?ge(n,t,s.max):Math.min(t,n)),t}function zd(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function YE(t,{top:e,left:n,bottom:s,right:r}){return{x:zd(t.x,n,r),y:zd(t.y,e,s)}}function Hd(t,e){let n=e.min-t.min,s=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,s]=[s,n]),{min:n,max:s}}function XE(t,e){return{x:Hd(t.x,e.x),y:Hd(t.y,e.y)}}function JE(t,e){let n=.5;const s=Xe(t),r=Xe(e);return r>s?n=Or(e.min,e.max-s,t.min):s>r&&(n=Or(t.min,t.max-r,e.min)),qt(0,1,n)}function ZE(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const Fc=.35;function e1(t=Fc){return t===!1?t=0:t===!0&&(t=Fc),{x:Gd(t,"left","right"),y:Gd(t,"top","bottom")}}function Gd(t,e,n){return{min:Kd(t,e),max:Kd(t,n)}}function Kd(t,e){return typeof t=="number"?t:t[e]||0}const t1=new WeakMap;class n1{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=xe(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:s}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=m=>{const{dragSnapToOrigin:p}=this.getProps();p?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(hi(m).point)},o=(m,p)=>{const{drag:y,dragPropagation:x,onDragStart:P}=this.getProps();if(y&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=lT(y),!this.openDragLock))return;this.latestPointerEvent=m,this.latestPanInfo=p,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),rt(S=>{let T=this.getAxisMotionValue(S).get()||0;if(St.test(T)){const{projection:k}=this.visualElement;if(k&&k.layout){const L=k.layout.layoutBox[S];L&&(T=Xe(L)*(parseFloat(T)/100))}}this.originPoint[S]=T}),P&&me.postRender(()=>P(m,p)),Lc(this.visualElement,"transform");const{animationState:C}=this.visualElement;C&&C.setActive("whileDrag",!0)},c=(m,p)=>{this.latestPointerEvent=m,this.latestPanInfo=p;const{dragPropagation:y,dragDirectionLock:x,onDirectionLock:P,onDrag:C}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:S}=p;if(x&&this.currentDirection===null){this.currentDirection=s1(S),this.currentDirection!==null&&P&&P(this.currentDirection);return}this.updateAxis("x",p.point,S),this.updateAxis("y",p.point,S),this.visualElement.render(),C&&C(m,p)},l=(m,p)=>{this.latestPointerEvent=m,this.latestPanInfo=p,this.stop(m,p),this.latestPointerEvent=null,this.latestPanInfo=null},h=()=>rt(m=>{var p;return this.getAnimationState(m)==="paused"&&((p=this.getAxisMotionValue(m).animation)==null?void 0:p.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new ay(e,{onSessionStart:i,onStart:o,onMove:c,onSessionEnd:l,resumeAnimation:h},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:s,contextWindow:oy(this.visualElement)})}stop(e,n){const s=e||this.latestPointerEvent,r=n||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!r||!s)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:c}=this.getProps();c&&me.postRender(()=>c(s,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,s){const{drag:r}=this.getProps();if(!s||!Oi(e,r,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(o=QE(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var i;const{dragConstraints:e,dragElastic:n}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,r=this.constraints;e&&fs(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&s?this.constraints=YE(s.layoutBox,e):this.constraints=!1,this.elastic=e1(n),r!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&rt(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=ZE(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!fs(e))return!1;const s=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const i=sE(s,r.root,this.visualElement.getTransformPagePoint());let o=XE(r.layout.layoutBox,i);if(n){const c=n(eE(o));this.hasMutatedConstraints=!!c,c&&(o=Hg(c))}return o}startAnimation(e){const{drag:n,dragMomentum:s,dragElastic:r,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),l=this.constraints||{},h=rt(d=>{if(!Oi(d,n,this.currentDirection))return;let m=l&&l[d]||{};o&&(m={min:0,max:0});const p=r?200:1e6,y=r?40:1e7,x={type:"inertia",velocity:s?e[d]:0,bounceStiffness:p,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...i,...m};return this.startAxisValueAnimation(d,x)});return Promise.all(h).then(c)}startAxisValueAnimation(e,n){const s=this.getAxisMotionValue(e);return Lc(this.visualElement,e),s.start(tu(e,s,0,n,this.visualElement,!1))}stopAnimation(){rt(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){rt(e=>{var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),r=s[n];return r||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){rt(n=>{const{drag:s}=this.getProps();if(!Oi(n,s,this.currentDirection))return;const{projection:r}=this.visualElement,i=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:c}=r.layout.layoutBox[n];i.set(e[n]-ge(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!fs(n)||!s||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};rt(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const l=c.get();r[o]=JE({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),rt(o=>{if(!Oi(o,e,null))return;const c=this.getAxisMotionValue(o),{min:l,max:h}=this.constraints[o];c.set(ge(l,h,r[o]))})}addListeners(){if(!this.visualElement.current)return;t1.set(this.visualElement,this);const e=this.visualElement.current,n=Er(e,"pointerdown",l=>{const{drag:h,dragListener:d=!0}=this.getProps();h&&d&&this.start(l)}),s=()=>{const{dragConstraints:l}=this.getProps();fs(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,i=r.addEventListener("measure",s);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),me.read(s);const o=Wr(window,"resize",()=>this.scalePositionWithinConstraints()),c=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:h})=>{this.isDragging&&h&&(rt(d=>{const m=this.getAxisMotionValue(d);m&&(this.originPoint[d]+=l[d].translate,m.set(m.get()+l[d].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),c&&c()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:r=!1,dragConstraints:i=!1,dragElastic:o=Fc,dragMomentum:c=!0}=e;return{...e,drag:n,dragDirectionLock:s,dragPropagation:r,dragConstraints:i,dragElastic:o,dragMomentum:c}}}function Oi(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function s1(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class r1 extends En{constructor(e){super(e),this.removeGroupControls=ct,this.removeListeners=ct,this.controls=new n1(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ct}unmount(){this.removeGroupControls(),this.removeListeners()}}const Qd=t=>(e,n)=>{t&&me.postRender(()=>t(e,n))};class i1 extends En{constructor(){super(...arguments),this.removePointerDownListener=ct}onPointerDown(e){this.session=new ay(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:oy(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:s,onPanEnd:r}=this.node.getProps();return{onSessionStart:Qd(e),onStart:Qd(n),onMove:s,onEnd:(i,o)=>{delete this.session,r&&me.postRender(()=>r(i,o))}}}mount(){this.removePointerDownListener=Er(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Xi={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Yd(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const fr={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Q.test(t))t=parseFloat(t);else return t;const n=Yd(t,e.target.x),s=Yd(t,e.target.y);return`${n}% ${s}%`}},o1={correct:(t,{treeScale:e,projectionDelta:n})=>{const s=t,r=gn.parse(t);if(r.length>5)return s;const i=gn.createTransformer(t),o=typeof r[0]!="number"?1:0,c=n.x.scale*e.x,l=n.y.scale*e.y;r[0+o]/=c,r[1+o]/=l;const h=ge(c,l,.5);return typeof r[2+o]=="number"&&(r[2+o]/=h),typeof r[3+o]=="number"&&(r[3+o]/=h),i(r)}};let Xd=!1;class a1 extends b.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s,layoutId:r}=this.props,{projection:i}=e;NT(c1),i&&(n.group&&n.group.add(i),s&&s.register&&r&&s.register(i),Xd&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Xi.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:s,drag:r,isPresent:i}=this.props,{projection:o}=s;return o&&(o.isPresent=i,Xd=!0,r||e.layoutDependency!==n||n===void 0||e.isPresent!==i?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||me.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Wl.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),s&&s.deregister&&s.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function ly(t){const[e,n]=kg(),s=b.useContext(bl);return u.jsx(a1,{...t,layoutGroup:s,switchLayoutGroup:b.useContext(Wg),isPresent:e,safeToRemove:n})}const c1={borderRadius:{...fr,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:fr,borderTopRightRadius:fr,borderBottomLeftRadius:fr,borderBottomRightRadius:fr,boxShadow:o1};function l1(t,e,n){const s=He(t)?t:Is(t);return s.start(tu("",s,e,n)),s.animation}const u1=(t,e)=>t.depth-e.depth;class h1{constructor(){this.children=[],this.isDirty=!1}add(e){Il(this.children,e),this.isDirty=!0}remove(e){Al(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(u1),this.isDirty=!1,this.children.forEach(e)}}function d1(t,e){const n=Ze.now(),s=({timestamp:r})=>{const i=r-n;i>=e&&(pn(s),t(i-e))};return me.setup(s,!0),()=>pn(s)}const uy=["TopLeft","TopRight","BottomLeft","BottomRight"],f1=uy.length,Jd=t=>typeof t=="string"?parseFloat(t):t,Zd=t=>typeof t=="number"||Q.test(t);function m1(t,e,n,s,r,i){r?(t.opacity=ge(0,n.opacity??1,p1(s)),t.opacityExit=ge(e.opacity??1,0,g1(s))):i&&(t.opacity=ge(e.opacity??1,n.opacity??1,s));for(let o=0;o<f1;o++){const c=`border${uy[o]}Radius`;let l=ef(e,c),h=ef(n,c);if(l===void 0&&h===void 0)continue;l||(l=0),h||(h=0),l===0||h===0||Zd(l)===Zd(h)?(t[c]=Math.max(ge(Jd(l),Jd(h),s),0),(St.test(h)||St.test(l))&&(t[c]+="%")):t[c]=h}(e.rotate||n.rotate)&&(t.rotate=ge(e.rotate||0,n.rotate||0,s))}function ef(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const p1=hy(0,.5,Jp),g1=hy(.5,.95,ct);function hy(t,e,n){return s=>s<t?0:s>e?1:n(Or(t,e,s))}function tf(t,e){t.min=e.min,t.max=e.max}function st(t,e){tf(t.x,e.x),tf(t.y,e.y)}function nf(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function sf(t,e,n,s,r){return t-=e,t=po(t,1/n,s),r!==void 0&&(t=po(t,1/r,s)),t}function y1(t,e=0,n=1,s=.5,r,i=t,o=t){if(St.test(e)&&(e=parseFloat(e),e=ge(o.min,o.max,e/100)-o.min),typeof e!="number")return;let c=ge(i.min,i.max,s);t===i&&(c-=e),t.min=sf(t.min,e,n,c,r),t.max=sf(t.max,e,n,c,r)}function rf(t,e,[n,s,r],i,o){y1(t,e[n],e[s],e[r],e.scale,i,o)}const _1=["x","scaleX","originX"],w1=["y","scaleY","originY"];function of(t,e,n,s){rf(t.x,e,_1,n?n.x:void 0,s?s.x:void 0),rf(t.y,e,w1,n?n.y:void 0,s?s.y:void 0)}function af(t){return t.translate===0&&t.scale===1}function dy(t){return af(t.x)&&af(t.y)}function cf(t,e){return t.min===e.min&&t.max===e.max}function x1(t,e){return cf(t.x,e.x)&&cf(t.y,e.y)}function lf(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function fy(t,e){return lf(t.x,e.x)&&lf(t.y,e.y)}function uf(t){return Xe(t.x)/Xe(t.y)}function hf(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class v1{constructor(){this.members=[]}add(e){Il(this.members,e),e.scheduleRender()}remove(e){if(Al(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(r=>e===r);if(n===0)return!1;let s;for(let r=n;r>=0;r--){const i=this.members[r];if(i.isPresent!==!1){s=i;break}}return s?(this.promote(s),!0):!1}promote(e,n){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,n&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:s}=e;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function b1(t,e,n){let s="";const r=t.x.translate/e.x,i=t.y.translate/e.y,o=(n==null?void 0:n.z)||0;if((r||i||o)&&(s=`translate3d(${r}px, ${i}px, ${o}px) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:h,rotate:d,rotateX:m,rotateY:p,skewX:y,skewY:x}=n;h&&(s=`perspective(${h}px) ${s}`),d&&(s+=`rotate(${d}deg) `),m&&(s+=`rotateX(${m}deg) `),p&&(s+=`rotateY(${p}deg) `),y&&(s+=`skewX(${y}deg) `),x&&(s+=`skewY(${x}deg) `)}const c=t.x.scale*e.x,l=t.y.scale*e.y;return(c!==1||l!==1)&&(s+=`scale(${c}, ${l})`),s||"none"}const Ga=["","X","Y","Z"],T1=1e3;let E1=0;function Ka(t,e,n,s){const{latestValues:r}=e;r[t]&&(n[t]=r[t],e.setStaticValue(t,0),s&&(s[t]=0))}function my(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=ey(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:r,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",me,!(r||i))}const{parent:s}=t;s&&!s.hasCheckedOptimisedAppear&&my(s)}function py({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:s,resetTransform:r}){return class{constructor(o={},c=e==null?void 0:e()){this.id=E1++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(S1),this.nodes.forEach(R1),this.nodes.forEach(k1),this.nodes.forEach(N1)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new h1)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Pl),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const l=this.eventHandlers.get(o);l&&l.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=Rg(o)&&!pT(o),this.instance=o;const{layoutId:c,layout:l,visualElement:h}=this.options;if(h&&!h.current&&h.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||c)&&(this.isLayoutDirty=!0),t){let d,m=0;const p=()=>this.root.updateBlockedByResize=!1;me.read(()=>{m=window.innerWidth}),t(o,()=>{const y=window.innerWidth;y!==m&&(m=y,this.root.updateBlockedByResize=!0,d&&d(),d=d1(p,250),Xi.hasAnimatedSinceResize&&(Xi.hasAnimatedSinceResize=!1,this.nodes.forEach(mf)))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&h&&(c||l)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:m,hasRelativeLayoutChanged:p,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||h.getDefaultTransition()||L1,{onLayoutAnimationStart:P,onLayoutAnimationComplete:C}=h.getProps(),S=!this.targetLayout||!fy(this.targetLayout,y),T=!m&&p;if(this.options.layoutRoot||this.resumeFrom||T||m&&(S||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const k={...Bl(x,"layout"),onPlay:P,onComplete:C};(h.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k),this.setAnimationOrigin(d,T)}else m||mf(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),pn(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(D1),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&my(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const m=this.path[d];m.shouldResetTransform=!0,m.updateScroll("snapshot"),m.options.layoutRoot&&m.willUpdate(!1)}const{layoutId:c,layout:l}=this.options;if(c===void 0&&!l)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(df);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(ff);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(C1),this.nodes.forEach(I1),this.nodes.forEach(A1)):this.nodes.forEach(ff),this.clearAllSnapshots();const c=Ze.now();Ve.delta=qt(0,1e3/60,c-Ve.timestamp),Ve.timestamp=c,Ve.isProcessing=!0,La.update.process(Ve),La.preRender.process(Ve),La.render.process(Ve),Ve.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Wl.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(P1),this.sharedNodes.forEach(j1)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,me.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){me.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Xe(this.snapshot.measuredBox.x)&&!Xe(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=xe(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c&&this.instance){const l=s(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!dy(this.projectionDelta),l=this.getTransformTemplate(),h=l?l(this.latestValues,""):void 0,d=h!==this.prevTransformTemplateValue;o&&this.instance&&(c||Dn(this.latestValues)||d)&&(r(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let l=this.removeElementScroll(c);return o&&(l=this.removeTransform(l)),O1(l),{animationId:this.root.animationId,measuredBox:c,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var h;const{visualElement:o}=this.options;if(!o)return xe();const c=o.measureViewportBox();if(!(((h=this.scroll)==null?void 0:h.wasRoot)||this.path.some(F1))){const{scroll:d}=this.root;d&&(ms(c.x,d.offset.x),ms(c.y,d.offset.y))}return c}removeElementScroll(o){var l;const c=xe();if(st(c,o),(l=this.scroll)!=null&&l.wasRoot)return c;for(let h=0;h<this.path.length;h++){const d=this.path[h],{scroll:m,options:p}=d;d!==this.root&&m&&p.layoutScroll&&(m.wasRoot&&st(c,o),ms(c.x,m.offset.x),ms(c.y,m.offset.y))}return c}applyTransform(o,c=!1){const l=xe();st(l,o);for(let h=0;h<this.path.length;h++){const d=this.path[h];!c&&d.options.layoutScroll&&d.scroll&&d!==d.root&&ps(l,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Dn(d.latestValues)&&ps(l,d.latestValues)}return Dn(this.latestValues)&&ps(l,this.latestValues),l}removeTransform(o){const c=xe();st(c,o);for(let l=0;l<this.path.length;l++){const h=this.path[l];if(!h.instance||!Dn(h.latestValues))continue;Dc(h.latestValues)&&h.updateSnapshot();const d=xe(),m=h.measurePageBox();st(d,m),of(c,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,d)}return Dn(this.latestValues)&&of(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ve.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var p;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==c;if(!(o||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(p=this.parent)!=null&&p.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:m}=this.options;if(!(!this.layout||!(d||m))){if(this.resolvedRelativeTargetAt=Ve.timestamp,!this.targetDelta&&!this.relativeTarget){const y=this.getClosestProjectingParent();y&&y.layout&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=xe(),this.relativeTargetOrigin=xe(),Ar(this.relativeTargetOrigin,this.layout.layoutBox,y.layout.layoutBox),st(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=xe(),this.targetWithTransforms=xe()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),zE(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):st(this.target,this.layout.layoutBox),Kg(this.target,this.targetDelta)):st(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const y=this.getClosestProjectingParent();y&&!!y.resumingFrom==!!this.resumingFrom&&!y.options.layoutScroll&&y.target&&this.animationProgress!==1?(this.relativeParent=y,this.forceRelativeParentToResolveTarget(),this.relativeTarget=xe(),this.relativeTargetOrigin=xe(),Ar(this.relativeTargetOrigin,this.target,y.target),st(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Dc(this.parent.latestValues)||Gg(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var x;const o=this.getLead(),c=!!this.resumingFrom||this!==o;let l=!0;if((this.isProjectionDirty||(x=this.parent)!=null&&x.isProjectionDirty)&&(l=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===Ve.timestamp&&(l=!1),l)return;const{layout:h,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||d))return;st(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,p=this.treeScale.y;nE(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=xe());const{target:y}=o;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(nf(this.prevProjectionDelta.x,this.projectionDelta.x),nf(this.prevProjectionDelta.y,this.projectionDelta.y)),Ir(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==p||!hf(this.projectionDelta.x,this.prevProjectionDelta.x)||!hf(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var c;if((c=this.options.visualElement)==null||c.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=gs(),this.projectionDelta=gs(),this.projectionDeltaWithTransform=gs()}setAnimationOrigin(o,c=!1){const l=this.snapshot,h=l?l.latestValues:{},d={...this.latestValues},m=gs();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const p=xe(),y=l?l.source:void 0,x=this.layout?this.layout.source:void 0,P=y!==x,C=this.getStack(),S=!C||C.members.length<=1,T=!!(P&&!S&&this.options.crossfade===!0&&!this.path.some(M1));this.animationProgress=0;let k;this.mixTargetDelta=L=>{const D=L/1e3;pf(m.x,o.x,D),pf(m.y,o.y,D),this.setTargetDelta(m),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ar(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),V1(this.relativeTarget,this.relativeTargetOrigin,p,D),k&&x1(this.relativeTarget,k)&&(this.isProjectionDirty=!1),k||(k=xe()),st(k,this.relativeTarget)),P&&(this.animationValues=d,m1(d,h,this.latestValues,D,T,S)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var c,l,h;this.notifyListeners("animationStart"),(c=this.currentAnimation)==null||c.stop(),(h=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||h.stop(),this.pendingAnimation&&(pn(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=me.update(()=>{Xi.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Is(0)),this.currentAnimation=l1(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:d=>{this.mixTargetDelta(d),o.onUpdate&&o.onUpdate(d)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(T1),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:l,layout:h,latestValues:d}=o;if(!(!c||!l||!h)){if(this!==o&&this.layout&&h&&gy(this.options.animationType,this.layout.layoutBox,h.layoutBox)){l=this.target||xe();const m=Xe(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+m;const p=Xe(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+p}st(c,l),ps(c,d),Ir(this.projectionDeltaWithTransform,this.layoutCorrected,c,d)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new v1),this.sharedNodes.get(o).add(c);const h=c.options.initialPromotionConfig;c.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var c;const{layoutId:o}=this.options;return o?((c=this.getStack())==null?void 0:c.lead)||this:this}getPrevLead(){var c;const{layoutId:o}=this.options;return o?(c=this.getStack())==null?void 0:c.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:l}={}){const h=this.getStack();h&&h.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(c=!0),!c)return;const h={};l.z&&Ka("z",o,h,this.animationValues);for(let d=0;d<Ga.length;d++)Ka(`rotate${Ga[d]}`,o,h,this.animationValues),Ka(`skew${Ga[d]}`,o,h,this.animationValues);o.render();for(const d in h)o.setStaticValue(d,h[d]),this.animationValues&&(this.animationValues[d]=h[d]);o.scheduleRender()}applyProjectionStyles(o,c){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Yi(c==null?void 0:c.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none";return}const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Yi(c==null?void 0:c.pointerEvents)||""),this.hasProjected&&!Dn(this.latestValues)&&(o.transform=l?l({},""):"none",this.hasProjected=!1);return}o.visibility="";const d=h.animationValues||h.latestValues;this.applyTransformsToTarget();let m=b1(this.projectionDeltaWithTransform,this.treeScale,d);l&&(m=l(d,m)),o.transform=m;const{x:p,y}=this.projectionDelta;o.transformOrigin=`${p.origin*100}% ${y.origin*100}% 0`,h.animationValues?o.opacity=h===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:o.opacity=h===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const x in Br){if(d[x]===void 0)continue;const{correct:P,applyTo:C,isCSSVariable:S}=Br[x],T=m==="none"?d[x]:P(d[x],h);if(C){const k=C.length;for(let L=0;L<k;L++)o[C[L]]=T}else S?this.options.visualElement.renderState.vars[x]=T:o[x]=T}this.options.layoutId&&(o.pointerEvents=h===this?Yi(c==null?void 0:c.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var c;return(c=o.currentAnimation)==null?void 0:c.stop()}),this.root.nodes.forEach(df),this.root.sharedNodes.clear()}}}function I1(t){t.updateLayout()}function A1(t){var n;const e=((n=t.resumeFrom)==null?void 0:n.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:r}=t.layout,{animationType:i}=t.options,o=e.source!==t.layout.source;i==="size"?rt(m=>{const p=o?e.measuredBox[m]:e.layoutBox[m],y=Xe(p);p.min=s[m].min,p.max=p.min+y}):gy(i,e.layoutBox,s)&&rt(m=>{const p=o?e.measuredBox[m]:e.layoutBox[m],y=Xe(s[m]);p.max=p.min+y,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[m].max=t.relativeTarget[m].min+y)});const c=gs();Ir(c,s,e.layoutBox);const l=gs();o?Ir(l,t.applyTransform(r,!0),e.measuredBox):Ir(l,s,e.layoutBox);const h=!dy(c);let d=!1;if(!t.resumeFrom){const m=t.getClosestProjectingParent();if(m&&!m.resumeFrom){const{snapshot:p,layout:y}=m;if(p&&y){const x=xe();Ar(x,e.layoutBox,p.layoutBox);const P=xe();Ar(P,s,y.layoutBox),fy(x,P)||(d=!0),m.options.layoutRoot&&(t.relativeTarget=P,t.relativeTargetOrigin=x,t.relativeParent=m)}}}t.notifyListeners("didUpdate",{layout:s,snapshot:e,delta:l,layoutDelta:c,hasLayoutChanged:h,hasRelativeLayoutChanged:d})}else if(t.isLead()){const{onExitComplete:s}=t.options;s&&s()}t.options.transition=void 0}function S1(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function N1(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function P1(t){t.clearSnapshot()}function df(t){t.clearMeasurements()}function ff(t){t.isLayoutDirty=!1}function C1(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function mf(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function R1(t){t.resolveTargetDelta()}function k1(t){t.calcProjection()}function D1(t){t.resetSkewAndRotation()}function j1(t){t.removeLeadSnapshot()}function pf(t,e,n){t.translate=ge(e.translate,0,n),t.scale=ge(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function gf(t,e,n,s){t.min=ge(e.min,n.min,s),t.max=ge(e.max,n.max,s)}function V1(t,e,n,s){gf(t.x,e.x,n.x,s),gf(t.y,e.y,n.y,s)}function M1(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const L1={duration:.45,ease:[.4,0,.1,1]},yf=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),_f=yf("applewebkit/")&&!yf("chrome/")?Math.round:ct;function wf(t){t.min=_f(t.min),t.max=_f(t.max)}function O1(t){wf(t.x),wf(t.y)}function gy(t,e,n){return t==="position"||t==="preserve-aspect"&&!WE(uf(e),uf(n),.2)}function F1(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const U1=py({attachResizeListener:(t,e)=>Wr(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Qa={current:void 0},yy=py({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Qa.current){const t=new U1({});t.mount(window),t.setOptions({layoutScroll:!0}),Qa.current=t}return Qa.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),$1={pan:{Feature:i1},drag:{Feature:r1,ProjectionNode:yy,MeasureLayout:ly}};function xf(t,e,n){const{props:s}=t;t.animationState&&s.whileHover&&t.animationState.setActive("whileHover",n==="Start");const r="onHover"+n,i=s[r];i&&me.postRender(()=>i(e,hi(e)))}class B1 extends En{mount(){const{current:e}=this.node;e&&(this.unmount=uT(e,(n,s)=>(xf(this.node,s,"Start"),r=>xf(this.node,r,"End"))))}unmount(){}}class q1 extends En{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=ci(Wr(this.node.current,"focus",()=>this.onFocus()),Wr(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function vf(t,e,n){const{props:s}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&s.whileTap&&t.animationState.setActive("whileTap",n==="Start");const r="onTap"+(n==="End"?"":n),i=s[r];i&&me.postRender(()=>i(e,hi(e)))}class W1 extends En{mount(){const{current:e}=this.node;e&&(this.unmount=mT(e,(n,s)=>(vf(this.node,s,"Start"),(r,{success:i})=>vf(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Uc=new WeakMap,Ya=new WeakMap,z1=t=>{const e=Uc.get(t.target);e&&e(t)},H1=t=>{t.forEach(z1)};function G1({root:t,...e}){const n=t||document;Ya.has(n)||Ya.set(n,{});const s=Ya.get(n),r=JSON.stringify(e);return s[r]||(s[r]=new IntersectionObserver(H1,{root:t,...e})),s[r]}function K1(t,e,n){const s=G1(e);return Uc.set(t,n),s.observe(t),()=>{Uc.delete(t),s.unobserve(t)}}const Q1={some:0,all:1};class Y1 extends En{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:s,amount:r="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:s,threshold:typeof r=="number"?r:Q1[r]},c=l=>{const{isIntersecting:h}=l;if(this.isInView===h||(this.isInView=h,i&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:d,onViewportLeave:m}=this.node.getProps(),p=h?d:m;p&&p(l)};return K1(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(X1(e,n))&&this.startObserver()}unmount(){}}function X1({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const J1={inView:{Feature:Y1},tap:{Feature:W1},focus:{Feature:q1},hover:{Feature:B1}},Z1={layout:{ProjectionNode:yy,MeasureLayout:ly}},eI={...OE,...J1,...$1,...Z1},oe=ZT(eI,dE);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),nI=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,s)=>s?s.toUpperCase():n.toLowerCase()),bf=t=>{const e=nI(t);return e.charAt(0).toUpperCase()+e.slice(1)},_y=(...t)=>t.filter((e,n,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===n).join(" ").trim(),sI=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=b.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:i,iconNode:o,...c},l)=>b.createElement("svg",{ref:l,...rI,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:_y("lucide",r),...!i&&!sI(c)&&{"aria-hidden":"true"},...c},[...o.map(([h,d])=>b.createElement(h,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=(t,e)=>{const n=b.forwardRef(({className:s,...r},i)=>b.createElement(iI,{ref:i,iconNode:e,className:_y(`lucide-${tI(bf(t))}`,`lucide-${t}`,s),...r}));return n.displayName=bf(t),n};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oI=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],ys=z("brain",oI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],$c=z("calendar",aI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]],lI=z("chart-no-axes-column",cI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uI=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],wy=z("check",uI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hI=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],dI=z("chevron-down",hI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fI=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],nu=z("chevron-right",fI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],zr=z("circle-alert",mI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pI=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],_s=z("circle-check-big",pI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Sr=z("circle-check",gI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]],Tf=z("circle-play",yI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _I=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ef=z("circle-x",_I);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wI=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Hr=z("circle",wI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xI=[["path",{d:"M21.66 17.67a1.08 1.08 0 0 1-.04 1.6A12 12 0 0 1 4.73 2.38a1.1 1.1 0 0 1 1.61-.04z",key:"4ite01"}],["path",{d:"M19.65 15.66A8 8 0 0 1 8.35 4.34",key:"1gxipu"}],["path",{d:"m14 10-5.5 5.5",key:"92pfem"}],["path",{d:"M14 17.85V10H6.15",key:"xqmtsk"}]],vI=z("citrus",xI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bI=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],If=z("clock",bI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Xa=z("database",TI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],II=z("eye",EI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AI=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Gr=z("file-text",AI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SI=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],Kr=z("git-branch",SI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NI=[["path",{d:"M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2",key:"1fvzgz"}],["path",{d:"M14 10V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2",key:"1kc0my"}],["path",{d:"M10 10.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8",key:"10h0bg"}],["path",{d:"M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15",key:"1s1gnw"}]],PI=z("hand",NI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CI=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],Af=z("hash",CI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RI=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]],xy=z("heart",RI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kI=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],DI=z("history",kI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jI=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],VI=z("house",jI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MI=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],LI=z("layers",MI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OI=[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]],Sf=z("list",OI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FI=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Qr=z("loader-circle",FI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UI=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],$I=z("log-out",UI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BI=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],qI=z("mail",BI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WI=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],zI=z("maximize",WI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HI=[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]],GI=z("message-circle",HI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KI=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],cn=z("message-square",KI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],YI=z("minimize",QI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XI=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],JI=z("package",XI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZI=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],eA=z("pen-line",ZI);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tA=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],nA=z("pen",tA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sA=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],go=z("plus",sA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rA=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],vy=z("refresh-cw",rA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iA=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Nf=z("save",iA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oA=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Bc=z("search",oA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aA=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],su=z("settings",aA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cA=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],by=z("shield",cA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lA=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],Ty=z("sparkles",lA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uA=[["path",{d:"M7 20h10",key:"e6iznv"}],["path",{d:"M10 20c5.5-2.5.8-6.4 3-10",key:"161w41"}],["path",{d:"M9.5 9.4c1.1.8 1.8 2.2 2.3 3.7-2 .4-3.5.4-4.8-.3-1.2-.6-2.3-1.9-3-4.2 2.8-.5 4.4 0 5.5.8z",key:"9gtqwd"}],["path",{d:"M14.1 6a7 7 0 0 0-1.1 4c1.9-.1 3.3-.6 4.3-1.4 1-1 1.6-2.3 1.7-4.6-2.7.1-4 1-4.9 2z",key:"bkxnd2"}]],hA=z("sprout",uA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dA=[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]],Ja=z("stethoscope",dA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fA=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],Ey=z("target",fA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mA=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],pA=z("timer",mA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gA=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],yA=z("toggle-left",gA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _A=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],wA=z("trash-2",_A);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xA=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],vA=z("trending-up",xA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bA=[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]],TA=z("type",bA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EA=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Pf=z("user-plus",EA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IA=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Nr=z("user",IA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AA=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Pr=z("users",AA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SA=[["path",{d:"M12.8 19.6A2 2 0 1 0 14 16H2",key:"148xed"}],["path",{d:"M17.5 8a2.5 2.5 0 1 1 2 4H2",key:"1u4tom"}],["path",{d:"M9.8 4.4A2 2 0 1 1 11 8H2",key:"75valh"}]],NA=z("wind",SA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PA=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Iy=z("x",PA);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CA=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],ru=z("zap",CA),RA="http://localhost:8083",be=t=>{const e=t.startsWith("/")?t:`/${t}`;return`${RA}${e}`},kA=()=>{};var Cf={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},DA=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],c=t[n++],l=((r&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536;e[s++]=String.fromCharCode(55296+(l>>10)),e[s++]=String.fromCharCode(56320+(l&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Sy={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,c=o?t[r+1]:0,l=r+2<t.length,h=l?t[r+2]:0,d=i>>2,m=(i&3)<<4|c>>4;let p=(c&15)<<2|h>>6,y=h&63;l||(y=64,o||(p=64)),s.push(n[d],n[m],n[p],n[y])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Ay(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):DA(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],c=r<t.length?n[t.charAt(r)]:0;++r;const h=r<t.length?n[t.charAt(r)]:64;++r;const m=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||c==null||h==null||m==null)throw new jA;const p=i<<2|c>>4;if(s.push(p),h!==64){const y=c<<4&240|h>>2;if(s.push(y),m!==64){const x=h<<6&192|m;s.push(x)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class jA extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const VA=function(t){const e=Ay(t);return Sy.encodeByteArray(e,!0)},yo=function(t){return VA(t).replace(/\./g,"")},Ny=function(t){try{return Sy.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LA=()=>MA().__FIREBASE_DEFAULTS__,OA=()=>{if(typeof process>"u"||typeof Cf>"u")return;const t=Cf.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},FA=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Ny(t[1]);return e&&JSON.parse(e)},zo=()=>{try{return kA()||LA()||OA()||FA()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Py=t=>{var e,n;return(n=(e=zo())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},UA=t=>{const e=Py(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]},Cy=()=>{var t;return(t=zo())==null?void 0:t.config},Ry=t=>{var e;return(e=zo())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bs(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function ky(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BA(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[yo(JSON.stringify(n)),yo(JSON.stringify(o)),""].join(".")}const Cr={};function qA(){const t={prod:[],emulator:[]};for(const e of Object.keys(Cr))Cr[e]?t.emulator.push(e):t.prod.push(e);return t}function WA(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Rf=!1;function Dy(t,e){if(typeof window>"u"||typeof document>"u"||!Bs(window.location.host)||Cr[t]===e||Cr[t]||Rf)return;Cr[t]=e;function n(p){return`__firebase__banner__${p}`}const s="__firebase__banner",i=qA().prod.length>0;function o(){const p=document.getElementById(s);p&&p.remove()}function c(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function l(p,y){p.setAttribute("width","24"),p.setAttribute("id",y),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function h(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{Rf=!0,o()},p}function d(p,y){p.setAttribute("id",y),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function m(){const p=WA(s),y=n("text"),x=document.getElementById(y)||document.createElement("span"),P=n("learnmore"),C=document.getElementById(P)||document.createElement("a"),S=n("preprendIcon"),T=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const k=p.element;c(k),d(C,P);const L=h();l(T,S),k.append(T,x,C,L),document.body.appendChild(k)}i?(x.innerText="Preview backend disconnected.",T.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(T.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,x.innerText="Preview backend running in this workspace."),x.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ge(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function zA(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ge())}function HA(){var e;const t=(e=zo())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function GA(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function iu(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function KA(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function QA(){const t=Ge();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function YA(){return!HA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ou(){try{return typeof indexedDB=="object"}catch{return!1}}function au(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var i;e(((i=r.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}function jy(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XA="FirebaseError";class vt extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=XA,Object.setPrototypeOf(this,vt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Kn.prototype.create)}}class Kn{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?JA(i,s):"Error",c=`${this.serviceName}: ${o} (${r}).`;return new vt(r,c,s)}}function JA(t,e){return t.replace(ZA,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const ZA=/\{\$([^}]+)}/g;function eS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function yn(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(kf(i)&&kf(o)){if(!yn(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function kf(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function di(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function yr(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[r,i]=s.split("=");e[decodeURIComponent(r)]=decodeURIComponent(i)}}),e}function _r(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function tS(t,e){const n=new nS(t,e);return n.subscribe.bind(n)}class nS{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let r;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");sS(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:s},r.next===void 0&&(r.next=Za),r.error===void 0&&(r.error=Za),r.complete===void 0&&(r.complete=Za);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function sS(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Za(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rS=1e3,iS=2,oS=4*60*60*1e3,aS=.5;function Df(t,e=rS,n=iS){const s=e*Math.pow(n,t),r=Math.round(aS*s*(Math.random()-.5)*2);return Math.min(oS,s+r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fe(t){return t&&t._delegate?t._delegate:t}class yt{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jn="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new $A;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(s)return null;throw r}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(uS(e))try{this.getOrInitializeService({instanceIdentifier:jn})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=jn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=jn){return this.instances.has(e)}getOptions(e=jn){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(i);s===c&&o.resolve(r)}return r}onInit(e,n){const s=this.normalizeInstanceIdentifier(n),r=this.onInitCallbacks.get(s)??new Set;r.add(e),this.onInitCallbacks.set(s,r);const i=this.instances.get(s);return i&&e(i,s),()=>{r.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:lS(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=jn){return this.component?this.component.multipleInstances?e:jn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function lS(t){return t===jn?void 0:t}function uS(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new cS(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ne;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ne||(ne={}));const dS={debug:ne.DEBUG,verbose:ne.VERBOSE,info:ne.INFO,warn:ne.WARN,error:ne.ERROR,silent:ne.SILENT},fS=ne.INFO,mS={[ne.DEBUG]:"log",[ne.VERBOSE]:"log",[ne.INFO]:"info",[ne.WARN]:"warn",[ne.ERROR]:"error"},pS=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=mS[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ho{constructor(e){this.name=e,this._logLevel=fS,this._logHandler=pS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ne))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?dS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ne.DEBUG,...e),this._logHandler(this,ne.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ne.VERBOSE,...e),this._logHandler(this,ne.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ne.INFO,...e),this._logHandler(this,ne.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ne.WARN,...e),this._logHandler(this,ne.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ne.ERROR,...e),this._logHandler(this,ne.ERROR,...e)}}const gS=(t,e)=>e.some(n=>t instanceof n);let jf,Vf;function yS(){return jf||(jf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _S(){return Vf||(Vf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Vy=new WeakMap,qc=new WeakMap,My=new WeakMap,ec=new WeakMap,cu=new WeakMap;function wS(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(ln(t.result)),r()},o=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Vy.set(n,t)}).catch(()=>{}),cu.set(e,t),e}function xS(t){if(qc.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),r()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});qc.set(t,e)}let Wc={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return qc.get(t);if(e==="objectStoreNames")return t.objectStoreNames||My.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ln(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function vS(t){Wc=t(Wc)}function bS(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(tc(this),e,...n);return My.set(s,e.sort?e.sort():[e]),ln(s)}:_S().includes(t)?function(...e){return t.apply(tc(this),e),ln(Vy.get(this))}:function(...e){return ln(t.apply(tc(this),e))}}function TS(t){return typeof t=="function"?bS(t):(t instanceof IDBTransaction&&xS(t),gS(t,yS())?new Proxy(t,Wc):t)}function ln(t){if(t instanceof IDBRequest)return wS(t);if(ec.has(t))return ec.get(t);const e=TS(t);return e!==t&&(ec.set(t,e),cu.set(e,t)),e}const tc=t=>cu.get(t);function Ly(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(t,e),c=ln(o);return s&&o.addEventListener("upgradeneeded",l=>{s(ln(o.result),l.oldVersion,l.newVersion,ln(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),c.then(l=>{i&&l.addEventListener("close",()=>i()),r&&l.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const ES=["get","getKey","getAll","getAllKeys","count"],IS=["put","add","delete","clear"],nc=new Map;function Mf(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(nc.get(e))return nc.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=IS.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||ES.includes(n)))return;const i=async function(o,...c){const l=this.transaction(o,r?"readwrite":"readonly");let h=l.store;return s&&(h=h.index(c.shift())),(await Promise.all([h[n](...c),r&&l.done]))[0]};return nc.set(e,i),i}vS(t=>({...t,get:(e,n,s)=>Mf(e,n)||t.get(e,n,s),has:(e,n)=>!!Mf(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(SS(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function SS(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const zc="@firebase/app",Lf="0.14.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zt=new Ho("@firebase/app"),NS="@firebase/app-compat",PS="@firebase/analytics-compat",CS="@firebase/analytics",RS="@firebase/app-check-compat",kS="@firebase/app-check",DS="@firebase/auth",jS="@firebase/auth-compat",VS="@firebase/database",MS="@firebase/data-connect",LS="@firebase/database-compat",OS="@firebase/functions",FS="@firebase/functions-compat",US="@firebase/installations",$S="@firebase/installations-compat",BS="@firebase/messaging",qS="@firebase/messaging-compat",WS="@firebase/performance",zS="@firebase/performance-compat",HS="@firebase/remote-config",GS="@firebase/remote-config-compat",KS="@firebase/storage",QS="@firebase/storage-compat",YS="@firebase/firestore",XS="@firebase/ai",JS="@firebase/firestore-compat",ZS="firebase",eN="12.3.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hc="[DEFAULT]",tN={[zc]:"fire-core",[NS]:"fire-core-compat",[CS]:"fire-analytics",[PS]:"fire-analytics-compat",[kS]:"fire-app-check",[RS]:"fire-app-check-compat",[DS]:"fire-auth",[jS]:"fire-auth-compat",[VS]:"fire-rtdb",[MS]:"fire-data-connect",[LS]:"fire-rtdb-compat",[OS]:"fire-fn",[FS]:"fire-fn-compat",[US]:"fire-iid",[$S]:"fire-iid-compat",[BS]:"fire-fcm",[qS]:"fire-fcm-compat",[WS]:"fire-perf",[zS]:"fire-perf-compat",[HS]:"fire-rc",[GS]:"fire-rc-compat",[KS]:"fire-gcs",[QS]:"fire-gcs-compat",[YS]:"fire-fst",[JS]:"fire-fst-compat",[XS]:"fire-vertex","fire-js":"fire-js",[ZS]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _o=new Map,nN=new Map,Gc=new Map;function Of(t,e){try{t.container.addComponent(e)}catch(n){zt.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function jt(t){const e=t.name;if(Gc.has(e))return zt.debug(`There were multiple attempts to register component ${e}.`),!1;Gc.set(e,t);for(const n of _o.values())Of(n,t);for(const n of nN.values())Of(n,t);return!0}function Qn(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function it(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sN={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},un=new Kn("app","Firebase",sN);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rN{constructor(e,n,s){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new yt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw un.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qs=eN;function Oy(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s={name:Hc,automaticDataCollectionEnabled:!0,...e},r=s.name;if(typeof r!="string"||!r)throw un.create("bad-app-name",{appName:String(r)});if(n||(n=Cy()),!n)throw un.create("no-options");const i=_o.get(r);if(i){if(yn(n,i.options)&&yn(s,i.config))return i;throw un.create("duplicate-app",{appName:r})}const o=new hS(r);for(const l of Gc.values())o.addComponent(l);const c=new rN(n,s,o);return _o.set(r,c),c}function lu(t=Hc){const e=_o.get(t);if(!e&&t===Hc&&Cy())return Oy();if(!e)throw un.create("no-app",{appName:t});return e}function lt(t,e,n){let s=tN[t]??t;n&&(s+=`-${n}`);const r=s.match(/\s|\//),i=e.match(/\s|\//);if(r||i){const o=[`Unable to register library "${s}" with version "${e}":`];r&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),zt.warn(o.join(" "));return}jt(new yt(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iN="firebase-heartbeat-database",oN=1,Yr="firebase-heartbeat-store";let sc=null;function Fy(){return sc||(sc=Ly(iN,oN,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Yr)}catch(n){console.warn(n)}}}}).catch(t=>{throw un.create("idb-open",{originalErrorMessage:t.message})})),sc}async function aN(t){try{const n=(await Fy()).transaction(Yr),s=await n.objectStore(Yr).get(Uy(t));return await n.done,s}catch(e){if(e instanceof vt)zt.warn(e.message);else{const n=un.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});zt.warn(n.message)}}}async function Ff(t,e){try{const s=(await Fy()).transaction(Yr,"readwrite");await s.objectStore(Yr).put(e,Uy(t)),await s.done}catch(n){if(n instanceof vt)zt.warn(n.message);else{const s=un.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});zt.warn(s.message)}}}function Uy(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cN=1024,lN=30;class uN{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new dN(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Uf();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats.length>lN){const o=fN(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(s){zt.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Uf(),{heartbeatsToSend:s,unsentEntries:r}=hN(this._heartbeatsCache.heartbeats),i=yo(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return zt.warn(n),""}}}function Uf(){return new Date().toISOString().substring(0,10)}function hN(t,e=cN){const n=[];let s=t.slice();for(const r of t){const i=n.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),$f(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),$f(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class dN{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ou()?au().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await aN(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Ff(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const s=await this.read();return Ff(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function $f(t){return yo(JSON.stringify({version:2,heartbeats:t})).length}function fN(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let s=1;s<t.length;s++)t[s].date<n&&(n=t[s].date,e=s);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mN(t){jt(new yt("platform-logger",e=>new AS(e),"PRIVATE")),jt(new yt("heartbeat",e=>new uN(e),"PRIVATE")),lt(zc,Lf,t),lt(zc,Lf,"esm2020"),lt("fire-js","")}mN("");var pN="firebase",gN="12.3.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lt(pN,gN,"app");function $y(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const yN=$y,By=new Kn("auth","Firebase",$y());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wo=new Ho("@firebase/auth");function _N(t,...e){wo.logLevel<=ne.WARN&&wo.warn(`Auth (${qs}): ${t}`,...e)}function Ji(t,...e){wo.logLevel<=ne.ERROR&&wo.error(`Auth (${qs}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ut(t,...e){throw hu(t,...e)}function pt(t,...e){return hu(t,...e)}function uu(t,e,n){const s={...yN(),[e]:n};return new Kn("auth","Firebase",s).create(e,{appName:t.name})}function hn(t){return uu(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function wN(t,e,n){const s=n;if(!(e instanceof s))throw s.name!==e.constructor.name&&ut(t,"argument-error"),uu(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function hu(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return By.create(t,...e)}function G(t,e,...n){if(!t)throw hu(e,...n)}function Ft(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Ji(e),new Error(e)}function Ht(t,e){t||Ft(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kc(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function xN(){return Bf()==="http:"||Bf()==="https:"}function Bf(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(xN()||iu()||"connection"in navigator)?navigator.onLine:!0}function bN(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ht(n>e,"Short delay should be less than long delay!"),this.isMobile=zA()||KA()}get(){return vN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function du(t,e){Ht(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qy{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ft("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ft("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ft("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],IN=new fi(3e4,6e4);function Yn(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function In(t,e,n,s,r={}){return Wy(t,r,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const c=di({key:t.config.apiKey,...o}).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const h={method:e,headers:l,...i};return GA()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&Bs(t.emulatorConfig.host)&&(h.credentials="include"),qy.fetch()(await zy(t,t.config.apiHost,n,c),h)})}async function Wy(t,e,n){t._canInitEmulator=!1;const s={...TN,...e};try{const r=new SN(t),i=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Fi(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const c=i.ok?o.errorMessage:o.error.message,[l,h]=c.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Fi(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Fi(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Fi(t,"user-disabled",o);const d=s[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw uu(t,d,h);ut(t,d)}}catch(r){if(r instanceof vt)throw r;ut(t,"network-request-failed",{message:String(r)})}}async function Go(t,e,n,s,r={}){const i=await In(t,e,n,s,r);return"mfaPendingCredential"in i&&ut(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function zy(t,e,n,s){const r=`${e}${n}?${s}`,i=t,o=i.config.emulator?du(t.config,r):`${t.config.apiScheme}://${r}`;return EN.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function AN(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class SN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(pt(this.auth,"network-request-failed")),IN.get())})}}function Fi(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=pt(t,e,s);return r.customData._tokenResponse=n,r}function qf(t){return t!==void 0&&t.enterprise!==void 0}class NN{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return AN(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function PN(t,e){return In(t,"GET","/v2/recaptchaConfig",Yn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CN(t,e){return In(t,"POST","/v1/accounts:delete",e)}async function xo(t,e){return In(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rr(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function RN(t,e=!1){const n=Fe(t),s=await n.getIdToken(e),r=fu(s);G(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:r,token:s,authTime:Rr(rc(r.auth_time)),issuedAtTime:Rr(rc(r.iat)),expirationTime:Rr(rc(r.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function rc(t){return Number(t)*1e3}function fu(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return Ji("JWT malformed, contained fewer than 3 sections"),null;try{const r=Ny(n);return r?JSON.parse(r):(Ji("Failed to decode base64 JWT payload"),null)}catch(r){return Ji("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function Wf(t){const e=fu(t);return G(e,"internal-error"),G(typeof e.exp<"u","internal-error"),G(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xr(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof vt&&kN(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function kN({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qc{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Rr(this.lastLoginAt),this.creationTime=Rr(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vo(t){var m;const e=t.auth,n=await t.getIdToken(),s=await Xr(t,xo(e,{idToken:n}));G(s==null?void 0:s.users.length,e,"internal-error");const r=s.users[0];t._notifyReloadListener(r);const i=(m=r.providerUserInfo)!=null&&m.length?Hy(r.providerUserInfo):[],o=VN(t.providerData,i),c=t.isAnonymous,l=!(t.email&&r.passwordHash)&&!(o!=null&&o.length),h=c?l:!1,d={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:o,metadata:new Qc(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(t,d)}async function jN(t){const e=Fe(t);await vo(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function VN(t,e){return[...t.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function Hy(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MN(t,e){const n=await Wy(t,{},async()=>{const s=di({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=t.config,o=await zy(t,r,"/v1/token",`key=${i}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:c,body:s};return t.emulatorConfig&&Bs(t.emulatorConfig.host)&&(l.credentials="include"),qy.fetch()(o,l)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function LN(t,e){return In(t,"POST","/v2/accounts:revokeToken",Yn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){G(e.idToken,"internal-error"),G(typeof e.idToken<"u","internal-error"),G(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Wf(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){G(e.length!==0,"internal-error");const n=Wf(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(G(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:r,expiresIn:i}=await MN(e,n);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:r,expirationTime:i}=n,o=new ws;return s&&(G(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),r&&(G(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&(G(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ws,this.toJSON())}_performRefresh(){return Ft("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tn(t,e){G(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ft{constructor({uid:e,auth:n,stsTokenManager:s,...r}){this.providerId="firebase",this.proactiveRefresh=new DN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Qc(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const n=await Xr(this,this.stsTokenManager.getToken(this.auth,e));return G(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return RN(this,e)}reload(){return jN(this)}_assign(e){this!==e&&(G(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ft({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){G(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await vo(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(it(this.auth.app))return Promise.reject(hn(this.auth));const e=await this.getIdToken();return await Xr(this,CN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const s=n.displayName??void 0,r=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,c=n.tenantId??void 0,l=n._redirectEventId??void 0,h=n.createdAt??void 0,d=n.lastLoginAt??void 0,{uid:m,emailVerified:p,isAnonymous:y,providerData:x,stsTokenManager:P}=n;G(m&&P,e,"internal-error");const C=ws.fromJSON(this.name,P);G(typeof m=="string",e,"internal-error"),tn(s,e.name),tn(r,e.name),G(typeof p=="boolean",e,"internal-error"),G(typeof y=="boolean",e,"internal-error"),tn(i,e.name),tn(o,e.name),tn(c,e.name),tn(l,e.name),tn(h,e.name),tn(d,e.name);const S=new ft({uid:m,auth:e,email:r,emailVerified:p,displayName:s,isAnonymous:y,photoURL:o,phoneNumber:i,tenantId:c,stsTokenManager:C,createdAt:h,lastLoginAt:d});return x&&Array.isArray(x)&&(S.providerData=x.map(T=>({...T}))),l&&(S._redirectEventId=l),S}static async _fromIdTokenResponse(e,n,s=!1){const r=new ws;r.updateFromServerResponse(n);const i=new ft({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await vo(i),i}static async _fromGetAccountInfoResponse(e,n,s){const r=n.users[0];G(r.localId!==void 0,"internal-error");const i=r.providerUserInfo!==void 0?Hy(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(i!=null&&i.length),c=new ws;c.updateFromIdToken(s);const l=new ft({uid:r.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new Qc(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,h),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zf=new Map;function Ut(t){Ht(t instanceof Function,"Expected a class definition");let e=zf.get(t);return e?(Ht(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,zf.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Gy.type="NONE";const Hf=Gy;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zi(t,e,n){return`firebase:${t}:${e}:${n}`}class xs{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=Zi(this.userKey,r.apiKey,i),this.fullPersistenceKey=Zi("persistence",r.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await xo(this.auth,{idToken:e}).catch(()=>{});return n?ft._fromGetAccountInfoResponse(this.auth,n,e):null}return ft._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new xs(Ut(Hf),e,s);const r=(await Promise.all(n.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let i=r[0]||Ut(Hf);const o=Zi(s,e.config.apiKey,e.name);let c=null;for(const h of n)try{const d=await h._get(o);if(d){let m;if(typeof d=="string"){const p=await xo(e,{idToken:d}).catch(()=>{});if(!p)break;m=await ft._fromGetAccountInfoResponse(e,p,d)}else m=ft._fromJSON(e,d);h!==i&&(c=m),i=h;break}}catch{}const l=r.filter(h=>h._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new xs(i,e,s):(i=l[0],c&&await i._set(o,c.toJSON()),await Promise.all(n.map(async h=>{if(h!==i)try{await h._remove(o)}catch{}})),new xs(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gf(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Xy(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Ky(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Zy(e))return"Blackberry";if(e0(e))return"Webos";if(Qy(e))return"Safari";if((e.includes("chrome/")||Yy(e))&&!e.includes("edge/"))return"Chrome";if(Jy(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function Ky(t=Ge()){return/firefox\//i.test(t)}function Qy(t=Ge()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Yy(t=Ge()){return/crios\//i.test(t)}function Xy(t=Ge()){return/iemobile/i.test(t)}function Jy(t=Ge()){return/android/i.test(t)}function Zy(t=Ge()){return/blackberry/i.test(t)}function e0(t=Ge()){return/webos/i.test(t)}function mu(t=Ge()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function ON(t=Ge()){var e;return mu(t)&&!!((e=window.navigator)!=null&&e.standalone)}function FN(){return QA()&&document.documentMode===10}function t0(t=Ge()){return mu(t)||Jy(t)||e0(t)||Zy(t)||/windows phone/i.test(t)||Xy(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n0(t,e=[]){let n;switch(t){case"Browser":n=Gf(Ge());break;case"Worker":n=`${Gf(Ge())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${qs}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=i=>new Promise((o,c)=>{try{const l=e(i);o(l)}catch(l){c(l)}});s.onAbort=n,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $N(t,e={}){return In(t,"GET","/v2/passwordPolicy",Yn(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BN=6;class qN{constructor(e){var s;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??BN,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((s=e.allowedNonAlphanumericCharacters)==null?void 0:s.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),r&&(n.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(e,n,s,r){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Kf(this),this.idTokenSubscription=new Kf(this),this.beforeStateQueue=new UN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=By,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Ut(n)),this._initializationPromise=this.queue(async()=>{var s,r,i;if(!this._deleted&&(this.persistenceManager=await xs.create(this,e),(s=this._resolvePersistenceManagerAvailable)==null||s.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await xo(this,{idToken:e}),s=await ft._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(it(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,c=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===c)&&(l!=null&&l.user)&&(s=l.user,r=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return G(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await vo(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=bN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(it(this.app))return Promise.reject(hn(this));const n=e?Fe(e):null;return n&&G(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&G(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return it(this.app)?Promise.reject(hn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return it(this.app)?Promise.reject(hn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ut(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await $N(this),n=new qN(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Kn("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await LN(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Ut(e)||this._popupRedirectResolver;G(n,this,"argument-error"),this.redirectPersistenceManager=await xs.create(this,[Ut(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)==null?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,r){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(G(c,this,"internal-error"),c.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,s,r);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return G(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=n0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(e["X-Firebase-AppCheck"]=s),e}async _getAppCheckToken(){var n;if(it(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&_N(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Xn(t){return Fe(t)}class Kf{constructor(e){this.auth=e,this.observer=null,this.addObserver=tS(n=>this.observer=n)}get next(){return G(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ko={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function zN(t){Ko=t}function s0(t){return Ko.loadJS(t)}function HN(){return Ko.recaptchaEnterpriseScript}function GN(){return Ko.gapiScript}function KN(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class QN{constructor(){this.enterprise=new YN}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class YN{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const XN="recaptcha-enterprise",r0="NO_RECAPTCHA";class JN{constructor(e){this.type=XN,this.auth=Xn(e)}async verify(e="verify",n=!1){async function s(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,c)=>{PN(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const h=new NN(l);return i.tenantId==null?i._agentRecaptchaConfig=h:i._tenantRecaptchaConfigs[i.tenantId]=h,o(h.siteKey)}}).catch(l=>{c(l)})})}function r(i,o,c){const l=window.grecaptcha;qf(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(h=>{o(h)}).catch(()=>{o(r0)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new QN().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{s(this.auth).then(c=>{if(!n&&qf(window.grecaptcha))r(c,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=HN();l.length!==0&&(l+=c),s0(l).then(()=>{r(c,i,o)}).catch(h=>{o(h)})}}).catch(c=>{o(c)})})}}async function Qf(t,e,n,s=!1,r=!1){const i=new JN(t);let o;if(r)o=r0;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const c={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const l=c.phoneEnrollmentInfo.phoneNumber,h=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:l,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const l=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:l,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return s?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Yf(t,e,n,s,r){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await Qf(t,e,n,n==="getOobCode");return s(t,o)}else return s(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await Qf(t,e,n,n==="getOobCode");return s(t,c)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZN(t,e){const n=Qn(t,"auth");if(n.isInitialized()){const r=n.getImmediate(),i=n.getOptions();if(yn(i,e??{}))return r;ut(r,"already-initialized")}return n.initialize({options:e})}function eP(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(Ut);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function tP(t,e,n){const s=Xn(t);G(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,i=i0(e),{host:o,port:c}=nP(e),l=c===null?"":`:${c}`,h={url:`${i}//${o}${l}/`},d=Object.freeze({host:o,port:c,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!s._canInitEmulator){G(s.config.emulator&&s.emulatorConfig,s,"emulator-config-failed"),G(yn(h,s.config.emulator)&&yn(d,s.emulatorConfig),s,"emulator-config-failed");return}s.config.emulator=h,s.emulatorConfig=d,s.settings.appVerificationDisabledForTesting=!0,Bs(o)?(ky(`${i}//${o}${l}`),Dy("Auth",!0)):sP()}function i0(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function nP(t){const e=i0(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:Xf(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:Xf(o)}}}function Xf(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function sP(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ft("not implemented")}_getIdTokenResponse(e){return Ft("not implemented")}_linkToIdToken(e,n){return Ft("not implemented")}_getReauthenticationResolver(e){return Ft("not implemented")}}async function rP(t,e){return In(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iP(t,e){return Go(t,"POST","/v1/accounts:signInWithPassword",Yn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oP(t,e){return Go(t,"POST","/v1/accounts:signInWithEmailLink",Yn(t,e))}async function aP(t,e){return Go(t,"POST","/v1/accounts:signInWithEmailLink",Yn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr extends pu{constructor(e,n,s,r=null){super("password",s),this._email=e,this._password=n,this._tenantId=r}static _fromEmailAndPassword(e,n){return new Jr(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new Jr(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Yf(e,n,"signInWithPassword",iP);case"emailLink":return oP(e,{email:this._email,oobCode:this._password});default:ut(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const s={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Yf(e,s,"signUpPassword",rP);case"emailLink":return aP(e,{idToken:n,email:this._email,oobCode:this._password});default:ut(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vs(t,e){return Go(t,"POST","/v1/accounts:signInWithIdp",Yn(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cP="http://localhost";class qn extends pu{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new qn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ut("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r,...i}=n;if(!s||!r)return null;const o=new qn(s,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return vs(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,vs(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,vs(e,n)}buildRequest(){const e={requestUri:cP,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=di(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lP(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function uP(t){const e=yr(_r(t)).link,n=e?yr(_r(e)).deep_link_id:null,s=yr(_r(t)).deep_link_id;return(s?yr(_r(s)).link:null)||s||n||e||t}class gu{constructor(e){const n=yr(_r(e)),s=n.apiKey??null,r=n.oobCode??null,i=lP(n.mode??null);G(s&&r&&i,"argument-error"),this.apiKey=s,this.operation=i,this.code=r,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=uP(e);try{return new gu(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(){this.providerId=Ws.PROVIDER_ID}static credential(e,n){return Jr._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=gu.parseLink(n);return G(s,"argument-error"),Jr._fromEmailAndCode(e,s.code,s.tenantId)}}Ws.PROVIDER_ID="password";Ws.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ws.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends yu{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn extends mi{constructor(){super("facebook.com")}static credential(e){return qn._fromParams({providerId:sn.PROVIDER_ID,signInMethod:sn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return sn.credentialFromTaggedObject(e)}static credentialFromError(e){return sn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return sn.credential(e.oauthAccessToken)}catch{return null}}}sn.FACEBOOK_SIGN_IN_METHOD="facebook.com";sn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot extends mi{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return qn._fromParams({providerId:Ot.PROVIDER_ID,signInMethod:Ot.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ot.credentialFromTaggedObject(e)}static credentialFromError(e){return Ot.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return Ot.credential(n,s)}catch{return null}}}Ot.GOOGLE_SIGN_IN_METHOD="google.com";Ot.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn extends mi{constructor(){super("github.com")}static credential(e){return qn._fromParams({providerId:rn.PROVIDER_ID,signInMethod:rn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return rn.credentialFromTaggedObject(e)}static credentialFromError(e){return rn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return rn.credential(e.oauthAccessToken)}catch{return null}}}rn.GITHUB_SIGN_IN_METHOD="github.com";rn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on extends mi{constructor(){super("twitter.com")}static credential(e,n){return qn._fromParams({providerId:on.PROVIDER_ID,signInMethod:on.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return on.credentialFromTaggedObject(e)}static credentialFromError(e){return on.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return on.credential(n,s)}catch{return null}}}on.TWITTER_SIGN_IN_METHOD="twitter.com";on.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,r=!1){const i=await ft._fromIdTokenResponse(e,s,r),o=Jf(s);return new Ss({user:i,providerId:o,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const r=Jf(s);return new Ss({user:e,providerId:r,_tokenResponse:s,operationType:n})}}function Jf(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo extends vt{constructor(e,n,s,r){super(n.code,n.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,bo.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,r){return new bo(e,n,s,r)}}function o0(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?bo._fromErrorAndOperation(t,i,e,s):i})}async function hP(t,e,n=!1){const s=await Xr(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ss._forOperation(t,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dP(t,e,n=!1){const{auth:s}=t;if(it(s.app))return Promise.reject(hn(s));const r="reauthenticate";try{const i=await Xr(t,o0(s,r,e,t),n);G(i.idToken,s,"internal-error");const o=fu(i.idToken);G(o,s,"internal-error");const{sub:c}=o;return G(t.uid===c,s,"user-mismatch"),Ss._forOperation(t,r,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&ut(s,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a0(t,e,n=!1){if(it(t.app))return Promise.reject(hn(t));const s="signIn",r=await o0(t,s,e),i=await Ss._fromIdTokenResponse(t,s,r);return n||await t._updateCurrentUser(i.user),i}async function fP(t,e){return a0(Xn(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mP(t){const e=Xn(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function pP(t,e,n){return it(t.app)?Promise.reject(hn(t)):fP(Fe(t),Ws.credential(e,n)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&mP(t),s})}function gP(t,e,n,s){return Fe(t).onIdTokenChanged(e,n,s)}function yP(t,e,n){return Fe(t).beforeAuthStateChanged(e,n)}function _P(t,e,n,s){return Fe(t).onAuthStateChanged(e,n,s)}function Zf(t){return Fe(t).signOut()}const To="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c0{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(To,"1"),this.storage.removeItem(To),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wP=1e3,xP=10;class l0 extends c0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=t0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),r=this.localCache[n];s!==r&&e(n,r,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,c,l)=>{this.notifyListeners(o,l)});return}const s=e.key;n?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(s);!n&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);FN()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,xP):r()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},wP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}l0.type="LOCAL";const vP=l0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0 extends c0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}u0.type="SESSION";const h0=u0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bP(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qo{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const s=new Qo(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:r,data:i}=n.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const c=Array.from(o).map(async h=>h(n.origin,i)),l=await bP(c);n.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qo.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _u(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((c,l)=>{const h=_u("",20);r.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},s);o={messageChannel:r,onMessage(m){const p=m;if(p.data.eventId===h)switch(p.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),c(p.data.response);break;default:clearTimeout(d),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nt(){return window}function EP(t){Nt().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d0(){return typeof Nt().WorkerGlobalScope<"u"&&typeof Nt().importScripts=="function"}async function IP(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function AP(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function SP(){return d0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f0="firebaseLocalStorageDb",NP=1,Eo="firebaseLocalStorage",m0="fbase_key";class pi{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Yo(t,e){return t.transaction([Eo],e?"readwrite":"readonly").objectStore(Eo)}function PP(){const t=indexedDB.deleteDatabase(f0);return new pi(t).toPromise()}function Yc(){const t=indexedDB.open(f0,NP);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(Eo,{keyPath:m0})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(Eo)?e(s):(s.close(),await PP(),e(await Yc()))})})}async function em(t,e,n){const s=Yo(t,!0).put({[m0]:e,value:n});return new pi(s).toPromise()}async function CP(t,e){const n=Yo(t,!1).get(e),s=await new pi(n).toPromise();return s===void 0?null:s.value}function tm(t,e){const n=Yo(t,!0).delete(e);return new pi(n).toPromise()}const RP=800,kP=3;class p0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Yc(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>kP)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return d0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qo._getInstance(SP()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,s;if(this.activeServiceWorker=await IP(),!this.activeServiceWorker)return;this.sender=new TP(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(s=e[0])!=null&&s.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||AP()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Yc();return await em(e,To,"1"),await tm(e,To),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>em(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>CP(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>tm(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=Yo(r,!1).getAll();return new pi(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),RP)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}p0.type="LOCAL";const DP=p0;new fi(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(t,e){return e?Ut(e):(G(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu extends pu{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return vs(e,this._buildIdpRequest())}_linkToIdToken(e,n){return vs(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return vs(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function jP(t){return a0(t.auth,new wu(t),t.bypassAuthState)}function VP(t){const{auth:e,user:n}=t;return G(n,e,"internal-error"),dP(n,new wu(t),t.bypassAuthState)}async function MP(t){const{auth:e,user:n}=t;return G(n,e,"internal-error"),hP(n,new wu(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y0{constructor(e,n,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:r,tenantId:i,error:o,type:c}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(l))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return jP;case"linkViaPopup":case"linkViaRedirect":return MP;case"reauthViaPopup":case"reauthViaRedirect":return VP;default:ut(this.auth,"internal-error")}}resolve(e){Ht(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ht(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LP=new fi(2e3,1e4);async function OP(t,e,n){if(it(t.app))return Promise.reject(pt(t,"operation-not-supported-in-this-environment"));const s=Xn(t);wN(t,e,yu);const r=g0(s,n);return new On(s,"signInViaPopup",e,r).executeNotNull()}class On extends y0{constructor(e,n,s,r,i){super(e,n,r,i),this.provider=s,this.authWindow=null,this.pollId=null,On.currentPopupAction&&On.currentPopupAction.cancel(),On.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return G(e,this.auth,"internal-error"),e}async onExecution(){Ht(this.filter.length===1,"Popup operations only handle one event");const e=_u();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(pt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(pt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,On.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if((s=(n=this.authWindow)==null?void 0:n.window)!=null&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(pt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,LP.get())};e()}}On.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FP="pendingRedirect",eo=new Map;class UP extends y0{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=eo.get(this.auth._key());if(!e){try{const s=await $P(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}eo.set(this.auth._key(),e)}return this.bypassAuthState||eo.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function $P(t,e){const n=WP(e),s=qP(t);if(!await s._isAvailable())return!1;const r=await s._get(n)==="true";return await s._remove(n),r}function BP(t,e){eo.set(t._key(),e)}function qP(t){return Ut(t._redirectPersistence)}function WP(t){return Zi(FP,t.config.apiKey,t.name)}async function zP(t,e,n=!1){if(it(t.app))return Promise.reject(hn(t));const s=Xn(t),r=g0(s,e),o=await new UP(s,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HP=10*60*1e3;class GP{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!KP(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!_0(e)){const r=((s=e.error.code)==null?void 0:s.split("auth/")[1])||"internal-error";n.onError(pt(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=HP&&this.cachedEventUids.clear(),this.cachedEventUids.has(nm(e))}saveEventToCache(e){this.cachedEventUids.add(nm(e)),this.lastProcessedEventTime=Date.now()}}function nm(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function _0({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function KP(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return _0(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QP(t,e={}){return In(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YP=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,XP=/^https?/;async function JP(t){if(t.config.emulator)return;const{authorizedDomains:e}=await QP(t);for(const n of e)try{if(ZP(n))return}catch{}ut(t,"unauthorized-domain")}function ZP(t){const e=Kc(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===s}if(!XP.test(n))return!1;if(YP.test(t))return s===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e2=new fi(3e4,6e4);function sm(){const t=Nt().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function t2(t){return new Promise((e,n)=>{var r,i,o;function s(){sm(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{sm(),n(pt(t,"network-request-failed"))},timeout:e2.get()})}if((i=(r=Nt().gapi)==null?void 0:r.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Nt().gapi)!=null&&o.load)s();else{const c=KN("iframefcb");return Nt()[c]=()=>{gapi.load?s():n(pt(t,"network-request-failed"))},s0(`${GN()}?onload=${c}`).catch(l=>n(l))}}).catch(e=>{throw to=null,e})}let to=null;function n2(t){return to=to||t2(t),to}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2=new fi(5e3,15e3),r2="__/auth/iframe",i2="emulator/auth/iframe",o2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},a2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function c2(t){const e=t.config;G(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?du(e,i2):`https://${t.config.authDomain}/${r2}`,s={apiKey:e.apiKey,appName:t.name,v:qs},r=a2.get(t.config.apiHost);r&&(s.eid=r);const i=t._getFrameworks();return i.length&&(s.fw=i.join(",")),`${n}?${di(s).slice(1)}`}async function l2(t){const e=await n2(t),n=Nt().gapi;return G(n,t,"internal-error"),e.open({where:document.body,url:c2(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:o2,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const o=pt(t,"network-request-failed"),c=Nt().setTimeout(()=>{i(o)},s2.get());function l(){Nt().clearTimeout(c),r(s)}s.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},h2=500,d2=600,f2="_blank",m2="http://localhost";class rm{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function p2(t,e,n,s=h2,r=d2){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let c="";const l={...u2,width:s.toString(),height:r.toString(),top:i,left:o},h=Ge().toLowerCase();n&&(c=Yy(h)?f2:n),Ky(h)&&(e=e||m2,l.scrollbars="yes");const d=Object.entries(l).reduce((p,[y,x])=>`${p}${y}=${x},`,"");if(ON(h)&&c!=="_self")return g2(e||"",c),new rm(null);const m=window.open(e||"",c,d);G(m,t,"popup-blocked");try{m.focus()}catch{}return new rm(m)}function g2(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y2="__/auth/handler",_2="emulator/auth/handler",w2=encodeURIComponent("fac");async function im(t,e,n,s,r,i){G(t.config.authDomain,t,"auth-domain-config-required"),G(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:qs,eventId:r};if(e instanceof yu){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",eS(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,m]of Object.entries({}))o[d]=m}if(e instanceof mi){const d=e.getScopes().filter(m=>m!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const d of Object.keys(c))c[d]===void 0&&delete c[d];const l=await t._getAppCheckToken(),h=l?`#${w2}=${encodeURIComponent(l)}`:"";return`${x2(t)}?${di(c).slice(1)}${h}`}function x2({config:t}){return t.emulator?du(t,_2):`https://${t.authDomain}/${y2}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ic="webStorageSupport";class v2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=h0,this._completeRedirectFn=zP,this._overrideRedirectResult=BP}async _openPopup(e,n,s,r){var o;Ht((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await im(e,n,s,Kc(),r);return p2(e,i,_u())}async _openRedirect(e,n,s,r){await this._originValidation(e);const i=await im(e,n,s,Kc(),r);return EP(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:i}=this.eventManagers[n];return r?Promise.resolve(r):(Ht(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await l2(e),s=new GP(e);return n.register("authEvent",r=>(G(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(ic,{type:ic},r=>{var o;const i=(o=r==null?void 0:r[0])==null?void 0:o[ic];i!==void 0&&n(!!i),ut(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=JP(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return t0()||Qy()||mu()}}const b2=v2;var om="@firebase/auth",am="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){G(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function I2(t){jt(new yt("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=s.options;G(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const l={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:n0(t)},h=new WN(s,r,i,l);return eP(h,n),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),jt(new yt("auth-internal",e=>{const n=Xn(e.getProvider("auth").getImmediate());return(s=>new T2(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),lt(om,am,E2(t)),lt(om,am,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A2=5*60,S2=Ry("authIdTokenMaxAge")||A2;let cm=null;const N2=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>S2)return;const r=n==null?void 0:n.token;cm!==r&&(cm=r,await fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function P2(t=lu()){const e=Qn(t,"auth");if(e.isInitialized())return e.getImmediate();const n=ZN(t,{popupRedirectResolver:b2,persistence:[DP,vP,h0]}),s=Ry("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(s,location.origin);if(location.origin===i.origin){const o=N2(i.toString());yP(n,o,()=>o(n.currentUser)),gP(n,c=>o(c))}}const r=Py("auth");return r&&tP(n,`http://${r}`),n}function C2(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}zN({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=r=>{const i=pt("internal-error");i.customData=r,n(i)},s.type="text/javascript",s.charset="UTF-8",C2().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});I2("Browser");var lm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var dn,w0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,v){function I(){}I.prototype=v.prototype,E.F=v.prototype,E.prototype=new I,E.prototype.constructor=E,E.D=function(N,A,R){for(var _=Array(arguments.length-2),B=2;B<arguments.length;B++)_[B-2]=arguments[B];return v.prototype[A].apply(N,_)}}function n(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(s,n),s.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(E,v,I){I||(I=0);const N=Array(16);if(typeof v=="string")for(var A=0;A<16;++A)N[A]=v.charCodeAt(I++)|v.charCodeAt(I++)<<8|v.charCodeAt(I++)<<16|v.charCodeAt(I++)<<24;else for(A=0;A<16;++A)N[A]=v[I++]|v[I++]<<8|v[I++]<<16|v[I++]<<24;v=E.g[0],I=E.g[1],A=E.g[2];let R=E.g[3],_;_=v+(R^I&(A^R))+N[0]+3614090360&4294967295,v=I+(_<<7&4294967295|_>>>25),_=R+(A^v&(I^A))+N[1]+3905402710&4294967295,R=v+(_<<12&4294967295|_>>>20),_=A+(I^R&(v^I))+N[2]+606105819&4294967295,A=R+(_<<17&4294967295|_>>>15),_=I+(v^A&(R^v))+N[3]+3250441966&4294967295,I=A+(_<<22&4294967295|_>>>10),_=v+(R^I&(A^R))+N[4]+4118548399&4294967295,v=I+(_<<7&4294967295|_>>>25),_=R+(A^v&(I^A))+N[5]+1200080426&4294967295,R=v+(_<<12&4294967295|_>>>20),_=A+(I^R&(v^I))+N[6]+2821735955&4294967295,A=R+(_<<17&4294967295|_>>>15),_=I+(v^A&(R^v))+N[7]+4249261313&4294967295,I=A+(_<<22&4294967295|_>>>10),_=v+(R^I&(A^R))+N[8]+1770035416&4294967295,v=I+(_<<7&4294967295|_>>>25),_=R+(A^v&(I^A))+N[9]+2336552879&4294967295,R=v+(_<<12&4294967295|_>>>20),_=A+(I^R&(v^I))+N[10]+4294925233&4294967295,A=R+(_<<17&4294967295|_>>>15),_=I+(v^A&(R^v))+N[11]+2304563134&4294967295,I=A+(_<<22&4294967295|_>>>10),_=v+(R^I&(A^R))+N[12]+1804603682&4294967295,v=I+(_<<7&4294967295|_>>>25),_=R+(A^v&(I^A))+N[13]+4254626195&4294967295,R=v+(_<<12&4294967295|_>>>20),_=A+(I^R&(v^I))+N[14]+2792965006&4294967295,A=R+(_<<17&4294967295|_>>>15),_=I+(v^A&(R^v))+N[15]+1236535329&4294967295,I=A+(_<<22&4294967295|_>>>10),_=v+(A^R&(I^A))+N[1]+4129170786&4294967295,v=I+(_<<5&4294967295|_>>>27),_=R+(I^A&(v^I))+N[6]+3225465664&4294967295,R=v+(_<<9&4294967295|_>>>23),_=A+(v^I&(R^v))+N[11]+643717713&4294967295,A=R+(_<<14&4294967295|_>>>18),_=I+(R^v&(A^R))+N[0]+3921069994&4294967295,I=A+(_<<20&4294967295|_>>>12),_=v+(A^R&(I^A))+N[5]+3593408605&4294967295,v=I+(_<<5&4294967295|_>>>27),_=R+(I^A&(v^I))+N[10]+38016083&4294967295,R=v+(_<<9&4294967295|_>>>23),_=A+(v^I&(R^v))+N[15]+3634488961&4294967295,A=R+(_<<14&4294967295|_>>>18),_=I+(R^v&(A^R))+N[4]+3889429448&4294967295,I=A+(_<<20&4294967295|_>>>12),_=v+(A^R&(I^A))+N[9]+568446438&4294967295,v=I+(_<<5&4294967295|_>>>27),_=R+(I^A&(v^I))+N[14]+3275163606&4294967295,R=v+(_<<9&4294967295|_>>>23),_=A+(v^I&(R^v))+N[3]+4107603335&4294967295,A=R+(_<<14&4294967295|_>>>18),_=I+(R^v&(A^R))+N[8]+1163531501&4294967295,I=A+(_<<20&4294967295|_>>>12),_=v+(A^R&(I^A))+N[13]+2850285829&4294967295,v=I+(_<<5&4294967295|_>>>27),_=R+(I^A&(v^I))+N[2]+4243563512&4294967295,R=v+(_<<9&4294967295|_>>>23),_=A+(v^I&(R^v))+N[7]+1735328473&4294967295,A=R+(_<<14&4294967295|_>>>18),_=I+(R^v&(A^R))+N[12]+2368359562&4294967295,I=A+(_<<20&4294967295|_>>>12),_=v+(I^A^R)+N[5]+4294588738&4294967295,v=I+(_<<4&4294967295|_>>>28),_=R+(v^I^A)+N[8]+2272392833&4294967295,R=v+(_<<11&4294967295|_>>>21),_=A+(R^v^I)+N[11]+1839030562&4294967295,A=R+(_<<16&4294967295|_>>>16),_=I+(A^R^v)+N[14]+4259657740&4294967295,I=A+(_<<23&4294967295|_>>>9),_=v+(I^A^R)+N[1]+2763975236&4294967295,v=I+(_<<4&4294967295|_>>>28),_=R+(v^I^A)+N[4]+1272893353&4294967295,R=v+(_<<11&4294967295|_>>>21),_=A+(R^v^I)+N[7]+4139469664&4294967295,A=R+(_<<16&4294967295|_>>>16),_=I+(A^R^v)+N[10]+3200236656&4294967295,I=A+(_<<23&4294967295|_>>>9),_=v+(I^A^R)+N[13]+681279174&4294967295,v=I+(_<<4&4294967295|_>>>28),_=R+(v^I^A)+N[0]+3936430074&4294967295,R=v+(_<<11&4294967295|_>>>21),_=A+(R^v^I)+N[3]+3572445317&4294967295,A=R+(_<<16&4294967295|_>>>16),_=I+(A^R^v)+N[6]+76029189&4294967295,I=A+(_<<23&4294967295|_>>>9),_=v+(I^A^R)+N[9]+3654602809&4294967295,v=I+(_<<4&4294967295|_>>>28),_=R+(v^I^A)+N[12]+3873151461&4294967295,R=v+(_<<11&4294967295|_>>>21),_=A+(R^v^I)+N[15]+530742520&4294967295,A=R+(_<<16&4294967295|_>>>16),_=I+(A^R^v)+N[2]+3299628645&4294967295,I=A+(_<<23&4294967295|_>>>9),_=v+(A^(I|~R))+N[0]+4096336452&4294967295,v=I+(_<<6&4294967295|_>>>26),_=R+(I^(v|~A))+N[7]+1126891415&4294967295,R=v+(_<<10&4294967295|_>>>22),_=A+(v^(R|~I))+N[14]+2878612391&4294967295,A=R+(_<<15&4294967295|_>>>17),_=I+(R^(A|~v))+N[5]+4237533241&4294967295,I=A+(_<<21&4294967295|_>>>11),_=v+(A^(I|~R))+N[12]+1700485571&4294967295,v=I+(_<<6&4294967295|_>>>26),_=R+(I^(v|~A))+N[3]+2399980690&4294967295,R=v+(_<<10&4294967295|_>>>22),_=A+(v^(R|~I))+N[10]+4293915773&4294967295,A=R+(_<<15&4294967295|_>>>17),_=I+(R^(A|~v))+N[1]+2240044497&4294967295,I=A+(_<<21&4294967295|_>>>11),_=v+(A^(I|~R))+N[8]+1873313359&4294967295,v=I+(_<<6&4294967295|_>>>26),_=R+(I^(v|~A))+N[15]+4264355552&4294967295,R=v+(_<<10&4294967295|_>>>22),_=A+(v^(R|~I))+N[6]+2734768916&4294967295,A=R+(_<<15&4294967295|_>>>17),_=I+(R^(A|~v))+N[13]+1309151649&4294967295,I=A+(_<<21&4294967295|_>>>11),_=v+(A^(I|~R))+N[4]+4149444226&4294967295,v=I+(_<<6&4294967295|_>>>26),_=R+(I^(v|~A))+N[11]+3174756917&4294967295,R=v+(_<<10&4294967295|_>>>22),_=A+(v^(R|~I))+N[2]+718787259&4294967295,A=R+(_<<15&4294967295|_>>>17),_=I+(R^(A|~v))+N[9]+3951481745&4294967295,E.g[0]=E.g[0]+v&4294967295,E.g[1]=E.g[1]+(A+(_<<21&4294967295|_>>>11))&4294967295,E.g[2]=E.g[2]+A&4294967295,E.g[3]=E.g[3]+R&4294967295}s.prototype.v=function(E,v){v===void 0&&(v=E.length);const I=v-this.blockSize,N=this.C;let A=this.h,R=0;for(;R<v;){if(A==0)for(;R<=I;)r(this,E,R),R+=this.blockSize;if(typeof E=="string"){for(;R<v;)if(N[A++]=E.charCodeAt(R++),A==this.blockSize){r(this,N),A=0;break}}else for(;R<v;)if(N[A++]=E[R++],A==this.blockSize){r(this,N),A=0;break}}this.h=A,this.o+=v},s.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var v=1;v<E.length-8;++v)E[v]=0;v=this.o*8;for(var I=E.length-8;I<E.length;++I)E[I]=v&255,v/=256;for(this.v(E),E=Array(16),v=0,I=0;I<4;++I)for(let N=0;N<32;N+=8)E[v++]=this.g[I]>>>N&255;return E};function i(E,v){var I=c;return Object.prototype.hasOwnProperty.call(I,E)?I[E]:I[E]=v(E)}function o(E,v){this.h=v;const I=[];let N=!0;for(let A=E.length-1;A>=0;A--){const R=E[A]|0;N&&R==v||(I[A]=R,N=!1)}this.g=I}var c={};function l(E){return-128<=E&&E<128?i(E,function(v){return new o([v|0],v<0?-1:0)}):new o([E|0],E<0?-1:0)}function h(E){if(isNaN(E)||!isFinite(E))return m;if(E<0)return C(h(-E));const v=[];let I=1;for(let N=0;E>=I;N++)v[N]=E/I|0,I*=4294967296;return new o(v,0)}function d(E,v){if(E.length==0)throw Error("number format error: empty string");if(v=v||10,v<2||36<v)throw Error("radix out of range: "+v);if(E.charAt(0)=="-")return C(d(E.substring(1),v));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const I=h(Math.pow(v,8));let N=m;for(let R=0;R<E.length;R+=8){var A=Math.min(8,E.length-R);const _=parseInt(E.substring(R,R+A),v);A<8?(A=h(Math.pow(v,A)),N=N.j(A).add(h(_))):(N=N.j(I),N=N.add(h(_)))}return N}var m=l(0),p=l(1),y=l(16777216);t=o.prototype,t.m=function(){if(P(this))return-C(this).m();let E=0,v=1;for(let I=0;I<this.g.length;I++){const N=this.i(I);E+=(N>=0?N:4294967296+N)*v,v*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(x(this))return"0";if(P(this))return"-"+C(this).toString(E);const v=h(Math.pow(E,6));var I=this;let N="";for(;;){const A=L(I,v).g;I=S(I,A.j(v));let R=((I.g.length>0?I.g[0]:I.h)>>>0).toString(E);if(I=A,x(I))return R+N;for(;R.length<6;)R="0"+R;N=R+N}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function x(E){if(E.h!=0)return!1;for(let v=0;v<E.g.length;v++)if(E.g[v]!=0)return!1;return!0}function P(E){return E.h==-1}t.l=function(E){return E=S(this,E),P(E)?-1:x(E)?0:1};function C(E){const v=E.g.length,I=[];for(let N=0;N<v;N++)I[N]=~E.g[N];return new o(I,~E.h).add(p)}t.abs=function(){return P(this)?C(this):this},t.add=function(E){const v=Math.max(this.g.length,E.g.length),I=[];let N=0;for(let A=0;A<=v;A++){let R=N+(this.i(A)&65535)+(E.i(A)&65535),_=(R>>>16)+(this.i(A)>>>16)+(E.i(A)>>>16);N=_>>>16,R&=65535,_&=65535,I[A]=_<<16|R}return new o(I,I[I.length-1]&-2147483648?-1:0)};function S(E,v){return E.add(C(v))}t.j=function(E){if(x(this)||x(E))return m;if(P(this))return P(E)?C(this).j(C(E)):C(C(this).j(E));if(P(E))return C(this.j(C(E)));if(this.l(y)<0&&E.l(y)<0)return h(this.m()*E.m());const v=this.g.length+E.g.length,I=[];for(var N=0;N<2*v;N++)I[N]=0;for(N=0;N<this.g.length;N++)for(let A=0;A<E.g.length;A++){const R=this.i(N)>>>16,_=this.i(N)&65535,B=E.i(A)>>>16,Z=E.i(A)&65535;I[2*N+2*A]+=_*Z,T(I,2*N+2*A),I[2*N+2*A+1]+=R*Z,T(I,2*N+2*A+1),I[2*N+2*A+1]+=_*B,T(I,2*N+2*A+1),I[2*N+2*A+2]+=R*B,T(I,2*N+2*A+2)}for(E=0;E<v;E++)I[E]=I[2*E+1]<<16|I[2*E];for(E=v;E<2*v;E++)I[E]=0;return new o(I,0)};function T(E,v){for(;(E[v]&65535)!=E[v];)E[v+1]+=E[v]>>>16,E[v]&=65535,v++}function k(E,v){this.g=E,this.h=v}function L(E,v){if(x(v))throw Error("division by zero");if(x(E))return new k(m,m);if(P(E))return v=L(C(E),v),new k(C(v.g),C(v.h));if(P(v))return v=L(E,C(v)),new k(C(v.g),v.h);if(E.g.length>30){if(P(E)||P(v))throw Error("slowDivide_ only works with positive integers.");for(var I=p,N=v;N.l(E)<=0;)I=D(I),N=D(N);var A=V(I,1),R=V(N,1);for(N=V(N,2),I=V(I,2);!x(N);){var _=R.add(N);_.l(E)<=0&&(A=A.add(I),R=_),N=V(N,1),I=V(I,1)}return v=S(E,A.j(v)),new k(A,v)}for(A=m;E.l(v)>=0;){for(I=Math.max(1,Math.floor(E.m()/v.m())),N=Math.ceil(Math.log(I)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),R=h(I),_=R.j(v);P(_)||_.l(E)>0;)I-=N,R=h(I),_=R.j(v);x(R)&&(R=p),A=A.add(R),E=S(E,_)}return new k(A,E)}t.B=function(E){return L(this,E).h},t.and=function(E){const v=Math.max(this.g.length,E.g.length),I=[];for(let N=0;N<v;N++)I[N]=this.i(N)&E.i(N);return new o(I,this.h&E.h)},t.or=function(E){const v=Math.max(this.g.length,E.g.length),I=[];for(let N=0;N<v;N++)I[N]=this.i(N)|E.i(N);return new o(I,this.h|E.h)},t.xor=function(E){const v=Math.max(this.g.length,E.g.length),I=[];for(let N=0;N<v;N++)I[N]=this.i(N)^E.i(N);return new o(I,this.h^E.h)};function D(E){const v=E.g.length+1,I=[];for(let N=0;N<v;N++)I[N]=E.i(N)<<1|E.i(N-1)>>>31;return new o(I,E.h)}function V(E,v){const I=v>>5;v%=32;const N=E.g.length-I,A=[];for(let R=0;R<N;R++)A[R]=v>0?E.i(R+I)>>>v|E.i(R+I+1)<<32-v:E.i(R+I);return new o(A,E.h)}s.prototype.digest=s.prototype.A,s.prototype.reset=s.prototype.u,s.prototype.update=s.prototype.v,w0=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,dn=o}).apply(typeof lm<"u"?lm:typeof self<"u"?self:typeof window<"u"?window:{});var Ui=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var x0,wr,v0,no,Xc,b0,T0,E0;(function(){var t,e=Object.defineProperty;function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ui=="object"&&Ui];for(var f=0;f<a.length;++f){var g=a[f];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var s=n(this);function r(a,f){if(f)e:{var g=s;a=a.split(".");for(var w=0;w<a.length-1;w++){var j=a[w];if(!(j in g))break e;g=g[j]}a=a[a.length-1],w=g[a],f=f(w),f!=w&&f!=null&&e(g,a,{configurable:!0,writable:!0,value:f})}}r("Symbol.dispose",function(a){return a||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(a){return a||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(a){return a||function(f){var g=[],w;for(w in f)Object.prototype.hasOwnProperty.call(f,w)&&g.push([w,f[w]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function c(a){var f=typeof a;return f=="object"&&a!=null||f=="function"}function l(a,f,g){return a.call.apply(a.bind,arguments)}function h(a,f,g){return h=l,h.apply(null,arguments)}function d(a,f){var g=Array.prototype.slice.call(arguments,1);return function(){var w=g.slice();return w.push.apply(w,arguments),a.apply(this,w)}}function m(a,f){function g(){}g.prototype=f.prototype,a.Z=f.prototype,a.prototype=new g,a.prototype.constructor=a,a.Ob=function(w,j,M){for(var $=Array(arguments.length-2),ee=2;ee<arguments.length;ee++)$[ee-2]=arguments[ee];return f.prototype[j].apply(w,$)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?a=>a&&AsyncContext.Snapshot.wrap(a):a=>a;function y(a){const f=a.length;if(f>0){const g=Array(f);for(let w=0;w<f;w++)g[w]=a[w];return g}return[]}function x(a,f){for(let w=1;w<arguments.length;w++){const j=arguments[w];var g=typeof j;if(g=g!="object"?g:j?Array.isArray(j)?"array":g:"null",g=="array"||g=="object"&&typeof j.length=="number"){g=a.length||0;const M=j.length||0;a.length=g+M;for(let $=0;$<M;$++)a[g+$]=j[$]}else a.push(j)}}class P{constructor(f,g){this.i=f,this.j=g,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function C(a){o.setTimeout(()=>{throw a},0)}function S(){var a=E;let f=null;return a.g&&(f=a.g,a.g=a.g.next,a.g||(a.h=null),f.next=null),f}class T{constructor(){this.h=this.g=null}add(f,g){const w=k.get();w.set(f,g),this.h?this.h.next=w:this.g=w,this.h=w}}var k=new P(()=>new L,a=>a.reset());class L{constructor(){this.next=this.g=this.h=null}set(f,g){this.h=f,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let D,V=!1,E=new T,v=()=>{const a=Promise.resolve(void 0);D=()=>{a.then(I)}};function I(){for(var a;a=S();){try{a.h.call(a.g)}catch(g){C(g)}var f=k;f.j(a),f.h<100&&(f.h++,a.next=f.g,f.g=a)}V=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function A(a,f){this.type=a,this.g=this.target=f,this.defaultPrevented=!1}A.prototype.h=function(){this.defaultPrevented=!0};var R=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var a=!1,f=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const g=()=>{};o.addEventListener("test",g,f),o.removeEventListener("test",g,f)}catch{}return a}();function _(a){return/^[\s\xa0]*$/.test(a)}function B(a,f){A.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a&&this.init(a,f)}m(B,A),B.prototype.init=function(a,f){const g=this.type=a.type,w=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement,this.g=f,f=a.relatedTarget,f||(g=="mouseover"?f=a.fromElement:g=="mouseout"&&(f=a.toElement)),this.relatedTarget=f,w?(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=a.pointerType,this.state=a.state,this.i=a,a.defaultPrevented&&B.Z.h.call(this)},B.prototype.h=function(){B.Z.h.call(this);const a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var Z="closure_listenable_"+(Math.random()*1e6|0),ae=0;function te(a,f,g,w,j){this.listener=a,this.proxy=null,this.src=f,this.type=g,this.capture=!!w,this.ha=j,this.key=++ae,this.da=this.fa=!1}function O(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function J(a,f,g){for(const w in a)f.call(g,a[w],w,a)}function fe(a,f){for(const g in a)f.call(void 0,a[g],g,a)}function je(a){const f={};for(const g in a)f[g]=a[g];return f}const Ke="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $e(a,f){let g,w;for(let j=1;j<arguments.length;j++){w=arguments[j];for(g in w)a[g]=w[g];for(let M=0;M<Ke.length;M++)g=Ke[M],Object.prototype.hasOwnProperty.call(w,g)&&(a[g]=w[g])}}function ht(a){this.src=a,this.g={},this.h=0}ht.prototype.add=function(a,f,g,w,j){const M=a.toString();a=this.g[M],a||(a=this.g[M]=[],this.h++);const $=rs(a,f,w,j);return $>-1?(f=a[$],g||(f.fa=!1)):(f=new te(f,this.src,M,!!w,j),f.fa=g,a.push(f)),f};function ss(a,f){const g=f.type;if(g in a.g){var w=a.g[g],j=Array.prototype.indexOf.call(w,f,void 0),M;(M=j>=0)&&Array.prototype.splice.call(w,j,1),M&&(O(f),a.g[g].length==0&&(delete a.g[g],a.h--))}}function rs(a,f,g,w){for(let j=0;j<a.length;++j){const M=a[j];if(!M.da&&M.listener==f&&M.capture==!!g&&M.ha==w)return j}return-1}var An="closure_lm_"+(Math.random()*1e6|0),ma={};function rh(a,f,g,w,j){if(Array.isArray(f)){for(let M=0;M<f.length;M++)rh(a,f[M],g,w,j);return null}return g=ah(g),a&&a[Z]?a.J(f,g,c(w)?!!w.capture:!1,j):Tw(a,f,g,!1,w,j)}function Tw(a,f,g,w,j,M){if(!f)throw Error("Invalid event type");const $=c(j)?!!j.capture:!!j;let ee=ga(a);if(ee||(a[An]=ee=new ht(a)),g=ee.add(f,g,w,$,M),g.proxy)return g;if(w=Ew(),g.proxy=w,w.src=a,w.listener=g,a.addEventListener)R||(j=$),j===void 0&&(j=!1),a.addEventListener(f.toString(),w,j);else if(a.attachEvent)a.attachEvent(oh(f.toString()),w);else if(a.addListener&&a.removeListener)a.addListener(w);else throw Error("addEventListener and attachEvent are unavailable.");return g}function Ew(){function a(g){return f.call(a.src,a.listener,g)}const f=Iw;return a}function ih(a,f,g,w,j){if(Array.isArray(f))for(var M=0;M<f.length;M++)ih(a,f[M],g,w,j);else w=c(w)?!!w.capture:!!w,g=ah(g),a&&a[Z]?(a=a.i,M=String(f).toString(),M in a.g&&(f=a.g[M],g=rs(f,g,w,j),g>-1&&(O(f[g]),Array.prototype.splice.call(f,g,1),f.length==0&&(delete a.g[M],a.h--)))):a&&(a=ga(a))&&(f=a.g[f.toString()],a=-1,f&&(a=rs(f,g,w,j)),(g=a>-1?f[a]:null)&&pa(g))}function pa(a){if(typeof a!="number"&&a&&!a.da){var f=a.src;if(f&&f[Z])ss(f.i,a);else{var g=a.type,w=a.proxy;f.removeEventListener?f.removeEventListener(g,w,a.capture):f.detachEvent?f.detachEvent(oh(g),w):f.addListener&&f.removeListener&&f.removeListener(w),(g=ga(f))?(ss(g,a),g.h==0&&(g.src=null,f[An]=null)):O(a)}}}function oh(a){return a in ma?ma[a]:ma[a]="on"+a}function Iw(a,f){if(a.da)a=!0;else{f=new B(f,this);const g=a.listener,w=a.ha||a.src;a.fa&&pa(a),a=g.call(w,f)}return a}function ga(a){return a=a[An],a instanceof ht?a:null}var ya="__closure_events_fn_"+(Math.random()*1e9>>>0);function ah(a){return typeof a=="function"?a:(a[ya]||(a[ya]=function(f){return a.handleEvent(f)}),a[ya])}function Be(){N.call(this),this.i=new ht(this),this.M=this,this.G=null}m(Be,N),Be.prototype[Z]=!0,Be.prototype.removeEventListener=function(a,f,g,w){ih(this,a,f,g,w)};function Qe(a,f){var g,w=a.G;if(w)for(g=[];w;w=w.G)g.push(w);if(a=a.M,w=f.type||f,typeof f=="string")f=new A(f,a);else if(f instanceof A)f.target=f.target||a;else{var j=f;f=new A(w,a),$e(f,j)}j=!0;let M,$;if(g)for($=g.length-1;$>=0;$--)M=f.g=g[$],j=bi(M,w,!0,f)&&j;if(M=f.g=a,j=bi(M,w,!0,f)&&j,j=bi(M,w,!1,f)&&j,g)for($=0;$<g.length;$++)M=f.g=g[$],j=bi(M,w,!1,f)&&j}Be.prototype.N=function(){if(Be.Z.N.call(this),this.i){var a=this.i;for(const f in a.g){const g=a.g[f];for(let w=0;w<g.length;w++)O(g[w]);delete a.g[f],a.h--}}this.G=null},Be.prototype.J=function(a,f,g,w){return this.i.add(String(a),f,!1,g,w)},Be.prototype.K=function(a,f,g,w){return this.i.add(String(a),f,!0,g,w)};function bi(a,f,g,w){if(f=a.i.g[String(f)],!f)return!0;f=f.concat();let j=!0;for(let M=0;M<f.length;++M){const $=f[M];if($&&!$.da&&$.capture==g){const ee=$.listener,Ne=$.ha||$.src;$.fa&&ss(a.i,$),j=ee.call(Ne,w)!==!1&&j}}return j&&!w.defaultPrevented}function Aw(a,f){if(typeof a!="function")if(a&&typeof a.handleEvent=="function")a=h(a.handleEvent,a);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:o.setTimeout(a,f||0)}function ch(a){a.g=Aw(()=>{a.g=null,a.i&&(a.i=!1,ch(a))},a.l);const f=a.h;a.h=null,a.m.apply(null,f)}class Sw extends N{constructor(f,g){super(),this.m=f,this.l=g,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:ch(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ys(a){N.call(this),this.h=a,this.g={}}m(Ys,N);var lh=[];function uh(a){J(a.g,function(f,g){this.g.hasOwnProperty(g)&&pa(f)},a),a.g={}}Ys.prototype.N=function(){Ys.Z.N.call(this),uh(this)},Ys.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _a=o.JSON.stringify,Nw=o.JSON.parse,Pw=class{stringify(a){return o.JSON.stringify(a,void 0)}parse(a){return o.JSON.parse(a,void 0)}};function hh(){}function dh(){}var Xs={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function wa(){A.call(this,"d")}m(wa,A);function xa(){A.call(this,"c")}m(xa,A);var Sn={},fh=null;function Ti(){return fh=fh||new Be}Sn.Ia="serverreachability";function mh(a){A.call(this,Sn.Ia,a)}m(mh,A);function Js(a){const f=Ti();Qe(f,new mh(f))}Sn.STAT_EVENT="statevent";function ph(a,f){A.call(this,Sn.STAT_EVENT,a),this.stat=f}m(ph,A);function Ye(a){const f=Ti();Qe(f,new ph(f,a))}Sn.Ja="timingevent";function gh(a,f){A.call(this,Sn.Ja,a),this.size=f}m(gh,A);function Zs(a,f){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){a()},f)}function er(){this.g=!0}er.prototype.ua=function(){this.g=!1};function Cw(a,f,g,w,j,M){a.info(function(){if(a.g)if(M){var $="",ee=M.split("&");for(let le=0;le<ee.length;le++){var Ne=ee[le].split("=");if(Ne.length>1){const ke=Ne[0];Ne=Ne[1];const Tt=ke.split("_");$=Tt.length>=2&&Tt[1]=="type"?$+(ke+"="+Ne+"&"):$+(ke+"=redacted&")}}}else $=null;else $=M;return"XMLHTTP REQ ("+w+") [attempt "+j+"]: "+f+`
`+g+`
`+$})}function Rw(a,f,g,w,j,M,$){a.info(function(){return"XMLHTTP RESP ("+w+") [ attempt "+j+"]: "+f+`
`+g+`
`+M+" "+$})}function is(a,f,g,w){a.info(function(){return"XMLHTTP TEXT ("+f+"): "+Dw(a,g)+(w?" "+w:"")})}function kw(a,f){a.info(function(){return"TIMEOUT: "+f})}er.prototype.info=function(){};function Dw(a,f){if(!a.g)return f;if(!f)return null;try{const M=JSON.parse(f);if(M){for(a=0;a<M.length;a++)if(Array.isArray(M[a])){var g=M[a];if(!(g.length<2)){var w=g[1];if(Array.isArray(w)&&!(w.length<1)){var j=w[0];if(j!="noop"&&j!="stop"&&j!="close")for(let $=1;$<w.length;$++)w[$]=""}}}}return _a(M)}catch{return f}}var Ei={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},yh={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},_h;function va(){}m(va,hh),va.prototype.g=function(){return new XMLHttpRequest},_h=new va;function tr(a){return encodeURIComponent(String(a))}function jw(a){var f=1;a=a.split(":");const g=[];for(;f>0&&a.length;)g.push(a.shift()),f--;return a.length&&g.push(a.join(":")),g}function Qt(a,f,g,w){this.j=a,this.i=f,this.l=g,this.S=w||1,this.V=new Ys(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new wh}function wh(){this.i=null,this.g="",this.h=!1}var xh={},ba={};function Ta(a,f,g){a.M=1,a.A=Ai(bt(f)),a.u=g,a.R=!0,vh(a,null)}function vh(a,f){a.F=Date.now(),Ii(a),a.B=bt(a.A);var g=a.B,w=a.S;Array.isArray(w)||(w=[String(w)]),jh(g.i,"t",w),a.C=0,g=a.j.L,a.h=new wh,a.g=Jh(a.j,g?f:null,!a.u),a.P>0&&(a.O=new Sw(h(a.Y,a,a.g),a.P)),f=a.V,g=a.g,w=a.ba;var j="readystatechange";Array.isArray(j)||(j&&(lh[0]=j.toString()),j=lh);for(let M=0;M<j.length;M++){const $=rh(g,j[M],w||f.handleEvent,!1,f.h||f);if(!$)break;f.g[$.key]=$}f=a.J?je(a.J):{},a.u?(a.v||(a.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.B,a.v,a.u,f)):(a.v="GET",a.g.ea(a.B,a.v,null,f)),Js(),Cw(a.i,a.v,a.B,a.l,a.S,a.u)}Qt.prototype.ba=function(a){a=a.target;const f=this.O;f&&Jt(a)==3?f.j():this.Y(a)},Qt.prototype.Y=function(a){try{if(a==this.g)e:{const ee=Jt(this.g),Ne=this.g.ya(),le=this.g.ca();if(!(ee<3)&&(ee!=3||this.g&&(this.h.h||this.g.la()||$h(this.g)))){this.K||ee!=4||Ne==7||(Ne==8||le<=0?Js(3):Js(2)),Ea(this);var f=this.g.ca();this.X=f;var g=Vw(this);if(this.o=f==200,Rw(this.i,this.v,this.B,this.l,this.S,ee,f),this.o){if(this.U&&!this.L){t:{if(this.g){var w,j=this.g;if((w=j.g?j.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(w)){var M=w;break t}}M=null}if(a=M)is(this.i,this.l,a,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ia(this,a);else{this.o=!1,this.m=3,Ye(12),Nn(this),nr(this);break e}}if(this.R){a=!0;let ke;for(;!this.K&&this.C<g.length;)if(ke=Mw(this,g),ke==ba){ee==4&&(this.m=4,Ye(14),a=!1),is(this.i,this.l,null,"[Incomplete Response]");break}else if(ke==xh){this.m=4,Ye(15),is(this.i,this.l,g,"[Invalid Chunk]"),a=!1;break}else is(this.i,this.l,ke,null),Ia(this,ke);if(bh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ee!=4||g.length!=0||this.h.h||(this.m=1,Ye(16),a=!1),this.o=this.o&&a,!a)is(this.i,this.l,g,"[Invalid Chunked Response]"),Nn(this),nr(this);else if(g.length>0&&!this.W){this.W=!0;var $=this.j;$.g==this&&$.aa&&!$.P&&($.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),Da($),$.P=!0,Ye(11))}}else is(this.i,this.l,g,null),Ia(this,g);ee==4&&Nn(this),this.o&&!this.K&&(ee==4?Kh(this.j,this):(this.o=!1,Ii(this)))}else Yw(this.g),f==400&&g.indexOf("Unknown SID")>0?(this.m=3,Ye(12)):(this.m=0,Ye(13)),Nn(this),nr(this)}}}catch{}finally{}};function Vw(a){if(!bh(a))return a.g.la();const f=$h(a.g);if(f==="")return"";let g="";const w=f.length,j=Jt(a.g)==4;if(!a.h.i){if(typeof TextDecoder>"u")return Nn(a),nr(a),"";a.h.i=new o.TextDecoder}for(let M=0;M<w;M++)a.h.h=!0,g+=a.h.i.decode(f[M],{stream:!(j&&M==w-1)});return f.length=0,a.h.g+=g,a.C=0,a.h.g}function bh(a){return a.g?a.v=="GET"&&a.M!=2&&a.j.Aa:!1}function Mw(a,f){var g=a.C,w=f.indexOf(`
`,g);return w==-1?ba:(g=Number(f.substring(g,w)),isNaN(g)?xh:(w+=1,w+g>f.length?ba:(f=f.slice(w,w+g),a.C=w+g,f)))}Qt.prototype.cancel=function(){this.K=!0,Nn(this)};function Ii(a){a.T=Date.now()+a.H,Th(a,a.H)}function Th(a,f){if(a.D!=null)throw Error("WatchDog timer not null");a.D=Zs(h(a.aa,a),f)}function Ea(a){a.D&&(o.clearTimeout(a.D),a.D=null)}Qt.prototype.aa=function(){this.D=null;const a=Date.now();a-this.T>=0?(kw(this.i,this.B),this.M!=2&&(Js(),Ye(17)),Nn(this),this.m=2,nr(this)):Th(this,this.T-a)};function nr(a){a.j.I==0||a.K||Kh(a.j,a)}function Nn(a){Ea(a);var f=a.O;f&&typeof f.dispose=="function"&&f.dispose(),a.O=null,uh(a.V),a.g&&(f=a.g,a.g=null,f.abort(),f.dispose())}function Ia(a,f){try{var g=a.j;if(g.I!=0&&(g.g==a||Aa(g.h,a))){if(!a.L&&Aa(g.h,a)&&g.I==3){try{var w=g.Ba.g.parse(f)}catch{w=null}if(Array.isArray(w)&&w.length==3){var j=w;if(j[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<a.F)Ri(g),Pi(g);else break e;ka(g),Ye(18)}}else g.xa=j[1],0<g.xa-g.K&&j[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=Zs(h(g.Va,g),6e3));Ah(g.h)<=1&&g.ta&&(g.ta=void 0)}else Cn(g,11)}else if((a.L||g.g==a)&&Ri(g),!_(f))for(j=g.Ba.g.parse(f),f=0;f<j.length;f++){let le=j[f];const ke=le[0];if(!(ke<=g.K))if(g.K=ke,le=le[1],g.I==2)if(le[0]=="c"){g.M=le[1],g.ba=le[2];const Tt=le[3];Tt!=null&&(g.ka=Tt,g.j.info("VER="+g.ka));const Rn=le[4];Rn!=null&&(g.za=Rn,g.j.info("SVER="+g.za));const Zt=le[5];Zt!=null&&typeof Zt=="number"&&Zt>0&&(w=1.5*Zt,g.O=w,g.j.info("backChannelRequestTimeoutMs_="+w)),w=g;const en=a.g;if(en){const Di=en.g?en.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Di){var M=w.h;M.g||Di.indexOf("spdy")==-1&&Di.indexOf("quic")==-1&&Di.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(Sa(M,M.h),M.h=null))}if(w.G){const ja=en.g?en.g.getResponseHeader("X-HTTP-Session-Id"):null;ja&&(w.wa=ja,de(w.J,w.G,ja))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-a.F,g.j.info("Handshake RTT: "+g.T+"ms")),w=g;var $=a;if(w.na=Xh(w,w.L?w.ba:null,w.W),$.L){Sh(w.h,$);var ee=$,Ne=w.O;Ne&&(ee.H=Ne),ee.D&&(Ea(ee),Ii(ee)),w.g=$}else Hh(w);g.i.length>0&&Ci(g)}else le[0]!="stop"&&le[0]!="close"||Cn(g,7);else g.I==3&&(le[0]=="stop"||le[0]=="close"?le[0]=="stop"?Cn(g,7):Ra(g):le[0]!="noop"&&g.l&&g.l.qa(le),g.A=0)}}Js(4)}catch{}}var Lw=class{constructor(a,f){this.g=a,this.map=f}};function Eh(a){this.l=a||10,o.PerformanceNavigationTiming?(a=o.performance.getEntriesByType("navigation"),a=a.length>0&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Ih(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function Ah(a){return a.h?1:a.g?a.g.size:0}function Aa(a,f){return a.h?a.h==f:a.g?a.g.has(f):!1}function Sa(a,f){a.g?a.g.add(f):a.h=f}function Sh(a,f){a.h&&a.h==f?a.h=null:a.g&&a.g.has(f)&&a.g.delete(f)}Eh.prototype.cancel=function(){if(this.i=Nh(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function Nh(a){if(a.h!=null)return a.i.concat(a.h.G);if(a.g!=null&&a.g.size!==0){let f=a.i;for(const g of a.g.values())f=f.concat(g.G);return f}return y(a.i)}var Ph=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ow(a,f){if(a){a=a.split("&");for(let g=0;g<a.length;g++){const w=a[g].indexOf("=");let j,M=null;w>=0?(j=a[g].substring(0,w),M=a[g].substring(w+1)):j=a[g],f(j,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function Yt(a){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;a instanceof Yt?(this.l=a.l,sr(this,a.j),this.o=a.o,this.g=a.g,rr(this,a.u),this.h=a.h,Na(this,Vh(a.i)),this.m=a.m):a&&(f=String(a).match(Ph))?(this.l=!1,sr(this,f[1]||"",!0),this.o=ir(f[2]||""),this.g=ir(f[3]||"",!0),rr(this,f[4]),this.h=ir(f[5]||"",!0),Na(this,f[6]||"",!0),this.m=ir(f[7]||"")):(this.l=!1,this.i=new ar(null,this.l))}Yt.prototype.toString=function(){const a=[];var f=this.j;f&&a.push(or(f,Ch,!0),":");var g=this.g;return(g||f=="file")&&(a.push("//"),(f=this.o)&&a.push(or(f,Ch,!0),"@"),a.push(tr(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&a.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&a.push("/"),a.push(or(g,g.charAt(0)=="/"?$w:Uw,!0))),(g=this.i.toString())&&a.push("?",g),(g=this.m)&&a.push("#",or(g,qw)),a.join("")},Yt.prototype.resolve=function(a){const f=bt(this);let g=!!a.j;g?sr(f,a.j):g=!!a.o,g?f.o=a.o:g=!!a.g,g?f.g=a.g:g=a.u!=null;var w=a.h;if(g)rr(f,a.u);else if(g=!!a.h){if(w.charAt(0)!="/")if(this.g&&!this.h)w="/"+w;else{var j=f.h.lastIndexOf("/");j!=-1&&(w=f.h.slice(0,j+1)+w)}if(j=w,j==".."||j==".")w="";else if(j.indexOf("./")!=-1||j.indexOf("/.")!=-1){w=j.lastIndexOf("/",0)==0,j=j.split("/");const M=[];for(let $=0;$<j.length;){const ee=j[$++];ee=="."?w&&$==j.length&&M.push(""):ee==".."?((M.length>1||M.length==1&&M[0]!="")&&M.pop(),w&&$==j.length&&M.push("")):(M.push(ee),w=!0)}w=M.join("/")}else w=j}return g?f.h=w:g=a.i.toString()!=="",g?Na(f,Vh(a.i)):g=!!a.m,g&&(f.m=a.m),f};function bt(a){return new Yt(a)}function sr(a,f,g){a.j=g?ir(f,!0):f,a.j&&(a.j=a.j.replace(/:$/,""))}function rr(a,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);a.u=f}else a.u=null}function Na(a,f,g){f instanceof ar?(a.i=f,Ww(a.i,a.l)):(g||(f=or(f,Bw)),a.i=new ar(f,a.l))}function de(a,f,g){a.i.set(f,g)}function Ai(a){return de(a,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),a}function ir(a,f){return a?f?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function or(a,f,g){return typeof a=="string"?(a=encodeURI(a).replace(f,Fw),g&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Fw(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Ch=/[#\/\?@]/g,Uw=/[#\?:]/g,$w=/[#\?]/g,Bw=/[#\?@]/g,qw=/#/g;function ar(a,f){this.h=this.g=null,this.i=a||null,this.j=!!f}function Pn(a){a.g||(a.g=new Map,a.h=0,a.i&&Ow(a.i,function(f,g){a.add(decodeURIComponent(f.replace(/\+/g," ")),g)}))}t=ar.prototype,t.add=function(a,f){Pn(this),this.i=null,a=os(this,a);let g=this.g.get(a);return g||this.g.set(a,g=[]),g.push(f),this.h+=1,this};function Rh(a,f){Pn(a),f=os(a,f),a.g.has(f)&&(a.i=null,a.h-=a.g.get(f).length,a.g.delete(f))}function kh(a,f){return Pn(a),f=os(a,f),a.g.has(f)}t.forEach=function(a,f){Pn(this),this.g.forEach(function(g,w){g.forEach(function(j){a.call(f,j,w,this)},this)},this)};function Dh(a,f){Pn(a);let g=[];if(typeof f=="string")kh(a,f)&&(g=g.concat(a.g.get(os(a,f))));else for(a=Array.from(a.g.values()),f=0;f<a.length;f++)g=g.concat(a[f]);return g}t.set=function(a,f){return Pn(this),this.i=null,a=os(this,a),kh(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[f]),this.h+=1,this},t.get=function(a,f){return a?(a=Dh(this,a),a.length>0?String(a[0]):f):f};function jh(a,f,g){Rh(a,f),g.length>0&&(a.i=null,a.g.set(os(a,f),y(g)),a.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],f=Array.from(this.g.keys());for(let w=0;w<f.length;w++){var g=f[w];const j=tr(g);g=Dh(this,g);for(let M=0;M<g.length;M++){let $=j;g[M]!==""&&($+="="+tr(g[M])),a.push($)}}return this.i=a.join("&")};function Vh(a){const f=new ar;return f.i=a.i,a.g&&(f.g=new Map(a.g),f.h=a.h),f}function os(a,f){return f=String(f),a.j&&(f=f.toLowerCase()),f}function Ww(a,f){f&&!a.j&&(Pn(a),a.i=null,a.g.forEach(function(g,w){const j=w.toLowerCase();w!=j&&(Rh(this,w),jh(this,j,g))},a)),a.j=f}function zw(a,f){const g=new er;if(o.Image){const w=new Image;w.onload=d(Xt,g,"TestLoadImage: loaded",!0,f,w),w.onerror=d(Xt,g,"TestLoadImage: error",!1,f,w),w.onabort=d(Xt,g,"TestLoadImage: abort",!1,f,w),w.ontimeout=d(Xt,g,"TestLoadImage: timeout",!1,f,w),o.setTimeout(function(){w.ontimeout&&w.ontimeout()},1e4),w.src=a}else f(!1)}function Hw(a,f){const g=new er,w=new AbortController,j=setTimeout(()=>{w.abort(),Xt(g,"TestPingServer: timeout",!1,f)},1e4);fetch(a,{signal:w.signal}).then(M=>{clearTimeout(j),M.ok?Xt(g,"TestPingServer: ok",!0,f):Xt(g,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(j),Xt(g,"TestPingServer: error",!1,f)})}function Xt(a,f,g,w,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),w(g)}catch{}}function Gw(){this.g=new Pw}function Pa(a){this.i=a.Sb||null,this.h=a.ab||!1}m(Pa,hh),Pa.prototype.g=function(){return new Si(this.i,this.h)};function Si(a,f){Be.call(this),this.H=a,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(Si,Be),t=Si.prototype,t.open=function(a,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=a,this.D=f,this.readyState=1,lr(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};a&&(f.body=a),(this.H||o).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,cr(this)),this.readyState=0},t.Pa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,lr(this)),this.g&&(this.readyState=3,lr(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Mh(this)}else a.text().then(this.Oa.bind(this),this.ga.bind(this))};function Mh(a){a.j.read().then(a.Ma.bind(a)).catch(a.ga.bind(a))}t.Ma=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var f=a.value?a.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!a.done}))&&(this.response=this.responseText+=f)}a.done?cr(this):lr(this),this.readyState==3&&Mh(this)}},t.Oa=function(a){this.g&&(this.response=this.responseText=a,cr(this))},t.Na=function(a){this.g&&(this.response=a,cr(this))},t.ga=function(){this.g&&cr(this)};function cr(a){a.readyState=4,a.l=null,a.j=null,a.B=null,lr(a)}t.setRequestHeader=function(a,f){this.A.append(a,f)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],f=this.h.entries();for(var g=f.next();!g.done;)g=g.value,a.push(g[0]+": "+g[1]),g=f.next();return a.join(`\r
`)};function lr(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Si.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Lh(a){let f="";return J(a,function(g,w){f+=w,f+=":",f+=g,f+=`\r
`}),f}function Ca(a,f,g){e:{for(w in g){var w=!1;break e}w=!0}w||(g=Lh(g),typeof a=="string"?g!=null&&tr(g):de(a,f,g))}function _e(a){Be.call(this),this.headers=new Map,this.L=a||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(_e,Be);var Kw=/^https?$/i,Qw=["POST","PUT"];t=_e.prototype,t.Fa=function(a){this.H=a},t.ea=function(a,f,g,w){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);f=f?f.toUpperCase():"GET",this.D=a,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():_h.g(),this.g.onreadystatechange=p(h(this.Ca,this));try{this.B=!0,this.g.open(f,String(a),!0),this.B=!1}catch(M){Oh(this,M);return}if(a=g||"",g=new Map(this.headers),w)if(Object.getPrototypeOf(w)===Object.prototype)for(var j in w)g.set(j,w[j]);else if(typeof w.keys=="function"&&typeof w.get=="function")for(const M of w.keys())g.set(M,w.get(M));else throw Error("Unknown input type for opt_headers: "+String(w));w=Array.from(g.keys()).find(M=>M.toLowerCase()=="content-type"),j=o.FormData&&a instanceof o.FormData,!(Array.prototype.indexOf.call(Qw,f,void 0)>=0)||w||j||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,$]of g)this.g.setRequestHeader(M,$);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(a),this.v=!1}catch(M){Oh(this,M)}};function Oh(a,f){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=f,a.o=5,Fh(a),Ni(a)}function Fh(a){a.A||(a.A=!0,Qe(a,"complete"),Qe(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=a||7,Qe(this,"complete"),Qe(this,"abort"),Ni(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ni(this,!0)),_e.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Uh(this):this.Xa())},t.Xa=function(){Uh(this)};function Uh(a){if(a.h&&typeof i<"u"){if(a.v&&Jt(a)==4)setTimeout(a.Ca.bind(a),0);else if(Qe(a,"readystatechange"),Jt(a)==4){a.h=!1;try{const M=a.ca();e:switch(M){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var g;if(!(g=f)){var w;if(w=M===0){let $=String(a.D).match(Ph)[1]||null;!$&&o.self&&o.self.location&&($=o.self.location.protocol.slice(0,-1)),w=!Kw.test($?$.toLowerCase():"")}g=w}if(g)Qe(a,"complete"),Qe(a,"success");else{a.o=6;try{var j=Jt(a)>2?a.g.statusText:""}catch{j=""}a.l=j+" ["+a.ca()+"]",Fh(a)}}finally{Ni(a)}}}}function Ni(a,f){if(a.g){a.m&&(clearTimeout(a.m),a.m=null);const g=a.g;a.g=null,f||Qe(a,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Jt(a){return a.g?a.g.readyState:0}t.ca=function(){try{return Jt(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(a){if(this.g){var f=this.g.responseText;return a&&f.indexOf(a)==0&&(f=f.substring(a.length)),Nw(f)}};function $h(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.F){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Yw(a){const f={};a=(a.g&&Jt(a)>=2&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let w=0;w<a.length;w++){if(_(a[w]))continue;var g=jw(a[w]);const j=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const M=f[j]||[];f[j]=M,M.push(g)}fe(f,function(w){return w.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ur(a,f,g){return g&&g.internalChannelParams&&g.internalChannelParams[a]||f}function Bh(a){this.za=0,this.i=[],this.j=new er,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ur("failFast",!1,a),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ur("baseRetryDelayMs",5e3,a),this.Za=ur("retryDelaySeedMs",1e4,a),this.Ta=ur("forwardChannelMaxRetries",2,a),this.va=ur("forwardChannelRequestTimeoutMs",2e4,a),this.ma=a&&a.xmlHttpFactory||void 0,this.Ua=a&&a.Rb||void 0,this.Aa=a&&a.useFetchStreams||!1,this.O=void 0,this.L=a&&a.supportsCrossDomainXhr||!1,this.M="",this.h=new Eh(a&&a.concurrentRequestLimit),this.Ba=new Gw,this.S=a&&a.fastHandshake||!1,this.R=a&&a.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=a&&a.Pb||!1,a&&a.ua&&this.j.ua(),a&&a.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&a&&a.detectBufferingProxy||!1,this.ia=void 0,a&&a.longPollingTimeout&&a.longPollingTimeout>0&&(this.ia=a.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Bh.prototype,t.ka=8,t.I=1,t.connect=function(a,f,g,w){Ye(0),this.W=a,this.H=f||{},g&&w!==void 0&&(this.H.OSID=g,this.H.OAID=w),this.F=this.X,this.J=Xh(this,null,this.W),Ci(this)};function Ra(a){if(qh(a),a.I==3){var f=a.V++,g=bt(a.J);if(de(g,"SID",a.M),de(g,"RID",f),de(g,"TYPE","terminate"),hr(a,g),f=new Qt(a,a.j,f),f.M=2,f.A=Ai(bt(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(f.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=f.A,g=!0),g||(f.g=Jh(f.j,null),f.g.ea(f.A)),f.F=Date.now(),Ii(f)}Yh(a)}function Pi(a){a.g&&(Da(a),a.g.cancel(),a.g=null)}function qh(a){Pi(a),a.v&&(o.clearTimeout(a.v),a.v=null),Ri(a),a.h.cancel(),a.m&&(typeof a.m=="number"&&o.clearTimeout(a.m),a.m=null)}function Ci(a){if(!Ih(a.h)&&!a.m){a.m=!0;var f=a.Ea;D||v(),V||(D(),V=!0),E.add(f,a),a.D=0}}function Xw(a,f){return Ah(a.h)>=a.h.j-(a.m?1:0)?!1:a.m?(a.i=f.G.concat(a.i),!0):a.I==1||a.I==2||a.D>=(a.Sa?0:a.Ta)?!1:(a.m=Zs(h(a.Ea,a,f),Qh(a,a.D)),a.D++,!0)}t.Ea=function(a){if(this.m)if(this.m=null,this.I==1){if(!a){this.V=Math.floor(Math.random()*1e5),a=this.V++;const j=new Qt(this,this.j,a);let M=this.o;if(this.U&&(M?(M=je(M),$e(M,this.U)):M=this.U),this.u!==null||this.R||(j.J=M,M=null),this.S)e:{for(var f=0,g=0;g<this.i.length;g++){t:{var w=this.i[g];if("__data__"in w.map&&(w=w.map.__data__,typeof w=="string")){w=w.length;break t}w=void 0}if(w===void 0)break;if(f+=w,f>4096){f=g;break e}if(f===4096||g===this.i.length-1){f=g+1;break e}}f=1e3}else f=1e3;f=zh(this,j,f),g=bt(this.J),de(g,"RID",a),de(g,"CVER",22),this.G&&de(g,"X-HTTP-Session-Id",this.G),hr(this,g),M&&(this.R?f="headers="+tr(Lh(M))+"&"+f:this.u&&Ca(g,this.u,M)),Sa(this.h,j),this.Ra&&de(g,"TYPE","init"),this.S?(de(g,"$req",f),de(g,"SID","null"),j.U=!0,Ta(j,g,null)):Ta(j,g,f),this.I=2}}else this.I==3&&(a?Wh(this,a):this.i.length==0||Ih(this.h)||Wh(this))};function Wh(a,f){var g;f?g=f.l:g=a.V++;const w=bt(a.J);de(w,"SID",a.M),de(w,"RID",g),de(w,"AID",a.K),hr(a,w),a.u&&a.o&&Ca(w,a.u,a.o),g=new Qt(a,a.j,g,a.D+1),a.u===null&&(g.J=a.o),f&&(a.i=f.G.concat(a.i)),f=zh(a,g,1e3),g.H=Math.round(a.va*.5)+Math.round(a.va*.5*Math.random()),Sa(a.h,g),Ta(g,w,f)}function hr(a,f){a.H&&J(a.H,function(g,w){de(f,w,g)}),a.l&&J({},function(g,w){de(f,w,g)})}function zh(a,f,g){g=Math.min(a.i.length,g);const w=a.l?h(a.l.Ka,a.l,a):null;e:{var j=a.i;let ee=-1;for(;;){const Ne=["count="+g];ee==-1?g>0?(ee=j[0].g,Ne.push("ofs="+ee)):ee=0:Ne.push("ofs="+ee);let le=!0;for(let ke=0;ke<g;ke++){var M=j[ke].g;const Tt=j[ke].map;if(M-=ee,M<0)ee=Math.max(0,j[ke].g-100),le=!1;else try{M="req"+M+"_"||"";try{var $=Tt instanceof Map?Tt:Object.entries(Tt);for(const[Rn,Zt]of $){let en=Zt;c(Zt)&&(en=_a(Zt)),Ne.push(M+Rn+"="+encodeURIComponent(en))}}catch(Rn){throw Ne.push(M+"type="+encodeURIComponent("_badmap")),Rn}}catch{w&&w(Tt)}}if(le){$=Ne.join("&");break e}}$=void 0}return a=a.i.splice(0,g),f.G=a,$}function Hh(a){if(!a.g&&!a.v){a.Y=1;var f=a.Da;D||v(),V||(D(),V=!0),E.add(f,a),a.A=0}}function ka(a){return a.g||a.v||a.A>=3?!1:(a.Y++,a.v=Zs(h(a.Da,a),Qh(a,a.A)),a.A++,!0)}t.Da=function(){if(this.v=null,Gh(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var a=4*this.T;this.j.info("BP detection timer enabled: "+a),this.B=Zs(h(this.Wa,this),a)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ye(10),Pi(this),Gh(this))};function Da(a){a.B!=null&&(o.clearTimeout(a.B),a.B=null)}function Gh(a){a.g=new Qt(a,a.j,"rpc",a.Y),a.u===null&&(a.g.J=a.o),a.g.P=0;var f=bt(a.na);de(f,"RID","rpc"),de(f,"SID",a.M),de(f,"AID",a.K),de(f,"CI",a.F?"0":"1"),!a.F&&a.ia&&de(f,"TO",a.ia),de(f,"TYPE","xmlhttp"),hr(a,f),a.u&&a.o&&Ca(f,a.u,a.o),a.O&&(a.g.H=a.O);var g=a.g;a=a.ba,g.M=1,g.A=Ai(bt(f)),g.u=null,g.R=!0,vh(g,a)}t.Va=function(){this.C!=null&&(this.C=null,Pi(this),ka(this),Ye(19))};function Ri(a){a.C!=null&&(o.clearTimeout(a.C),a.C=null)}function Kh(a,f){var g=null;if(a.g==f){Ri(a),Da(a),a.g=null;var w=2}else if(Aa(a.h,f))g=f.G,Sh(a.h,f),w=1;else return;if(a.I!=0){if(f.o)if(w==1){g=f.u?f.u.length:0,f=Date.now()-f.F;var j=a.D;w=Ti(),Qe(w,new gh(w,g)),Ci(a)}else Hh(a);else if(j=f.m,j==3||j==0&&f.X>0||!(w==1&&Xw(a,f)||w==2&&ka(a)))switch(g&&g.length>0&&(f=a.h,f.i=f.i.concat(g)),j){case 1:Cn(a,5);break;case 4:Cn(a,10);break;case 3:Cn(a,6);break;default:Cn(a,2)}}}function Qh(a,f){let g=a.Qa+Math.floor(Math.random()*a.Za);return a.isActive()||(g*=2),g*f}function Cn(a,f){if(a.j.info("Error code "+f),f==2){var g=h(a.bb,a),w=a.Ua;const j=!w;w=new Yt(w||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||sr(w,"https"),Ai(w),j?zw(w.toString(),g):Hw(w.toString(),g)}else Ye(2);a.I=0,a.l&&a.l.pa(f),Yh(a),qh(a)}t.bb=function(a){a?(this.j.info("Successfully pinged google.com"),Ye(2)):(this.j.info("Failed to ping google.com"),Ye(1))};function Yh(a){if(a.I=0,a.ja=[],a.l){const f=Nh(a.h);(f.length!=0||a.i.length!=0)&&(x(a.ja,f),x(a.ja,a.i),a.h.i.length=0,y(a.i),a.i.length=0),a.l.oa()}}function Xh(a,f,g){var w=g instanceof Yt?bt(g):new Yt(g);if(w.g!="")f&&(w.g=f+"."+w.g),rr(w,w.u);else{var j=o.location;w=j.protocol,f=f?f+"."+j.hostname:j.hostname,j=+j.port;const M=new Yt(null);w&&sr(M,w),f&&(M.g=f),j&&rr(M,j),g&&(M.h=g),w=M}return g=a.G,f=a.wa,g&&f&&de(w,g,f),de(w,"VER",a.ka),hr(a,w),w}function Jh(a,f,g){if(f&&!a.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=a.Aa&&!a.ma?new _e(new Pa({ab:g})):new _e(a.ma),f.Fa(a.L),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Zh(){}t=Zh.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function ki(){}ki.prototype.g=function(a,f){return new tt(a,f)};function tt(a,f){Be.call(this),this.g=new Bh(f),this.l=a,this.h=f&&f.messageUrlParams||null,a=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(a?a["X-WebChannel-Content-Type"]=f.messageContentType:a={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(a?a["X-WebChannel-Client-Profile"]=f.sa:a={"X-WebChannel-Client-Profile":f.sa}),this.g.U=a,(a=f&&f.Qb)&&!_(a)&&(this.g.u=a),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!_(f)&&(this.g.G=f,a=this.h,a!==null&&f in a&&(a=this.h,f in a&&delete a[f])),this.j=new as(this)}m(tt,Be),tt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},tt.prototype.close=function(){Ra(this.g)},tt.prototype.o=function(a){var f=this.g;if(typeof a=="string"){var g={};g.__data__=a,a=g}else this.v&&(g={},g.__data__=_a(a),a=g);f.i.push(new Lw(f.Ya++,a)),f.I==3&&Ci(f)},tt.prototype.N=function(){this.g.l=null,delete this.j,Ra(this.g),delete this.g,tt.Z.N.call(this)};function ed(a){wa.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var f=a.__sm__;if(f){e:{for(const g in f){a=g;break e}a=void 0}(this.i=a)&&(a=this.i,f=f!==null&&a in f?f[a]:void 0),this.data=f}else this.data=a}m(ed,wa);function td(){xa.call(this),this.status=1}m(td,xa);function as(a){this.g=a}m(as,Zh),as.prototype.ra=function(){Qe(this.g,"a")},as.prototype.qa=function(a){Qe(this.g,new ed(a))},as.prototype.pa=function(a){Qe(this.g,new td)},as.prototype.oa=function(){Qe(this.g,"b")},ki.prototype.createWebChannel=ki.prototype.g,tt.prototype.send=tt.prototype.o,tt.prototype.open=tt.prototype.m,tt.prototype.close=tt.prototype.close,E0=function(){return new ki},T0=function(){return Ti()},b0=Sn,Xc={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ei.NO_ERROR=0,Ei.TIMEOUT=8,Ei.HTTP_ERROR=6,no=Ei,yh.COMPLETE="complete",v0=yh,dh.EventType=Xs,Xs.OPEN="a",Xs.CLOSE="b",Xs.ERROR="c",Xs.MESSAGE="d",Be.prototype.listen=Be.prototype.J,wr=dh,_e.prototype.listenOnce=_e.prototype.K,_e.prototype.getLastError=_e.prototype.Ha,_e.prototype.getLastErrorCode=_e.prototype.ya,_e.prototype.getStatus=_e.prototype.ca,_e.prototype.getResponseJson=_e.prototype.La,_e.prototype.getResponseText=_e.prototype.la,_e.prototype.send=_e.prototype.ea,_e.prototype.setWithCredentials=_e.prototype.Fa,x0=_e}).apply(typeof Ui<"u"?Ui:typeof self<"u"?self:typeof window<"u"?window:{});const um="@firebase/firestore",hm="4.9.2";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}We.UNAUTHENTICATED=new We(null),We.GOOGLE_CREDENTIALS=new We("google-credentials-uid"),We.FIRST_PARTY=new We("first-party-uid"),We.MOCK_USER=new We("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zs="12.3.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wn=new Ho("@firebase/firestore");function cs(){return Wn.logLevel}function W(t,...e){if(Wn.logLevel<=ne.DEBUG){const n=e.map(xu);Wn.debug(`Firestore (${zs}): ${t}`,...n)}}function Gt(t,...e){if(Wn.logLevel<=ne.ERROR){const n=e.map(xu);Wn.error(`Firestore (${zs}): ${t}`,...n)}}function Ns(t,...e){if(Wn.logLevel<=ne.WARN){const n=e.map(xu);Wn.warn(`Firestore (${zs}): ${t}`,...n)}}function xu(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K(t,e,n){let s="Unexpected state";typeof e=="string"?s=e:n=e,I0(t,s,n)}function I0(t,e,n){let s=`FIRESTORE (${zs}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{s+=" CONTEXT: "+JSON.stringify(n)}catch{s+=" CONTEXT: "+n}throw Gt(s),new Error(s)}function ce(t,e,n,s){let r="Unexpected state";typeof n=="string"?r=n:s=n,t||I0(e,r,s)}function X(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class q extends vt{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class R2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(We.UNAUTHENTICATED))}shutdown(){}}class k2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class D2{constructor(e){this.t=e,this.currentUser=We.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ce(this.o===void 0,42304);let s=this.i;const r=l=>this.i!==s?(s=this.i,n(l)):Promise.resolve();let i=new fn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new fn,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await r(this.currentUser)})},c=l=>{W("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>c(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?c(l):(W("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new fn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(W("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(ce(typeof s.accessToken=="string",31837,{l:s}),new A0(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ce(e===null||typeof e=="string",2055,{h:e}),new We(e)}}class j2{constructor(e,n,s){this.P=e,this.T=n,this.I=s,this.type="FirstParty",this.user=We.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class V2{constructor(e,n,s){this.P=e,this.T=n,this.I=s}getToken(){return Promise.resolve(new j2(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(We.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class dm{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class M2{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,it(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ce(this.o===void 0,3512);const s=i=>{i.error!=null&&W("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,W("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{W("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?r(i):W("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new dm(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ce(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new dm(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vu{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let s="";for(;s.length<20;){const r=L2(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<n&&(s+=e.charAt(r[i]%62))}return s}}function se(t,e){return t<e?-1:t>e?1:0}function Jc(t,e){const n=Math.min(t.length,e.length);for(let s=0;s<n;s++){const r=t.charAt(s),i=e.charAt(s);if(r!==i)return oc(r)===oc(i)?se(r,i):oc(r)?1:-1}return se(t.length,e.length)}const O2=55296,F2=57343;function oc(t){const e=t.charCodeAt(0);return e>=O2&&e<=F2}function Ps(t,e,n){return t.length===e.length&&t.every((s,r)=>n(s,e[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fm="__name__";class Et{constructor(e,n,s){n===void 0?n=0:n>e.length&&K(637,{offset:n,range:e.length}),s===void 0?s=e.length-n:s>e.length-n&&K(1746,{length:s,range:e.length-n}),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return Et.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Et?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const i=Et.compareSegments(e.get(r),n.get(r));if(i!==0)return i}return se(e.length,n.length)}static compareSegments(e,n){const s=Et.isNumericId(e),r=Et.isNumericId(n);return s&&!r?-1:!s&&r?1:s&&r?Et.extractNumericId(e).compare(Et.extractNumericId(n)):Jc(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return dn.fromString(e.substring(4,e.length-2))}}class ue extends Et{construct(e,n,s){return new ue(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new q(F.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(r=>r.length>0))}return new ue(n)}static emptyPath(){return new ue([])}}const U2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Oe extends Et{construct(e,n,s){return new Oe(e,n,s)}static isValidIdentifier(e){return U2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Oe.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===fm}static keyField(){return new Oe([fm])}static fromServerFormat(e){const n=[];let s="",r=0;const i=()=>{if(s.length===0)throw new q(F.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let o=!1;for(;r<e.length;){const c=e[r];if(c==="\\"){if(r+1===e.length)throw new q(F.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[r+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new q(F.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=l,r+=2}else c==="`"?(o=!o,r++):c!=="."||o?(s+=c,r++):(i(),r++)}if(i(),o)throw new q(F.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Oe(n)}static emptyPath(){return new Oe([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.path=e}static fromPath(e){return new H(ue.fromString(e))}static fromName(e){return new H(ue.fromString(e).popFirst(5))}static empty(){return new H(ue.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ue.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ue.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new H(new ue(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S0(t,e,n){if(!n)throw new q(F.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function $2(t,e,n,s){if(e===!0&&s===!0)throw new q(F.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function mm(t){if(!H.isDocumentKey(t))throw new q(F.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function pm(t){if(H.isDocumentKey(t))throw new q(F.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function N0(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Xo(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":K(12329,{type:typeof t})}function Cs(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new q(F.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Xo(t);throw new q(F.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Se(t,e){const n={typeString:t};return e&&(n.value=e),n}function gi(t,e){if(!N0(t))throw new q(F.INVALID_ARGUMENT,"JSON must be an object");let n;for(const s in e)if(e[s]){const r=e[s].typeString,i="value"in e[s]?{value:e[s].value}:void 0;if(!(s in t)){n=`JSON missing required field: '${s}'`;break}const o=t[s];if(r&&typeof o!==r){n=`JSON field '${s}' must be a ${r}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${s}' field to equal '${i.value}'`;break}}if(n)throw new q(F.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gm=-62135596800,ym=1e6;class he{static now(){return he.fromMillis(Date.now())}static fromDate(e){return he.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor((e-1e3*n)*ym);return new he(n,s)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new q(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new q(F.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<gm)throw new q(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new q(F.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ym}_compareTo(e){return this.seconds===e.seconds?se(this.nanoseconds,e.nanoseconds):se(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:he._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(gi(e,he._jsonSchema))return new he(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-gm;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}he._jsonSchemaVersion="firestore/timestamp/1.0",he._jsonSchema={type:Se("string",he._jsonSchemaVersion),seconds:Se("number"),nanoseconds:Se("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y{static fromTimestamp(e){return new Y(e)}static min(){return new Y(new he(0,0))}static max(){return new Y(new he(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr=-1;function B2(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=Y.fromTimestamp(s===1e9?new he(n+1,0):new he(n,s));return new _n(r,H.empty(),e)}function q2(t){return new _n(t.readTime,t.key,Zr)}class _n{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new _n(Y.min(),H.empty(),Zr)}static max(){return new _n(Y.max(),H.empty(),Zr)}}function W2(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=H.comparator(t.documentKey,e.documentKey),n!==0?n:se(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class H2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hs(t){if(t.code!==F.FAILED_PRECONDITION||t.message!==z2)throw t;W("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&K(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new U((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(n,i).next(s,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof U?n:U.resolve(n)}catch(n){return U.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):U.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):U.reject(n)}static resolve(e){return new U((n,s)=>{n(e)})}static reject(e){return new U((n,s)=>{s(e)})}static waitFor(e){return new U((n,s)=>{let r=0,i=0,o=!1;e.forEach(c=>{++r,c.next(()=>{++i,o&&i===r&&n()},l=>s(l))}),o=!0,i===r&&n()})}static or(e){let n=U.resolve(!1);for(const s of e)n=n.next(r=>r?U.resolve(r):s());return n}static forEach(e,n){const s=[];return e.forEach((r,i)=>{s.push(n.call(this,r,i))}),this.waitFor(s)}static mapArray(e,n){return new U((s,r)=>{const i=e.length,o=new Array(i);let c=0;for(let l=0;l<i;l++){const h=l;n(e[h]).next(d=>{o[h]=d,++c,c===i&&s(o)},d=>r(d))}})}static doWhile(e,n){return new U((s,r)=>{const i=()=>{e()===!0?n().next(()=>{i()},r):s()};i()})}}function G2(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Gs(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jo{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.ae(s),this.ue=s=>n.writeSequenceNumber(s))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Jo.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bu=-1;function Zo(t){return t==null}function Io(t){return t===0&&1/t==-1/0}function K2(t){return typeof t=="number"&&Number.isInteger(t)&&!Io(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P0="";function Q2(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=_m(e)),e=Y2(t.get(n),e);return _m(e)}function Y2(t,e){let n=e;const s=t.length;for(let r=0;r<s;r++){const i=t.charAt(r);switch(i){case"\0":n+="";break;case P0:n+="";break;default:n+=i}}return n}function _m(t){return t+P0+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wm(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Jn(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function C0(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e,n){this.comparator=e,this.root=n||Le.EMPTY}insert(e,n){return new ye(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Le.BLACK,null,null))}remove(e){return new ye(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Le.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $i(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $i(this.root,e,this.comparator,!1)}getReverseIterator(){return new $i(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $i(this.root,e,this.comparator,!0)}}class $i{constructor(e,n,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?s(e.key,n):1,n&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Le{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s??Le.RED,this.left=r??Le.EMPTY,this.right=i??Le.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,i){return new Le(e??this.key,n??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Le.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return Le.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Le.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Le.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw K(43730,{key:this.key,value:this.value});if(this.right.isRed())throw K(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw K(27949);return e+(this.isRed()?0:1)}}Le.EMPTY=null,Le.RED=!0,Le.BLACK=!1;Le.EMPTY=new class{constructor(){this.size=0}get key(){throw K(57766)}get value(){throw K(16141)}get color(){throw K(16727)}get left(){throw K(29726)}get right(){throw K(36894)}copy(e,n,s,r,i){return this}insert(e,n,s){return new Le(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.comparator=e,this.data=new ye(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new xm(this.data.getIterator())}getIteratorFrom(e){return new xm(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof Re)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Re(this.comparator);return n.data=e,n}}class xm{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.fields=e,e.sort(Oe.comparator)}static empty(){return new mt([])}unionWith(e){let n=new Re(Oe.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new mt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ps(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new R0("Invalid base64 string: "+i):i}}(e);return new Ue(n)}static fromUint8Array(e){const n=function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i}(e);return new Ue(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return se(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ue.EMPTY_BYTE_STRING=new Ue("");const X2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wn(t){if(ce(!!t,39018),typeof t=="string"){let e=0;const n=X2.exec(t);if(ce(!!n,46558,{timestamp:t}),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:Te(t.seconds),nanos:Te(t.nanos)}}function Te(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function xn(t){return typeof t=="string"?Ue.fromBase64String(t):Ue.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0="server_timestamp",D0="__type__",j0="__previous_value__",V0="__local_write_time__";function Tu(t){var n,s;return((s=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[D0])==null?void 0:s.stringValue)===k0}function ea(t){const e=t.mapValue.fields[j0];return Tu(e)?ea(e):e}function ei(t){const e=wn(t.mapValue.fields[V0].timestampValue);return new he(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J2{constructor(e,n,s,r,i,o,c,l,h,d){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=l,this.useFetchStreams=h,this.isUsingEmulator=d}}const Ao="(default)";class ti{constructor(e,n){this.projectId=e,this.database=n||Ao}static empty(){return new ti("","")}get isDefaultDatabase(){return this.database===Ao}isEqual(e){return e instanceof ti&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M0="__type__",Z2="__max__",Bi={mapValue:{}},L0="__vector__",So="value";function vn(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Tu(t)?4:tC(t)?9007199254740991:eC(t)?10:11:K(28295,{value:t})}function Vt(t,e){if(t===e)return!0;const n=vn(t);if(n!==vn(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ei(t).isEqual(ei(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=wn(r.timestampValue),c=wn(i.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,i){return xn(r.bytesValue).isEqual(xn(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,i){return Te(r.geoPointValue.latitude)===Te(i.geoPointValue.latitude)&&Te(r.geoPointValue.longitude)===Te(i.geoPointValue.longitude)}(t,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return Te(r.integerValue)===Te(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=Te(r.doubleValue),c=Te(i.doubleValue);return o===c?Io(o)===Io(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return Ps(t.arrayValue.values||[],e.arrayValue.values||[],Vt);case 10:case 11:return function(r,i){const o=r.mapValue.fields||{},c=i.mapValue.fields||{};if(wm(o)!==wm(c))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(c[l]===void 0||!Vt(o[l],c[l])))return!1;return!0}(t,e);default:return K(52216,{left:t})}}function ni(t,e){return(t.values||[]).find(n=>Vt(n,e))!==void 0}function Rs(t,e){if(t===e)return 0;const n=vn(t),s=vn(e);if(n!==s)return se(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return se(t.booleanValue,e.booleanValue);case 2:return function(i,o){const c=Te(i.integerValue||i.doubleValue),l=Te(o.integerValue||o.doubleValue);return c<l?-1:c>l?1:c===l?0:isNaN(c)?isNaN(l)?0:-1:1}(t,e);case 3:return vm(t.timestampValue,e.timestampValue);case 4:return vm(ei(t),ei(e));case 5:return Jc(t.stringValue,e.stringValue);case 6:return function(i,o){const c=xn(i),l=xn(o);return c.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const c=i.split("/"),l=o.split("/");for(let h=0;h<c.length&&h<l.length;h++){const d=se(c[h],l[h]);if(d!==0)return d}return se(c.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const c=se(Te(i.latitude),Te(o.latitude));return c!==0?c:se(Te(i.longitude),Te(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return bm(t.arrayValue,e.arrayValue);case 10:return function(i,o){var p,y,x,P;const c=i.fields||{},l=o.fields||{},h=(p=c[So])==null?void 0:p.arrayValue,d=(y=l[So])==null?void 0:y.arrayValue,m=se(((x=h==null?void 0:h.values)==null?void 0:x.length)||0,((P=d==null?void 0:d.values)==null?void 0:P.length)||0);return m!==0?m:bm(h,d)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Bi.mapValue&&o===Bi.mapValue)return 0;if(i===Bi.mapValue)return 1;if(o===Bi.mapValue)return-1;const c=i.fields||{},l=Object.keys(c),h=o.fields||{},d=Object.keys(h);l.sort(),d.sort();for(let m=0;m<l.length&&m<d.length;++m){const p=Jc(l[m],d[m]);if(p!==0)return p;const y=Rs(c[l[m]],h[d[m]]);if(y!==0)return y}return se(l.length,d.length)}(t.mapValue,e.mapValue);default:throw K(23264,{he:n})}}function vm(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return se(t,e);const n=wn(t),s=wn(e),r=se(n.seconds,s.seconds);return r!==0?r:se(n.nanos,s.nanos)}function bm(t,e){const n=t.values||[],s=e.values||[];for(let r=0;r<n.length&&r<s.length;++r){const i=Rs(n[r],s[r]);if(i)return i}return se(n.length,s.length)}function ks(t){return Zc(t)}function Zc(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const s=wn(n);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return xn(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return H.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let s="[",r=!0;for(const i of n.values||[])r?r=!1:s+=",",s+=Zc(i);return s+"]"}(t.arrayValue):"mapValue"in t?function(n){const s=Object.keys(n.fields||{}).sort();let r="{",i=!0;for(const o of s)i?i=!1:r+=",",r+=`${o}:${Zc(n.fields[o])}`;return r+"}"}(t.mapValue):K(61005,{value:t})}function so(t){switch(vn(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ea(t);return e?16+so(e):16;case 5:return 2*t.stringValue.length;case 6:return xn(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(s){return(s.values||[]).reduce((r,i)=>r+so(i),0)}(t.arrayValue);case 10:case 11:return function(s){let r=0;return Jn(s.fields,(i,o)=>{r+=i.length+so(o)}),r}(t.mapValue);default:throw K(13486,{value:t})}}function Tm(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function el(t){return!!t&&"integerValue"in t}function Eu(t){return!!t&&"arrayValue"in t}function Em(t){return!!t&&"nullValue"in t}function Im(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ro(t){return!!t&&"mapValue"in t}function eC(t){var n,s;return((s=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[M0])==null?void 0:s.stringValue)===L0}function kr(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Jn(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=kr(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=kr(t.arrayValue.values[n]);return e}return{...t}}function tC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Z2}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(e){this.value=e}static empty(){return new ot({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!ro(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=kr(n)}setAll(e){let n=Oe.emptyPath(),s={},r=[];e.forEach((o,c)=>{if(!n.isImmediateParentOf(c)){const l=this.getFieldsMap(n);this.applyChanges(l,s,r),s={},r=[],n=c.popLast()}o?s[c.lastSegment()]=kr(o):r.push(c.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,s,r)}delete(e){const n=this.field(e.popLast());ro(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Vt(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];ro(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){Jn(n,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new ot(kr(this.value))}}function O0(t){const e=[];return Jn(t.fields,(n,s)=>{const r=new Oe([n]);if(ro(s)){const i=O0(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new mt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{constructor(e,n,s,r,i,o,c){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=c}static newInvalidDocument(e){return new ze(e,0,Y.min(),Y.min(),Y.min(),ot.empty(),0)}static newFoundDocument(e,n,s,r){return new ze(e,1,n,Y.min(),s,r,0)}static newNoDocument(e,n){return new ze(e,2,n,Y.min(),Y.min(),ot.empty(),0)}static newUnknownDocument(e,n){return new ze(e,3,n,Y.min(),Y.min(),ot.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Y.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ot.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ot.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Y.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ze&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ze(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class No{constructor(e,n){this.position=e,this.inclusive=n}}function Am(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const i=e[r],o=t.position[r];if(i.field.isKeyField()?s=H.comparator(H.fromName(o.referenceValue),n.key):s=Rs(o,n.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function Sm(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Vt(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,n="asc"){this.field=e,this.dir=n}}function nC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{}class Ae extends F0{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,s):new rC(e,n,s):n==="array-contains"?new aC(e,s):n==="in"?new cC(e,s):n==="not-in"?new lC(e,s):n==="array-contains-any"?new uC(e,s):new Ae(e,n,s)}static createKeyFieldInFilter(e,n,s){return n==="in"?new iC(e,s):new oC(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Rs(n,this.value)):n!==null&&vn(this.value)===vn(n)&&this.matchesComparison(Rs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return K(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class _t extends F0{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new _t(e,n)}matches(e){return U0(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function U0(t){return t.op==="and"}function $0(t){return sC(t)&&U0(t)}function sC(t){for(const e of t.filters)if(e instanceof _t)return!1;return!0}function tl(t){if(t instanceof Ae)return t.field.canonicalString()+t.op.toString()+ks(t.value);if($0(t))return t.filters.map(e=>tl(e)).join(",");{const e=t.filters.map(n=>tl(n)).join(",");return`${t.op}(${e})`}}function B0(t,e){return t instanceof Ae?function(s,r){return r instanceof Ae&&s.op===r.op&&s.field.isEqual(r.field)&&Vt(s.value,r.value)}(t,e):t instanceof _t?function(s,r){return r instanceof _t&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce((i,o,c)=>i&&B0(o,r.filters[c]),!0):!1}(t,e):void K(19439)}function q0(t){return t instanceof Ae?function(n){return`${n.field.canonicalString()} ${n.op} ${ks(n.value)}`}(t):t instanceof _t?function(n){return n.op.toString()+" {"+n.getFilters().map(q0).join(" ,")+"}"}(t):"Filter"}class rC extends Ae{constructor(e,n,s){super(e,n,s),this.key=H.fromName(s.referenceValue)}matches(e){const n=H.comparator(e.key,this.key);return this.matchesComparison(n)}}class iC extends Ae{constructor(e,n){super(e,"in",n),this.keys=W0("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class oC extends Ae{constructor(e,n){super(e,"not-in",n),this.keys=W0("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function W0(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(s=>H.fromName(s.referenceValue))}class aC extends Ae{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Eu(n)&&ni(n.arrayValue,this.value)}}class cC extends Ae{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ni(this.value.arrayValue,n)}}class lC extends Ae{constructor(e,n){super(e,"not-in",n)}matches(e){if(ni(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!ni(this.value.arrayValue,n)}}class uC extends Ae{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Eu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>ni(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(e,n=null,s=[],r=[],i=null,o=null,c=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=c,this.Te=null}}function Nm(t,e=null,n=[],s=[],r=null,i=null,o=null){return new hC(t,e,n,s,r,i,o)}function Iu(t){const e=X(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>tl(s)).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),Zo(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>ks(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>ks(s)).join(",")),e.Te=n}return e.Te}function Au(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!nC(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!B0(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Sm(t.startAt,e.startAt)&&Sm(t.endAt,e.endAt)}function nl(t){return H.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(e,n=null,s=[],r=[],i=null,o="F",c=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=c,this.endAt=l,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function dC(t,e,n,s,r,i,o,c){return new Ks(t,e,n,s,r,i,o,c)}function z0(t){return new Ks(t)}function Pm(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function H0(t){return t.collectionGroup!==null}function Dr(t){const e=X(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Re(Oe.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new si(i,s))}),n.has(Oe.keyField().canonicalString())||e.Ie.push(new si(Oe.keyField(),s))}return e.Ie}function Pt(t){const e=X(t);return e.Ee||(e.Ee=fC(e,Dr(t))),e.Ee}function fC(t,e){if(t.limitType==="F")return Nm(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new si(r.field,i)});const n=t.endAt?new No(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new No(t.startAt.position,t.startAt.inclusive):null;return Nm(t.path,t.collectionGroup,e,t.filters,t.limit,n,s)}}function sl(t,e){const n=t.filters.concat([e]);return new Ks(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function rl(t,e,n){return new Ks(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ta(t,e){return Au(Pt(t),Pt(e))&&t.limitType===e.limitType}function G0(t){return`${Iu(Pt(t))}|lt:${t.limitType}`}function ls(t){return`Query(target=${function(n){let s=n.path.canonicalString();return n.collectionGroup!==null&&(s+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(s+=`, filters: [${n.filters.map(r=>q0(r)).join(", ")}]`),Zo(n.limit)||(s+=", limit: "+n.limit),n.orderBy.length>0&&(s+=`, orderBy: [${n.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),n.startAt&&(s+=", startAt: ",s+=n.startAt.inclusive?"b:":"a:",s+=n.startAt.position.map(r=>ks(r)).join(",")),n.endAt&&(s+=", endAt: ",s+=n.endAt.inclusive?"a:":"b:",s+=n.endAt.position.map(r=>ks(r)).join(",")),`Target(${s})`}(Pt(t))}; limitType=${t.limitType})`}function na(t,e){return e.isFoundDocument()&&function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):H.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)}(t,e)&&function(s,r){for(const i of Dr(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(t,e)&&function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0}(t,e)&&function(s,r){return!(s.startAt&&!function(o,c,l){const h=Am(o,c,l);return o.inclusive?h<=0:h<0}(s.startAt,Dr(s),r)||s.endAt&&!function(o,c,l){const h=Am(o,c,l);return o.inclusive?h>=0:h>0}(s.endAt,Dr(s),r))}(t,e)}function mC(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function K0(t){return(e,n)=>{let s=!1;for(const r of Dr(t)){const i=pC(r,e,n);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function pC(t,e,n){const s=t.field.isKeyField()?H.comparator(e.key,n.key):function(i,o,c){const l=o.data.field(i),h=c.data.field(i);return l!==null&&h!==null?Rs(l,h):K(42886)}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return K(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Jn(this.inner,(n,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return C0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gC=new ye(H.comparator);function Kt(){return gC}const Q0=new ye(H.comparator);function xr(...t){let e=Q0;for(const n of t)e=e.insert(n.key,n);return e}function Y0(t){let e=Q0;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function Fn(){return jr()}function X0(){return jr()}function jr(){return new Zn(t=>t.toString(),(t,e)=>t.isEqual(e))}const yC=new ye(H.comparator),_C=new Re(H.comparator);function re(...t){let e=_C;for(const n of t)e=e.add(n);return e}const wC=new Re(se);function xC(){return wC}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Su(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Io(e)?"-0":e}}function J0(t){return{integerValue:""+t}}function vC(t,e){return K2(e)?J0(e):Su(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa{constructor(){this._=void 0}}function bC(t,e,n){return t instanceof Po?function(r,i){const o={fields:{[D0]:{stringValue:k0},[V0]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&Tu(i)&&(i=ea(i)),i&&(o.fields[j0]=i),{mapValue:o}}(n,e):t instanceof ri?e_(t,e):t instanceof ii?t_(t,e):function(r,i){const o=Z0(r,i),c=Cm(o)+Cm(r.Ae);return el(o)&&el(r.Ae)?J0(c):Su(r.serializer,c)}(t,e)}function TC(t,e,n){return t instanceof ri?e_(t,e):t instanceof ii?t_(t,e):n}function Z0(t,e){return t instanceof Co?function(s){return el(s)||function(i){return!!i&&"doubleValue"in i}(s)}(e)?e:{integerValue:0}:null}class Po extends sa{}class ri extends sa{constructor(e){super(),this.elements=e}}function e_(t,e){const n=n_(e);for(const s of t.elements)n.some(r=>Vt(r,s))||n.push(s);return{arrayValue:{values:n}}}class ii extends sa{constructor(e){super(),this.elements=e}}function t_(t,e){let n=n_(e);for(const s of t.elements)n=n.filter(r=>!Vt(r,s));return{arrayValue:{values:n}}}class Co extends sa{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function Cm(t){return Te(t.integerValue||t.doubleValue)}function n_(t){return Eu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function EC(t,e){return t.field.isEqual(e.field)&&function(s,r){return s instanceof ri&&r instanceof ri||s instanceof ii&&r instanceof ii?Ps(s.elements,r.elements,Vt):s instanceof Co&&r instanceof Co?Vt(s.Ae,r.Ae):s instanceof Po&&r instanceof Po}(t.transform,e.transform)}class IC{constructor(e,n){this.version=e,this.transformResults=n}}class Ct{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ct}static exists(e){return new Ct(void 0,e)}static updateTime(e){return new Ct(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function io(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ra{}function s_(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Nu(t.key,Ct.none()):new yi(t.key,t.data,Ct.none());{const n=t.data,s=ot.empty();let r=new Re(Oe.comparator);for(let i of e.fields)if(!r.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new es(t.key,s,new mt(r.toArray()),Ct.none())}}function AC(t,e,n){t instanceof yi?function(r,i,o){const c=r.value.clone(),l=km(r.fieldTransforms,i,o.transformResults);c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):t instanceof es?function(r,i,o){if(!io(r.precondition,i))return void i.convertToUnknownDocument(o.version);const c=km(r.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(r_(r)),l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Vr(t,e,n,s){return t instanceof yi?function(i,o,c,l){if(!io(i.precondition,o))return c;const h=i.value.clone(),d=Dm(i.fieldTransforms,l,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(t,e,n,s):t instanceof es?function(i,o,c,l){if(!io(i.precondition,o))return c;const h=Dm(i.fieldTransforms,l,o),d=o.data;return d.setAll(r_(i)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),c===null?null:c.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,s):function(i,o,c){return io(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,n)}function SC(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),i=Z0(s.transform,r||null);i!=null&&(n===null&&(n=ot.empty()),n.set(s.field,i))}return n||null}function Rm(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&Ps(s,r,(i,o)=>EC(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class yi extends ra{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class es extends ra{constructor(e,n,s,r,i=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function r_(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function km(t,e,n){const s=new Map;ce(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let r=0;r<n.length;r++){const i=t[r],o=i.transform,c=e.data.field(i.field);s.set(i.field,TC(o,c,n[r]))}return s}function Dm(t,e,n){const s=new Map;for(const r of t){const i=r.transform,o=n.data.field(r.field);s.set(r.field,bC(i,o,e))}return s}class Nu extends ra{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class NC extends ra{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&AC(i,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=Vr(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=Vr(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=X0();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let c=this.applyToLocalView(o,i.mutatedFields);c=n.has(r.key)?null:c;const l=s_(o,c);l!==null&&s.set(r.key,l),o.isValidDocument()||o.convertToNoDocument(Y.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),re())}isEqual(e){return this.batchId===e.batchId&&Ps(this.mutations,e.mutations,(n,s)=>Rm(n,s))&&Ps(this.baseMutations,e.baseMutations,(n,s)=>Rm(n,s))}}class Pu{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){ce(e.mutations.length===s.length,58842,{me:e.mutations.length,fe:s.length});let r=function(){return yC}();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new Pu(e,n,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ee,ie;function kC(t){switch(t){case F.OK:return K(64938);case F.CANCELLED:case F.UNKNOWN:case F.DEADLINE_EXCEEDED:case F.RESOURCE_EXHAUSTED:case F.INTERNAL:case F.UNAVAILABLE:case F.UNAUTHENTICATED:return!1;case F.INVALID_ARGUMENT:case F.NOT_FOUND:case F.ALREADY_EXISTS:case F.PERMISSION_DENIED:case F.FAILED_PRECONDITION:case F.ABORTED:case F.OUT_OF_RANGE:case F.UNIMPLEMENTED:case F.DATA_LOSS:return!0;default:return K(15467,{code:t})}}function i_(t){if(t===void 0)return Gt("GRPC error has no .code"),F.UNKNOWN;switch(t){case Ee.OK:return F.OK;case Ee.CANCELLED:return F.CANCELLED;case Ee.UNKNOWN:return F.UNKNOWN;case Ee.DEADLINE_EXCEEDED:return F.DEADLINE_EXCEEDED;case Ee.RESOURCE_EXHAUSTED:return F.RESOURCE_EXHAUSTED;case Ee.INTERNAL:return F.INTERNAL;case Ee.UNAVAILABLE:return F.UNAVAILABLE;case Ee.UNAUTHENTICATED:return F.UNAUTHENTICATED;case Ee.INVALID_ARGUMENT:return F.INVALID_ARGUMENT;case Ee.NOT_FOUND:return F.NOT_FOUND;case Ee.ALREADY_EXISTS:return F.ALREADY_EXISTS;case Ee.PERMISSION_DENIED:return F.PERMISSION_DENIED;case Ee.FAILED_PRECONDITION:return F.FAILED_PRECONDITION;case Ee.ABORTED:return F.ABORTED;case Ee.OUT_OF_RANGE:return F.OUT_OF_RANGE;case Ee.UNIMPLEMENTED:return F.UNIMPLEMENTED;case Ee.DATA_LOSS:return F.DATA_LOSS;default:return K(39323,{code:t})}}(ie=Ee||(Ee={}))[ie.OK=0]="OK",ie[ie.CANCELLED=1]="CANCELLED",ie[ie.UNKNOWN=2]="UNKNOWN",ie[ie.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ie[ie.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ie[ie.NOT_FOUND=5]="NOT_FOUND",ie[ie.ALREADY_EXISTS=6]="ALREADY_EXISTS",ie[ie.PERMISSION_DENIED=7]="PERMISSION_DENIED",ie[ie.UNAUTHENTICATED=16]="UNAUTHENTICATED",ie[ie.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ie[ie.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ie[ie.ABORTED=10]="ABORTED",ie[ie.OUT_OF_RANGE=11]="OUT_OF_RANGE",ie[ie.UNIMPLEMENTED=12]="UNIMPLEMENTED",ie[ie.INTERNAL=13]="INTERNAL",ie[ie.UNAVAILABLE=14]="UNAVAILABLE",ie[ie.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DC(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC=new dn([4294967295,4294967295],0);function jm(t){const e=DC().encode(t),n=new w0;return n.update(e),new Uint8Array(n.digest())}function Vm(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new dn([n,s],0),new dn([r,i],0)]}class Cu{constructor(e,n,s){if(this.bitmap=e,this.padding=n,this.hashCount=s,n<0||n>=8)throw new vr(`Invalid padding: ${n}`);if(s<0)throw new vr(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new vr(`Invalid hash count: ${s}`);if(e.length===0&&n!==0)throw new vr(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=dn.fromNumber(this.ge)}ye(e,n,s){let r=e.add(n.multiply(dn.fromNumber(s)));return r.compare(jC)===1&&(r=new dn([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=jm(e),[s,r]=Vm(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);if(!this.we(o))return!1}return!0}static create(e,n,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Cu(i,r,n);return s.forEach(c=>o.insert(c)),o}insert(e){if(this.ge===0)return;const n=jm(e),[s,r]=Vm(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(s,r,i);this.Se(o)}}Se(e){const n=Math.floor(e/8),s=e%8;this.bitmap[n]|=1<<s}}class vr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e,n,s,r,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,s){const r=new Map;return r.set(e,_i.createSynthesizedTargetChangeForCurrentChange(e,n,s)),new ia(Y.min(),r,new ye(se),Kt(),re())}}class _i{constructor(e,n,s,r,i){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,s){return new _i(s,n,re(),re(),re())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e,n,s,r){this.be=e,this.removedTargetIds=n,this.key=s,this.De=r}}class o_{constructor(e,n){this.targetId=e,this.Ce=n}}class a_{constructor(e,n,s=Ue.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class Mm{constructor(){this.ve=0,this.Fe=Lm(),this.Me=Ue.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=re(),n=re(),s=re();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:K(38017,{changeType:i})}}),new _i(this.Me,this.xe,e,n,s)}qe(){this.Oe=!1,this.Fe=Lm()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ce(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class VC{constructor(e){this.Ge=e,this.ze=new Map,this.je=Kt(),this.Je=qi(),this.He=qi(),this.Ye=new ye(se)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const s=this.nt(n);switch(e.state){case 0:this.rt(n)&&s.Le(e.resumeToken);break;case 1:s.Ke(),s.Ne||s.qe(),s.Le(e.resumeToken);break;case 2:s.Ke(),s.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(s.We(),s.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),s.Le(e.resumeToken));break;default:K(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((s,r)=>{this.rt(r)&&n(r)})}st(e){const n=e.targetId,s=e.Ce.count,r=this.ot(n);if(r){const i=r.target;if(nl(i))if(s===0){const o=new H(i.path);this.et(n,o,ze.newNoDocument(o,Y.min()))}else ce(s===1,20013,{expectedCount:s});else{const o=this._t(n);if(o!==s){const c=this.ut(e),l=c?this.ct(c,e,o):1;if(l!==0){this.it(n);const h=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,h)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=n;let o,c;try{o=xn(s).toUint8Array()}catch(l){if(l instanceof R0)return Ns("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{c=new Cu(o,r,i)}catch(l){return Ns(l instanceof vr?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return c.ge===0?null:c}ct(e,n,s){return n.Ce.count===s-this.Pt(e,n.targetId)?0:2}Pt(e,n){const s=this.Ge.getRemoteKeysForTarget(n);let r=0;return s.forEach(i=>{const o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(c)||(this.et(n,i,null),r++)}),r}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const c=this.ot(o);if(c){if(i.current&&nl(c.target)){const l=new H(c.target.path);this.It(l).has(o)||this.Et(o,l)||this.et(o,l,ze.newNoDocument(l,e))}i.Be&&(n.set(o,i.ke()),i.qe())}});let s=re();this.He.forEach((i,o)=>{let c=!0;o.forEachWhile(l=>{const h=this.ot(l);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(s=s.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const r=new ia(e,n,this.Ye,this.je,s);return this.je=Kt(),this.Je=qi(),this.He=qi(),this.Ye=new ye(se),r}Xe(e,n){if(!this.rt(e))return;const s=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,s),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,s){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,n)?r.Qe(n,1):r.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),s&&(this.je=this.je.insert(n,s))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Mm,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new Re(se),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new Re(se),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||W("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Mm),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function qi(){return new ye(H.comparator)}function Lm(){return new ye(H.comparator)}const MC={asc:"ASCENDING",desc:"DESCENDING"},LC={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},OC={and:"AND",or:"OR"};class FC{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function il(t,e){return t.useProto3Json||Zo(e)?e:{value:e}}function Ro(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function c_(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function UC(t,e){return Ro(t,e.toTimestamp())}function Rt(t){return ce(!!t,49232),Y.fromTimestamp(function(n){const s=wn(n);return new he(s.seconds,s.nanos)}(t))}function Ru(t,e){return ol(t,e).canonicalString()}function ol(t,e){const n=function(r){return new ue(["projects",r.projectId,"databases",r.database])}(t).child("documents");return e===void 0?n:n.child(e)}function l_(t){const e=ue.fromString(t);return ce(m_(e),10190,{key:e.toString()}),e}function al(t,e){return Ru(t.databaseId,e.path)}function ac(t,e){const n=l_(e);if(n.get(1)!==t.databaseId.projectId)throw new q(F.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new q(F.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new H(h_(n))}function u_(t,e){return Ru(t.databaseId,e)}function $C(t){const e=l_(t);return e.length===4?ue.emptyPath():h_(e)}function cl(t){return new ue(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function h_(t){return ce(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Om(t,e,n){return{name:al(t,e),fields:n.value.mapValue.fields}}function BC(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:K(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(h,d){return h.useProto3Json?(ce(d===void 0||typeof d=="string",58123),Ue.fromBase64String(d||"")):(ce(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Ue.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(h){const d=h.code===void 0?F.UNKNOWN:i_(h.code);return new q(d,h.message||"")}(o);n=new a_(s,r,i,c||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=ac(t,s.document.name),i=Rt(s.document.updateTime),o=s.document.createTime?Rt(s.document.createTime):Y.min(),c=new ot({mapValue:{fields:s.document.fields}}),l=ze.newFoundDocument(r,i,o,c),h=s.targetIds||[],d=s.removedTargetIds||[];n=new oo(h,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=ac(t,s.document),i=s.readTime?Rt(s.readTime):Y.min(),o=ze.newNoDocument(r,i),c=s.removedTargetIds||[];n=new oo([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=ac(t,s.document),i=s.removedTargetIds||[];n=new oo([],i,r,null)}else{if(!("filter"in e))return K(11601,{Rt:e});{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,o=new RC(r,i),c=s.targetId;n=new o_(c,o)}}return n}function qC(t,e){let n;if(e instanceof yi)n={update:Om(t,e.key,e.value)};else if(e instanceof Nu)n={delete:al(t,e.key)};else if(e instanceof es)n={update:Om(t,e.key,e.data),updateMask:JC(e.fieldMask)};else{if(!(e instanceof NC))return K(16599,{Vt:e.type});n={verify:al(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(i,o){const c=o.transform;if(c instanceof Po)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof ri)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof ii)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Co)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw K(20930,{transform:o.transform})}(0,s))),e.precondition.isNone||(n.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:UC(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:K(27497)}(t,e.precondition)),n}function WC(t,e){return t&&t.length>0?(ce(e!==void 0,14353),t.map(n=>function(r,i){let o=r.updateTime?Rt(r.updateTime):Rt(i);return o.isEqual(Y.min())&&(o=Rt(i)),new IC(o,r.transformResults||[])}(n,e))):[]}function zC(t,e){return{documents:[u_(t,e.path)]}}function HC(t,e){const n={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),n.structuredQuery.from=[{collectionId:s.lastSegment()}]),n.parent=u_(t,r);const i=function(h){if(h.length!==0)return f_(_t.create(h,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(h){if(h.length!==0)return h.map(d=>function(p){return{field:us(p.field),direction:QC(p.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const c=il(t,e.limit);return c!==null&&(n.structuredQuery.limit=c),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{ft:n,parent:r}}function GC(t){let e=$C(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){ce(s===1,65062);const d=n.from[0];d.allDescendants?r=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(m){const p=d_(m);return p instanceof _t&&$0(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(p=>function(x){return new si(hs(x.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(x.direction))}(p))}(n.orderBy));let c=null;n.limit&&(c=function(m){let p;return p=typeof m=="object"?m.value:m,Zo(p)?null:p}(n.limit));let l=null;n.startAt&&(l=function(m){const p=!!m.before,y=m.values||[];return new No(y,p)}(n.startAt));let h=null;return n.endAt&&(h=function(m){const p=!m.before,y=m.values||[];return new No(y,p)}(n.endAt)),dC(e,r,o,i,c,"F",l,h)}function KC(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return K(28987,{purpose:r})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function d_(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const s=hs(n.unaryFilter.field);return Ae.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=hs(n.unaryFilter.field);return Ae.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=hs(n.unaryFilter.field);return Ae.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=hs(n.unaryFilter.field);return Ae.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return K(61313);default:return K(60726)}}(t):t.fieldFilter!==void 0?function(n){return Ae.create(hs(n.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return K(58110);default:return K(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return _t.create(n.compositeFilter.filters.map(s=>d_(s)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return K(1026)}}(n.compositeFilter.op))}(t):K(30097,{filter:t})}function QC(t){return MC[t]}function YC(t){return LC[t]}function XC(t){return OC[t]}function us(t){return{fieldPath:t.canonicalString()}}function hs(t){return Oe.fromServerFormat(t.fieldPath)}function f_(t){return t instanceof Ae?function(n){if(n.op==="=="){if(Im(n.value))return{unaryFilter:{field:us(n.field),op:"IS_NAN"}};if(Em(n.value))return{unaryFilter:{field:us(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Im(n.value))return{unaryFilter:{field:us(n.field),op:"IS_NOT_NAN"}};if(Em(n.value))return{unaryFilter:{field:us(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:us(n.field),op:YC(n.op),value:n.value}}}(t):t instanceof _t?function(n){const s=n.getFilters().map(r=>f_(r));return s.length===1?s[0]:{compositeFilter:{op:XC(n.op),filters:s}}}(t):K(54877,{filter:t})}function JC(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function m_(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e,n,s,r,i=Y.min(),o=Y.min(),c=Ue.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=l}withSequenceNumber(e){return new an(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new an(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new an(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new an(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e){this.yt=e}}function eR(t){const e=GC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?rl(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tR{constructor(){this.Cn=new nR}addToCollectionParentIndex(e,n){return this.Cn.add(n),U.resolve()}getCollectionParents(e,n){return U.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return U.resolve()}deleteFieldIndex(e,n){return U.resolve()}deleteAllFieldIndexes(e){return U.resolve()}createTargetIndexes(e,n){return U.resolve()}getDocumentsMatchingTarget(e,n){return U.resolve(null)}getIndexType(e,n){return U.resolve(0)}getFieldIndexes(e,n){return U.resolve([])}getNextCollectionGroupToUpdate(e){return U.resolve(null)}getMinOffset(e,n){return U.resolve(_n.min())}getMinOffsetFromCollectionGroup(e,n){return U.resolve(_n.min())}updateCollectionGroup(e,n,s){return U.resolve()}updateIndexEntries(e,n){return U.resolve()}}class nR{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new Re(ue.comparator),i=!r.has(s);return this.index[n]=r.add(s),i}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Re(ue.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fm={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},p_=41943040;class Je{static withCacheSize(e){return new Je(e,Je.DEFAULT_COLLECTION_PERCENTILE,Je.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Je.DEFAULT_COLLECTION_PERCENTILE=10,Je.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Je.DEFAULT=new Je(p_,Je.DEFAULT_COLLECTION_PERCENTILE,Je.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Je.DISABLED=new Je(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ds{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Ds(0)}static cr(){return new Ds(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Um="LruGarbageCollector",sR=1048576;function $m([t,e],[n,s]){const r=se(t,n);return r===0?se(e,s):r}class rR{constructor(e){this.Ir=e,this.buffer=new Re($m),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();$m(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class iR{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){W(Um,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Gs(n)?W(Um,"Ignoring IndexedDB error during garbage collection: ",n):await Hs(n)}await this.Vr(3e5)})}}class oR{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next(s=>Math.floor(n/100*s))}nthSequenceNumber(e,n){if(n===0)return U.resolve(Jo.ce);const s=new rR(n);return this.mr.forEachTarget(e,r=>s.Ar(r.sequenceNumber)).next(()=>this.mr.pr(e,r=>s.Ar(r))).next(()=>s.maxValue)}removeTargets(e,n,s){return this.mr.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(W("LruGarbageCollector","Garbage collection skipped; disabled"),U.resolve(Fm)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(W("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Fm):this.yr(e,n))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let s,r,i,o,c,l,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(W("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),r=this.params.maximumSequenceNumbersToCollect):r=m,o=Date.now(),this.nthSequenceNumber(e,r))).next(m=>(s=m,c=Date.now(),this.removeTargets(e,s,n))).next(m=>(i=m,l=Date.now(),this.removeOrphanedDocuments(e,s))).next(m=>(h=Date.now(),cs()<=ne.DEBUG&&W("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${r} in `+(c-o)+`ms
	Removed ${i} targets in `+(l-c)+`ms
	Removed ${m} documents in `+(h-l)+`ms
Total Duration: ${h-d}ms`),U.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:m})))}}function aR(t,e){return new oR(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(){this.changes=new Zn(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ze.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?U.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lR{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uR{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,n))).next(r=>(s!==null&&Vr(s.mutation,r,mt.empty(),he.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,re()).next(()=>s))}getLocalViewOfDocuments(e,n,s=re()){const r=Fn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,s).next(i=>{let o=xr();return i.forEach((c,l)=>{o=o.insert(c,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const s=Fn();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,re()))}populateOverlays(e,n,s){const r=[];return s.forEach(i=>{n.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,c)=>{n.set(o,c)})})}computeViews(e,n,s,r){let i=Kt();const o=jr(),c=function(){return jr()}();return n.forEach((l,h)=>{const d=s.get(h.key);r.has(h.key)&&(d===void 0||d.mutation instanceof es)?i=i.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),Vr(d.mutation,h,d.mutation.getFieldMask(),he.now())):o.set(h.key,mt.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((h,d)=>o.set(h,d)),n.forEach((h,d)=>c.set(h,new lR(d,o.get(h)??null))),c))}recalculateAndSaveOverlays(e,n){const s=jr();let r=new ye((o,c)=>o-c),i=re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const c of o)c.keys().forEach(l=>{const h=n.get(l);if(h===null)return;let d=s.get(l)||mt.empty();d=c.applyToLocalView(h,d),s.set(l,d);const m=(r.get(c.batchId)||re()).add(l);r=r.insert(c.batchId,m)})}).next(()=>{const o=[],c=r.getReverseIterator();for(;c.hasNext();){const l=c.getNext(),h=l.key,d=l.value,m=X0();d.forEach(p=>{if(!i.has(p)){const y=s_(n.get(p),s.get(p));y!==null&&m.set(p,y),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return U.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s,r){return function(o){return H.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):H0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s,r):this.getDocumentsMatchingCollectionQuery(e,n,s,r)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-i.size):U.resolve(Fn());let c=Zr,l=i;return o.next(h=>U.forEach(h,(d,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),i.get(d)?U.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,h,i)).next(()=>this.computeViews(e,l,h,re())).next(d=>({batchId:c,changes:Y0(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new H(n)).next(s=>{let r=xr();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,s,r){const i=n.collectionGroup;let o=xr();return this.indexManager.getCollectionParents(e,i).next(c=>U.forEach(c,l=>{const h=function(m,p){return new Ks(p,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,h,s,r).next(d=>{d.forEach((m,p)=>{o=o.insert(m,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,s,i,r))).next(o=>{i.forEach((l,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,ze.newInvalidDocument(d)))});let c=xr();return o.forEach((l,h)=>{const d=i.get(l);d!==void 0&&Vr(d.mutation,h,mt.empty(),he.now()),na(n,h)&&(c=c.insert(l,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return U.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:Rt(r.createTime)}}(n)),U.resolve()}getNamedQuery(e,n){return U.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,function(r){return{name:r.name,query:eR(r.bundledQuery),readTime:Rt(r.readTime)}}(n)),U.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dR{constructor(){this.overlays=new ye(H.comparator),this.qr=new Map}getOverlay(e,n){return U.resolve(this.overlays.get(n))}getOverlays(e,n){const s=Fn();return U.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((r,i)=>{this.St(e,n,i)}),U.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.qr.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.qr.delete(s)),U.resolve()}getOverlaysForCollection(e,n,s){const r=Fn(),i=n.length+1,o=new H(n.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const l=c.getNext().value,h=l.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===i&&l.largestBatchId>s&&r.set(l.getKey(),l)}return U.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let i=new ye((h,d)=>h-d);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>s){let d=i.get(h.largestBatchId);d===null&&(d=Fn(),i=i.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const c=Fn(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((h,d)=>c.set(h,d)),!(c.size()>=r)););return U.resolve(c)}St(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.qr.get(r.largestBatchId).delete(s.key);this.qr.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new CC(n,s));let i=this.qr.get(n);i===void 0&&(i=re(),this.qr.set(n,i)),this.qr.set(n,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fR{constructor(){this.sessionToken=Ue.EMPTY_BYTE_STRING}getSessionToken(e){return U.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,U.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(){this.Qr=new Re(De.$r),this.Ur=new Re(De.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const s=new De(e,n);this.Qr=this.Qr.add(s),this.Ur=this.Ur.add(s)}Wr(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.Gr(new De(e,n))}zr(e,n){e.forEach(s=>this.removeReference(s,n))}jr(e){const n=new H(new ue([])),s=new De(n,e),r=new De(n,e+1),i=[];return this.Ur.forEachInRange([s,r],o=>{this.Gr(o),i.push(o.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new H(new ue([])),s=new De(n,e),r=new De(n,e+1);let i=re();return this.Ur.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new De(e,0),s=this.Qr.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class De{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return H.comparator(e.key,n.key)||se(e.Yr,n.Yr)}static Kr(e,n){return se(e.Yr,n.Yr)||H.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new Re(De.$r)}checkEmpty(e){return U.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new PC(i,n,s,r);this.mutationQueue.push(o);for(const c of r)this.Zr=this.Zr.add(new De(c.key,i)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return U.resolve(o)}lookupMutationBatch(e,n){return U.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.ei(s),i=r<0?0:r;return U.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return U.resolve(this.mutationQueue.length===0?bu:this.tr-1)}getAllMutationBatches(e){return U.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new De(n,0),r=new De(n,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([s,r],o=>{const c=this.Xr(o.Yr);i.push(c)}),U.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new Re(se);return n.forEach(r=>{const i=new De(r,0),o=new De(r,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([i,o],c=>{s=s.add(c.Yr)})}),U.resolve(this.ti(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let i=s;H.isDocumentKey(i)||(i=i.child(""));const o=new De(new H(i),0);let c=new Re(se);return this.Zr.forEachWhile(l=>{const h=l.key.path;return!!s.isPrefixOf(h)&&(h.length===r&&(c=c.add(l.Yr)),!0)},o),U.resolve(this.ti(c))}ti(e){const n=[];return e.forEach(s=>{const r=this.Xr(s);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){ce(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let s=this.Zr;return U.forEach(n.mutations,r=>{const i=new De(r.key,n.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=s})}ir(e){}containsKey(e,n){const s=new De(n,0),r=this.Zr.firstAfterOrEqual(s);return U.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,U.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR{constructor(e){this.ri=e,this.docs=function(){return new ye(H.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),i=r?r.size:0,o=this.ri(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return U.resolve(s?s.document.mutableCopy():ze.newInvalidDocument(n))}getEntries(e,n){let s=Kt();return n.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():ze.newInvalidDocument(r))}),U.resolve(s)}getDocumentsMatchingQuery(e,n,s,r){let i=Kt();const o=n.path,c=new H(o.child("__id-9223372036854775808__")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){const{key:h,value:{document:d}}=l.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||W2(q2(d),s)<=0||(r.has(d.key)||na(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return U.resolve(i)}getAllFromCollectionGroup(e,n,s,r){K(9500)}ii(e,n){return U.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new gR(this)}getSize(e){return U.resolve(this.size)}}class gR extends cR{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?n.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(s)}),U.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e){this.persistence=e,this.si=new Zn(n=>Iu(n),Au),this.lastRemoteSnapshotVersion=Y.min(),this.highestTargetId=0,this.oi=0,this._i=new ku,this.targetCount=0,this.ai=Ds.ur()}forEachTarget(e,n){return this.si.forEach((s,r)=>n(r)),U.resolve()}getLastRemoteSnapshotVersion(e){return U.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return U.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),U.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.oi&&(this.oi=n),U.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Ds(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,U.resolve()}updateTargetData(e,n){return this.Pr(n),U.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,U.resolve()}removeTargets(e,n,s){let r=0;const i=[];return this.si.forEach((o,c)=>{c.sequenceNumber<=n&&s.get(c.targetId)===null&&(this.si.delete(o),i.push(this.removeMatchingKeysForTargetId(e,c.targetId)),r++)}),U.waitFor(i).next(()=>r)}getTargetCount(e){return U.resolve(this.targetCount)}getTargetData(e,n){const s=this.si.get(n)||null;return U.resolve(s)}addMatchingKeys(e,n,s){return this._i.Wr(n,s),U.resolve()}removeMatchingKeys(e,n,s){this._i.zr(n,s);const r=this.persistence.referenceDelegate,i=[];return r&&n.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),U.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),U.resolve()}getMatchingKeysForTargetId(e,n){const s=this._i.Hr(n);return U.resolve(s)}containsKey(e,n){return U.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_{constructor(e,n){this.ui={},this.overlays={},this.ci=new Jo(0),this.li=!1,this.li=!0,this.hi=new fR,this.referenceDelegate=e(this),this.Pi=new yR(this),this.indexManager=new tR,this.remoteDocumentCache=function(r){return new pR(r)}(s=>this.referenceDelegate.Ti(s)),this.serializer=new ZC(n),this.Ii=new hR(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new dR,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.ui[e.toKey()];return s||(s=new mR(n,this.referenceDelegate),this.ui[e.toKey()]=s),s}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,s){W("MemoryPersistence","Starting transaction:",e);const r=new _R(this.ci.next());return this.referenceDelegate.Ei(),s(r).next(i=>this.referenceDelegate.di(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ai(e,n){return U.or(Object.values(this.ui).map(s=>()=>s.containsKey(e,n)))}}class _R extends H2{constructor(e){super(),this.currentSequenceNumber=e}}class Du{constructor(e){this.persistence=e,this.Ri=new ku,this.Vi=null}static mi(e){return new Du(e)}get fi(){if(this.Vi)return this.Vi;throw K(60996)}addReference(e,n,s){return this.Ri.addReference(s,n),this.fi.delete(s.toString()),U.resolve()}removeReference(e,n,s){return this.Ri.removeReference(s,n),this.fi.add(s.toString()),U.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),U.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach(r=>this.fi.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(i=>this.fi.add(i.toString()))}).next(()=>s.removeTargetData(e,n))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return U.forEach(this.fi,s=>{const r=H.fromPath(s);return this.gi(e,r).next(i=>{i||n.removeEntry(r,Y.min())})}).next(()=>(this.Vi=null,n.apply(e)))}updateLimboDocument(e,n){return this.gi(e,n).next(s=>{s?this.fi.delete(n.toString()):this.fi.add(n.toString())})}Ti(e){return 0}gi(e,n){return U.or([()=>U.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class ko{constructor(e,n){this.persistence=e,this.pi=new Zn(s=>Q2(s.path),(s,r)=>s.isEqual(r)),this.garbageCollector=aR(this,n)}static mi(e,n){return new ko(e,n)}Ei(){}di(e){return U.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(s=>n.next(r=>s+r))}wr(e){let n=0;return this.pr(e,s=>{n++}).next(()=>n)}pr(e,n){return U.forEach(this.pi,(s,r)=>this.br(e,s,r).next(i=>i?U.resolve():n(r)))}removeTargets(e,n,s){return this.persistence.getTargetCache().removeTargets(e,n,s)}removeOrphanedDocuments(e,n){let s=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,o=>this.br(e,o,n).next(c=>{c||(s++,i.removeEntry(o,Y.min()))})).next(()=>i.apply(e)).next(()=>s)}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),U.resolve()}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,s)}addReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),U.resolve()}removeReference(e,n,s){return this.pi.set(s,e.currentSequenceNumber),U.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),U.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=so(e.data.value)),n}br(e,n,s){return U.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const r=this.pi.get(n);return U.resolve(r!==void 0&&r>s)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.Es=s,this.ds=r}static As(e,n){let s=re(),r=re();for(const i of n.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new ju(e,n.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xR{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return YA()?8:G2(Ge())>0?6:4}()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,s,r){const i={result:null};return this.ys(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ws(e,n,r,s).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new wR;return this.Ss(e,n,o).next(c=>{if(i.result=c,this.Vs)return this.bs(e,n,o,c.size)})}).next(()=>i.result)}bs(e,n,s,r){return s.documentReadCount<this.fs?(cs()<=ne.DEBUG&&W("QueryEngine","SDK will not create cache indexes for query:",ls(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),U.resolve()):(cs()<=ne.DEBUG&&W("QueryEngine","Query:",ls(n),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.gs*r?(cs()<=ne.DEBUG&&W("QueryEngine","The SDK decides to create cache indexes for query:",ls(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Pt(n))):U.resolve())}ys(e,n){if(Pm(n))return U.resolve(null);let s=Pt(n);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=rl(n,null,"F"),s=Pt(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=re(...i);return this.ps.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,s).next(l=>{const h=this.Ds(n,c);return this.Cs(n,h,o,l.readTime)?this.ys(e,rl(n,null,"F")):this.vs(e,h,n,l)}))})))}ws(e,n,s,r){return Pm(n)||r.isEqual(Y.min())?U.resolve(null):this.ps.getDocuments(e,s).next(i=>{const o=this.Ds(n,i);return this.Cs(n,o,s,r)?U.resolve(null):(cs()<=ne.DEBUG&&W("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),ls(n)),this.vs(e,o,n,B2(r,Zr)).next(c=>c))})}Ds(e,n){let s=new Re(K0(e));return n.forEach((r,i)=>{na(e,i)&&(s=s.add(i))}),s}Cs(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,n,s){return cs()<=ne.DEBUG&&W("QueryEngine","Using full collection scan to execute query:",ls(n)),this.ps.getDocumentsMatchingQuery(e,n,_n.min(),s)}vs(e,n,s,r){return this.ps.getDocumentsMatchingQuery(e,s,r).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vu="LocalStore",vR=3e8;class bR{constructor(e,n,s,r){this.persistence=e,this.Fs=n,this.serializer=r,this.Ms=new ye(se),this.xs=new Zn(i=>Iu(i),Au),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(s)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new uR(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ms))}}function TR(t,e,n,s){return new bR(t,e,n,s)}async function y_(t,e){const n=X(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,n.Bs(e),n.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],c=[];let l=re();for(const h of r){o.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}for(const h of i){c.push(h.batchId);for(const d of h.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(s,l).next(h=>({Ls:h,removedBatchIds:o,addedBatchIds:c}))})})}function ER(t,e){const n=X(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(c,l,h,d){const m=h.batch,p=m.keys();let y=U.resolve();return p.forEach(x=>{y=y.next(()=>d.getEntry(l,x)).next(P=>{const C=h.docVersions.get(x);ce(C!==null,48541),P.version.compareTo(C)<0&&(m.applyToRemoteDocument(P,h),P.isValidDocument()&&(P.setReadTime(h.commitVersion),d.addEntry(P)))})}),y.next(()=>c.mutationQueue.removeMutationBatch(l,m))}(n,s,e,i).next(()=>i.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(c){let l=re();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(l=l.add(c.batch.mutations[h].key));return l}(e))).next(()=>n.localDocuments.getDocuments(s,r))})}function __(t){const e=X(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Pi.getLastRemoteSnapshotVersion(n))}function IR(t,e){const n=X(t),s=e.snapshotVersion;let r=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ns.newChangeBuffer({trackRemovals:!0});r=n.Ms;const c=[];e.targetChanges.forEach((d,m)=>{const p=r.get(m);if(!p)return;c.push(n.Pi.removeMatchingKeys(i,d.removedDocuments,m).next(()=>n.Pi.addMatchingKeys(i,d.addedDocuments,m)));let y=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?y=y.withResumeToken(Ue.EMPTY_BYTE_STRING,Y.min()).withLastLimboFreeSnapshotVersion(Y.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,s)),r=r.insert(m,y),function(P,C,S){return P.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=vR?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(p,y,d)&&c.push(n.Pi.updateTargetData(i,y))});let l=Kt(),h=re();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&c.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),c.push(AR(i,o,e.documentUpdates).next(d=>{l=d.ks,h=d.qs})),!s.isEqual(Y.min())){const d=n.Pi.getLastRemoteSnapshotVersion(i).next(m=>n.Pi.setTargetsMetadata(i,i.currentSequenceNumber,s));c.push(d)}return U.waitFor(c).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,l,h)).next(()=>l)}).then(i=>(n.Ms=r,i))}function AR(t,e,n){let s=re(),r=re();return n.forEach(i=>s=s.add(i)),e.getEntries(t,s).next(i=>{let o=Kt();return n.forEach((c,l)=>{const h=i.get(c);l.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(c)),l.isNoDocument()&&l.version.isEqual(Y.min())?(e.removeEntry(c,l.readTime),o=o.insert(c,l)):!h.isValidDocument()||l.version.compareTo(h.version)>0||l.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(l),o=o.insert(c,l)):W(Vu,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",l.version)}),{ks:o,qs:r}})}function SR(t,e){const n=X(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=bu),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function NR(t,e){const n=X(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return n.Pi.getTargetData(s,e).next(i=>i?(r=i,U.resolve(r)):n.Pi.allocateTargetId(s).next(o=>(r=new an(e,o,"TargetPurposeListen",s.currentSequenceNumber),n.Pi.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=n.Ms.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(s.targetId,s),n.xs.set(e,s.targetId)),s})}async function ll(t,e,n){const s=X(t),r=s.Ms.get(e),i=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!Gs(o))throw o;W(Vu,`Failed to update sequence numbers for target ${e}: ${o}`)}s.Ms=s.Ms.remove(e),s.xs.delete(r.target)}function Bm(t,e,n){const s=X(t);let r=Y.min(),i=re();return s.persistence.runTransaction("Execute query","readwrite",o=>function(l,h,d){const m=X(l),p=m.xs.get(d);return p!==void 0?U.resolve(m.Ms.get(p)):m.Pi.getTargetData(h,d)}(s,o,Pt(e)).next(c=>{if(c)return r=c.lastLimboFreeSnapshotVersion,s.Pi.getMatchingKeysForTargetId(o,c.targetId).next(l=>{i=l})}).next(()=>s.Fs.getDocumentsMatchingQuery(o,e,n?r:Y.min(),n?i:re())).next(c=>(PR(s,mC(e),c),{documents:c,Qs:i})))}function PR(t,e,n){let s=t.Os.get(e)||Y.min();n.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),t.Os.set(e,s)}class qm{constructor(){this.activeTargetIds=xC()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class CR{constructor(){this.Mo=new qm,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,s){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new qm,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RR{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wm="ConnectivityMonitor";class zm{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){W(Wm,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){W(Wm,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Wi=null;function ul(){return Wi===null?Wi=function(){return 268435456+Math.round(2147483648*Math.random())}():Wi++,"0x"+Wi.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cc="RestConnection",kR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class DR{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${s}/databases/${r}`,this.Wo=this.databaseId.database===Ao?`project_id=${s}`:`project_id=${s}&database_id=${r}`}Go(e,n,s,r,i){const o=ul(),c=this.zo(e,n.toUriEncodedString());W(cc,`Sending RPC '${e}' ${o}:`,c,s);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,r,i);const{host:h}=new URL(c),d=Bs(h);return this.Jo(e,c,l,s,d).then(m=>(W(cc,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Ns(cc,`RPC '${e}' ${o} failed with error: `,m,"url: ",c,"request:",s),m})}Ho(e,n,s,r,i,o){return this.Go(e,n,s,r,i)}jo(e,n,s){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+zs}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}zo(e,n){const s=kR[e];return`${this.Uo}/v1/${n}:${s}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jR{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qe="WebChannelConnection";class VR extends DR{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,s,r,i){const o=ul();return new Promise((c,l)=>{const h=new x0;h.setWithCredentials(!0),h.listenOnce(v0.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case no.NO_ERROR:const m=h.getResponseJson();W(qe,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),c(m);break;case no.TIMEOUT:W(qe,`RPC '${e}' ${o} timed out`),l(new q(F.DEADLINE_EXCEEDED,"Request time out"));break;case no.HTTP_ERROR:const p=h.getStatus();if(W(qe,`RPC '${e}' ${o} failed with status:`,p,"response text:",h.getResponseText()),p>0){let y=h.getResponseJson();Array.isArray(y)&&(y=y[0]);const x=y==null?void 0:y.error;if(x&&x.status&&x.message){const P=function(S){const T=S.toLowerCase().replace(/_/g,"-");return Object.values(F).indexOf(T)>=0?T:F.UNKNOWN}(x.status);l(new q(P,x.message))}else l(new q(F.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new q(F.UNAVAILABLE,"Connection failed."));break;default:K(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{W(qe,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(r);W(qe,`RPC '${e}' ${o} sending request:`,r),h.send(n,"POST",d,s,15)})}T_(e,n,s){const r=ul(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=E0(),c=T0(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(l.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(l.useFetchStreams=!0),this.jo(l.initMessageHeaders,n,s),l.encodeInitMessageHeaders=!0;const d=i.join("");W(qe,`Creating RPC '${e}' stream ${r}: ${d}`,l);const m=o.createWebChannel(d,l);this.I_(m);let p=!1,y=!1;const x=new jR({Yo:C=>{y?W(qe,`Not sending because RPC '${e}' stream ${r} is closed:`,C):(p||(W(qe,`Opening RPC '${e}' stream ${r} transport.`),m.open(),p=!0),W(qe,`RPC '${e}' stream ${r} sending:`,C),m.send(C))},Zo:()=>m.close()}),P=(C,S,T)=>{C.listen(S,k=>{try{T(k)}catch(L){setTimeout(()=>{throw L},0)}})};return P(m,wr.EventType.OPEN,()=>{y||(W(qe,`RPC '${e}' stream ${r} transport opened.`),x.o_())}),P(m,wr.EventType.CLOSE,()=>{y||(y=!0,W(qe,`RPC '${e}' stream ${r} transport closed`),x.a_(),this.E_(m))}),P(m,wr.EventType.ERROR,C=>{y||(y=!0,Ns(qe,`RPC '${e}' stream ${r} transport errored. Name:`,C.name,"Message:",C.message),x.a_(new q(F.UNAVAILABLE,"The operation could not be completed")))}),P(m,wr.EventType.MESSAGE,C=>{var S;if(!y){const T=C.data[0];ce(!!T,16349);const k=T,L=(k==null?void 0:k.error)||((S=k[0])==null?void 0:S.error);if(L){W(qe,`RPC '${e}' stream ${r} received error:`,L);const D=L.status;let V=function(I){const N=Ee[I];if(N!==void 0)return i_(N)}(D),E=L.message;V===void 0&&(V=F.INTERNAL,E="Unknown error status: "+D+" with message "+L.message),y=!0,x.a_(new q(V,E)),m.close()}else W(qe,`RPC '${e}' stream ${r} received:`,T),x.u_(T)}}),P(c,b0.STAT_EVENT,C=>{C.stat===Xc.PROXY?W(qe,`RPC '${e}' stream ${r} detected buffering proxy`):C.stat===Xc.NOPROXY&&W(qe,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{x.__()},0),x}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(n=>n===e)}}function lc(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oa(t){return new FC(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e,n,s=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=n,this.d_=s,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),s=Math.max(0,Date.now()-this.f_),r=Math.max(0,n-s);r>0&&W("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hm="PersistentStream";class x_{constructor(e,n,s,r,i,o,c,l){this.Mi=e,this.S_=s,this.b_=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=l,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new w_(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===F.RESOURCE_EXHAUSTED?(Gt(n.toString()),Gt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===F.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.D_===n&&this.G_(s,r)},s=>{e(()=>{const r=new q(F.UNKNOWN,"Fetching auth token failed: "+s.message);return this.z_(r)})})}G_(e,n){const s=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo(()=>{s(()=>this.listener.Xo())}),this.stream.t_(()=>{s(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(r=>{s(()=>this.z_(r))}),this.stream.onMessage(r=>{s(()=>++this.F_==1?this.J_(r):this.onNext(r))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return W(Hm,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget(()=>this.D_===e?n():(W(Hm,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class MR extends x_{constructor(e,n,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=BC(this.serializer,e),s=function(i){if(!("targetChange"in i))return Y.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Y.min():o.readTime?Rt(o.readTime):Y.min()}(e);return this.listener.H_(n,s)}Y_(e){const n={};n.database=cl(this.serializer),n.addTarget=function(i,o){let c;const l=o.target;if(c=nl(l)?{documents:zC(i,l)}:{query:HC(i,l).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=c_(i,o.resumeToken);const h=il(i,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(Y.min())>0){c.readTime=Ro(i,o.snapshotVersion.toTimestamp());const h=il(i,o.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const s=KC(this.serializer,e);s&&(n.labels=s),this.q_(n)}Z_(e){const n={};n.database=cl(this.serializer),n.removeTarget=e,this.q_(n)}}class LR extends x_{constructor(e,n,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,o),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ce(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ce(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ce(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=WC(e.writeResults,e.commitTime),s=Rt(e.commitTime);return this.listener.na(s,n)}ra(){const e={};e.database=cl(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>qC(this.serializer,s))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{}class FR extends OR{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=s,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new q(F.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Go(e,ol(n,s),r,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new q(F.UNKNOWN,i.toString())})}Ho(e,n,s,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Ho(e,ol(n,s),r,o,c,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===F.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new q(F.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class UR{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Gt(n),this.aa=!1):W("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zn="RemoteStore";class $R{constructor(e,n,s,r,i){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(o=>{s.enqueueAndForget(async()=>{ts(this)&&(W(zn,"Restarting streams for network reachability change."),await async function(l){const h=X(l);h.Ea.add(4),await wi(h),h.Ra.set("Unknown"),h.Ea.delete(4),await aa(h)}(this))})}),this.Ra=new UR(s,r)}}async function aa(t){if(ts(t))for(const e of t.da)await e(!0)}async function wi(t){for(const e of t.da)await e(!1)}function v_(t,e){const n=X(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Fu(n)?Ou(n):Qs(n).O_()&&Lu(n,e))}function Mu(t,e){const n=X(t),s=Qs(n);n.Ia.delete(e),s.O_()&&b_(n,e),n.Ia.size===0&&(s.O_()?s.L_():ts(n)&&n.Ra.set("Unknown"))}function Lu(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Y.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Qs(t).Y_(e)}function b_(t,e){t.Va.Ue(e),Qs(t).Z_(e)}function Ou(t){t.Va=new VC({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Qs(t).start(),t.Ra.ua()}function Fu(t){return ts(t)&&!Qs(t).x_()&&t.Ia.size>0}function ts(t){return X(t).Ea.size===0}function T_(t){t.Va=void 0}async function BR(t){t.Ra.set("Online")}async function qR(t){t.Ia.forEach((e,n)=>{Lu(t,e)})}async function WR(t,e){T_(t),Fu(t)?(t.Ra.ha(e),Ou(t)):t.Ra.set("Unknown")}async function zR(t,e,n){if(t.Ra.set("Online"),e instanceof a_&&e.state===2&&e.cause)try{await async function(r,i){const o=i.cause;for(const c of i.targetIds)r.Ia.has(c)&&(await r.remoteSyncer.rejectListen(c,o),r.Ia.delete(c),r.Va.removeTarget(c))}(t,e)}catch(s){W(zn,"Failed to remove targets %s: %s ",e.targetIds.join(","),s),await Do(t,s)}else if(e instanceof oo?t.Va.Ze(e):e instanceof o_?t.Va.st(e):t.Va.tt(e),!n.isEqual(Y.min()))try{const s=await __(t.localStore);n.compareTo(s)>=0&&await function(i,o){const c=i.Va.Tt(o);return c.targetChanges.forEach((l,h)=>{if(l.resumeToken.approximateByteSize()>0){const d=i.Ia.get(h);d&&i.Ia.set(h,d.withResumeToken(l.resumeToken,o))}}),c.targetMismatches.forEach((l,h)=>{const d=i.Ia.get(l);if(!d)return;i.Ia.set(l,d.withResumeToken(Ue.EMPTY_BYTE_STRING,d.snapshotVersion)),b_(i,l);const m=new an(d.target,l,h,d.sequenceNumber);Lu(i,m)}),i.remoteSyncer.applyRemoteEvent(c)}(t,n)}catch(s){W(zn,"Failed to raise snapshot:",s),await Do(t,s)}}async function Do(t,e,n){if(!Gs(e))throw e;t.Ea.add(1),await wi(t),t.Ra.set("Offline"),n||(n=()=>__(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{W(zn,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await aa(t)})}function E_(t,e){return e().catch(n=>Do(t,n,e))}async function ca(t){const e=X(t),n=bn(e);let s=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:bu;for(;HR(e);)try{const r=await SR(e.localStore,s);if(r===null){e.Ta.length===0&&n.L_();break}s=r.batchId,GR(e,r)}catch(r){await Do(e,r)}I_(e)&&A_(e)}function HR(t){return ts(t)&&t.Ta.length<10}function GR(t,e){t.Ta.push(e);const n=bn(t);n.O_()&&n.X_&&n.ea(e.mutations)}function I_(t){return ts(t)&&!bn(t).x_()&&t.Ta.length>0}function A_(t){bn(t).start()}async function KR(t){bn(t).ra()}async function QR(t){const e=bn(t);for(const n of t.Ta)e.ea(n.mutations)}async function YR(t,e,n){const s=t.Ta.shift(),r=Pu.from(s,e,n);await E_(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await ca(t)}async function XR(t,e){e&&bn(t).X_&&await async function(s,r){if(function(o){return kC(o)&&o!==F.ABORTED}(r.code)){const i=s.Ta.shift();bn(s).B_(),await E_(s,()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r)),await ca(s)}}(t,e),I_(t)&&A_(t)}async function Gm(t,e){const n=X(t);n.asyncQueue.verifyOperationInProgress(),W(zn,"RemoteStore received new credentials");const s=ts(n);n.Ea.add(3),await wi(n),s&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await aa(n)}async function JR(t,e){const n=X(t);e?(n.Ea.delete(2),await aa(n)):e||(n.Ea.add(2),await wi(n),n.Ra.set("Unknown"))}function Qs(t){return t.ma||(t.ma=function(n,s,r){const i=X(n);return i.sa(),new MR(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Xo:BR.bind(null,t),t_:qR.bind(null,t),r_:WR.bind(null,t),H_:zR.bind(null,t)}),t.da.push(async e=>{e?(t.ma.B_(),Fu(t)?Ou(t):t.Ra.set("Unknown")):(await t.ma.stop(),T_(t))})),t.ma}function bn(t){return t.fa||(t.fa=function(n,s,r){const i=X(n);return i.sa(),new LR(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:KR.bind(null,t),r_:XR.bind(null,t),ta:QR.bind(null,t),na:YR.bind(null,t)}),t.da.push(async e=>{e?(t.fa.B_(),await ca(t)):(await t.fa.stop(),t.Ta.length>0&&(W(zn,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e,n,s,r,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new fn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,s,r,i){const o=Date.now()+s,c=new Uu(e,n,o,r,i);return c.start(s),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new q(F.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function $u(t,e){if(Gt("AsyncQueue",`${e}: ${t}`),Gs(t))return new q(F.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{static emptySet(e){return new bs(e.comparator)}constructor(e){this.comparator=e?(n,s)=>e(n,s)||H.comparator(n.key,s.key):(n,s)=>H.comparator(n.key,s.key),this.keyedMap=xr(),this.sortedSet=new ye(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof bs)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new bs;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(){this.ga=new ye(H.comparator)}track(e){const n=e.doc.key,s=this.ga.get(n);s?e.type!==0&&s.type===3?this.ga=this.ga.insert(n,e):e.type===3&&s.type!==1?this.ga=this.ga.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.ga=this.ga.remove(n):e.type===1&&s.type===2?this.ga=this.ga.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):K(63341,{Rt:e,pa:s}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,s)=>{e.push(s)}),e}}class js{constructor(e,n,s,r,i,o,c,l,h){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=l,this.hasCachedResults=h}static fromInitialDocuments(e,n,s,r,i){const o=[];return n.forEach(c=>{o.push({type:0,doc:c})}),new js(e,n,bs.emptySet(n),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ta(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class ek{constructor(){this.queries=Qm(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,s){const r=X(n),i=r.queries;r.queries=Qm(),i.forEach((o,c)=>{for(const l of c.Sa)l.onError(s)})})(this,new q(F.ABORTED,"Firestore shutting down"))}}function Qm(){return new Zn(t=>G0(t),ta)}async function tk(t,e){const n=X(t);let s=3;const r=e.query;let i=n.queries.get(r);i?!i.ba()&&e.Da()&&(s=2):(i=new ZR,s=e.Da()?0:1);try{switch(s){case 0:i.wa=await n.onListen(r,!0);break;case 1:i.wa=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(o){const c=$u(o,`Initialization of query '${ls(e.query)}' failed`);return void e.onError(c)}n.queries.set(r,i),i.Sa.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&Bu(n)}async function nk(t,e){const n=X(t),s=e.query;let r=3;const i=n.queries.get(s);if(i){const o=i.Sa.indexOf(e);o>=0&&(i.Sa.splice(o,1),i.Sa.length===0?r=e.Da()?0:1:!i.ba()&&e.Da()&&(r=2))}switch(r){case 0:return n.queries.delete(s),n.onUnlisten(s,!0);case 1:return n.queries.delete(s),n.onUnlisten(s,!1);case 2:return n.onLastRemoteStoreUnlisten(s);default:return}}function sk(t,e){const n=X(t);let s=!1;for(const r of e){const i=r.query,o=n.queries.get(i);if(o){for(const c of o.Sa)c.Fa(r)&&(s=!0);o.wa=r}}s&&Bu(n)}function rk(t,e,n){const s=X(t),r=s.queries.get(e);if(r)for(const i of r.Sa)i.onError(n);s.queries.delete(e)}function Bu(t){t.Ca.forEach(e=>{e.next()})}var hl,Ym;(Ym=hl||(hl={})).Ma="default",Ym.Cache="cache";class ik{constructor(e,n,s){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=s||{}}Fa(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new js(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const s=n!=="Offline";return(!this.options.qa||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=js.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==hl.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_{constructor(e){this.key=e}}class N_{constructor(e){this.key=e}}class ok{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=re(),this.mutatedKeys=re(),this.eu=K0(e),this.tu=new bs(this.eu)}get nu(){return this.Ya}ru(e,n){const s=n?n.iu:new Km,r=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=r,c=!1;const l=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((d,m)=>{const p=r.get(d),y=na(this.query,m)?m:null,x=!!p&&this.mutatedKeys.has(p.key),P=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let C=!1;p&&y?p.data.isEqual(y.data)?x!==P&&(s.track({type:3,doc:y}),C=!0):this.su(p,y)||(s.track({type:2,doc:y}),C=!0,(l&&this.eu(y,l)>0||h&&this.eu(y,h)<0)&&(c=!0)):!p&&y?(s.track({type:0,doc:y}),C=!0):p&&!y&&(s.track({type:1,doc:p}),C=!0,(l||h)&&(c=!0)),C&&(y?(o=o.add(y),i=P?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),s.track({type:1,doc:d})}return{tu:o,iu:s,Cs:c,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((d,m)=>function(y,x){const P=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return K(20277,{Rt:C})}};return P(y)-P(x)}(d.type,m.type)||this.eu(d.doc,m.doc)),this.ou(s),r=r??!1;const c=n&&!r?this._u():[],l=this.Xa.size===0&&this.current&&!r?1:0,h=l!==this.Za;return this.Za=l,o.length!==0||h?{snapshot:new js(this.query,e.tu,i,o,e.mutatedKeys,l===0,h,!1,!!s&&s.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Km,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Ya=this.Ya.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ya=this.Ya.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=re(),this.tu.forEach(s=>{this.uu(s.key)&&(this.Xa=this.Xa.add(s.key))});const n=[];return e.forEach(s=>{this.Xa.has(s)||n.push(new N_(s))}),this.Xa.forEach(s=>{e.has(s)||n.push(new S_(s))}),n}cu(e){this.Ya=e.Qs,this.Xa=re();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return js.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const qu="SyncEngine";class ak{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class ck{constructor(e){this.key=e,this.hu=!1}}class lk{constructor(e,n,s,r,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Zn(c=>G0(c),ta),this.Iu=new Map,this.Eu=new Set,this.du=new ye(H.comparator),this.Au=new Map,this.Ru=new ku,this.Vu={},this.mu=new Map,this.fu=Ds.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function uk(t,e,n=!0){const s=j_(t);let r;const i=s.Tu.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.lu()):r=await P_(s,e,n,!0),r}async function hk(t,e){const n=j_(t);await P_(n,e,!0,!1)}async function P_(t,e,n,s){const r=await NR(t.localStore,Pt(e)),i=r.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let c;return s&&(c=await dk(t,e,i,o==="current",r.resumeToken)),t.isPrimaryClient&&n&&v_(t.remoteStore,r),c}async function dk(t,e,n,s,r){t.pu=(m,p,y)=>async function(P,C,S,T){let k=C.view.ru(S);k.Cs&&(k=await Bm(P.localStore,C.query,!1).then(({documents:E})=>C.view.ru(E,k)));const L=T&&T.targetChanges.get(C.targetId),D=T&&T.targetMismatches.get(C.targetId)!=null,V=C.view.applyChanges(k,P.isPrimaryClient,L,D);return Jm(P,C.targetId,V.au),V.snapshot}(t,m,p,y);const i=await Bm(t.localStore,e,!0),o=new ok(e,i.Qs),c=o.ru(i.documents),l=_i.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline",r),h=o.applyChanges(c,t.isPrimaryClient,l);Jm(t,n,h.au);const d=new ak(e,n,o);return t.Tu.set(e,d),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),h.snapshot}async function fk(t,e,n){const s=X(t),r=s.Tu.get(e),i=s.Iu.get(r.targetId);if(i.length>1)return s.Iu.set(r.targetId,i.filter(o=>!ta(o,e))),void s.Tu.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await ll(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),n&&Mu(s.remoteStore,r.targetId),dl(s,r.targetId)}).catch(Hs)):(dl(s,r.targetId),await ll(s.localStore,r.targetId,!0))}async function mk(t,e){const n=X(t),s=n.Tu.get(e),r=n.Iu.get(s.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(s.targetId),Mu(n.remoteStore,s.targetId))}async function pk(t,e,n){const s=bk(t);try{const r=await function(o,c){const l=X(o),h=he.now(),d=c.reduce((y,x)=>y.add(x.key),re());let m,p;return l.persistence.runTransaction("Locally write mutations","readwrite",y=>{let x=Kt(),P=re();return l.Ns.getEntries(y,d).next(C=>{x=C,x.forEach((S,T)=>{T.isValidDocument()||(P=P.add(S))})}).next(()=>l.localDocuments.getOverlayedDocuments(y,x)).next(C=>{m=C;const S=[];for(const T of c){const k=SC(T,m.get(T.key).overlayedDocument);k!=null&&S.push(new es(T.key,k,O0(k.value.mapValue),Ct.exists(!0)))}return l.mutationQueue.addMutationBatch(y,h,S,c)}).next(C=>{p=C;const S=C.applyToLocalDocumentSet(m,P);return l.documentOverlayCache.saveOverlays(y,C.batchId,S)})}).then(()=>({batchId:p.batchId,changes:Y0(m)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(o,c,l){let h=o.Vu[o.currentUser.toKey()];h||(h=new ye(se)),h=h.insert(c,l),o.Vu[o.currentUser.toKey()]=h}(s,r.batchId,n),await xi(s,r.changes),await ca(s.remoteStore)}catch(r){const i=$u(r,"Failed to persist write");n.reject(i)}}async function C_(t,e){const n=X(t);try{const s=await IR(n.localStore,e);e.targetChanges.forEach((r,i)=>{const o=n.Au.get(i);o&&(ce(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?o.hu=!0:r.modifiedDocuments.size>0?ce(o.hu,14607):r.removedDocuments.size>0&&(ce(o.hu,42227),o.hu=!1))}),await xi(n,s,e)}catch(s){await Hs(s)}}function Xm(t,e,n){const s=X(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.Tu.forEach((i,o)=>{const c=o.view.va(e);c.snapshot&&r.push(c.snapshot)}),function(o,c){const l=X(o);l.onlineState=c;let h=!1;l.queries.forEach((d,m)=>{for(const p of m.Sa)p.va(c)&&(h=!0)}),h&&Bu(l)}(s.eventManager,e),r.length&&s.Pu.H_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function gk(t,e,n){const s=X(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.Au.get(e),i=r&&r.key;if(i){let o=new ye(H.comparator);o=o.insert(i,ze.newNoDocument(i,Y.min()));const c=re().add(i),l=new ia(Y.min(),new Map,new ye(se),o,c);await C_(s,l),s.du=s.du.remove(i),s.Au.delete(e),Wu(s)}else await ll(s.localStore,e,!1).then(()=>dl(s,e,n)).catch(Hs)}async function yk(t,e){const n=X(t),s=e.batch.batchId;try{const r=await ER(n.localStore,e);k_(n,s,null),R_(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await xi(n,r)}catch(r){await Hs(r)}}async function _k(t,e,n){const s=X(t);try{const r=await function(o,c){const l=X(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let d;return l.mutationQueue.lookupMutationBatch(h,c).next(m=>(ce(m!==null,37113),d=m.keys(),l.mutationQueue.removeMutationBatch(h,m))).next(()=>l.mutationQueue.performConsistencyCheck(h)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(h,d,c)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d)).next(()=>l.localDocuments.getDocuments(h,d))})}(s.localStore,e);k_(s,e,n),R_(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await xi(s,r)}catch(r){await Hs(r)}}function R_(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function k_(t,e,n){const s=X(t);let r=s.Vu[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(n?i.reject(n):i.resolve(),r=r.remove(e)),s.Vu[s.currentUser.toKey()]=r}}function dl(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.Iu.get(e))t.Tu.delete(s),n&&t.Pu.yu(s,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach(s=>{t.Ru.containsKey(s)||D_(t,s)})}function D_(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Mu(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),Wu(t))}function Jm(t,e,n){for(const s of n)s instanceof S_?(t.Ru.addReference(s.key,e),wk(t,s)):s instanceof N_?(W(qu,"Document no longer in limbo: "+s.key),t.Ru.removeReference(s.key,e),t.Ru.containsKey(s.key)||D_(t,s.key)):K(19791,{wu:s})}function wk(t,e){const n=e.key,s=n.path.canonicalString();t.du.get(n)||t.Eu.has(s)||(W(qu,"New document in limbo: "+n),t.Eu.add(s),Wu(t))}function Wu(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new H(ue.fromString(e)),s=t.fu.next();t.Au.set(s,new ck(n)),t.du=t.du.insert(n,s),v_(t.remoteStore,new an(Pt(z0(n.path)),s,"TargetPurposeLimboResolution",Jo.ce))}}async function xi(t,e,n){const s=X(t),r=[],i=[],o=[];s.Tu.isEmpty()||(s.Tu.forEach((c,l)=>{o.push(s.pu(l,e,n).then(h=>{var d;if((h||n)&&s.isPrimaryClient){const m=h?!h.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))==null?void 0:d.current;s.sharedClientState.updateQueryState(l.targetId,m?"current":"not-current")}if(h){r.push(h);const m=ju.As(l.targetId,h);i.push(m)}}))}),await Promise.all(o),s.Pu.H_(r),await async function(l,h){const d=X(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>U.forEach(h,p=>U.forEach(p.Es,y=>d.persistence.referenceDelegate.addReference(m,p.targetId,y)).next(()=>U.forEach(p.ds,y=>d.persistence.referenceDelegate.removeReference(m,p.targetId,y)))))}catch(m){if(!Gs(m))throw m;W(Vu,"Failed to update sequence numbers: "+m)}for(const m of h){const p=m.targetId;if(!m.fromCache){const y=d.Ms.get(p),x=y.snapshotVersion,P=y.withLastLimboFreeSnapshotVersion(x);d.Ms=d.Ms.insert(p,P)}}}(s.localStore,i))}async function xk(t,e){const n=X(t);if(!n.currentUser.isEqual(e)){W(qu,"User change. New user:",e.toKey());const s=await y_(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(c=>{c.forEach(l=>{l.reject(new q(F.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await xi(n,s.Ls)}}function vk(t,e){const n=X(t),s=n.Au.get(e);if(s&&s.hu)return re().add(s.key);{let r=re();const i=n.Iu.get(e);if(!i)return r;for(const o of i){const c=n.Tu.get(o);r=r.unionWith(c.view.nu)}return r}}function j_(t){const e=X(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=C_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=vk.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=gk.bind(null,e),e.Pu.H_=sk.bind(null,e.eventManager),e.Pu.yu=rk.bind(null,e.eventManager),e}function bk(t){const e=X(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=yk.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=_k.bind(null,e),e}class jo{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=oa(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return TR(this.persistence,new xR,e.initialUser,this.serializer)}Cu(e){return new g_(Du.mi,this.serializer)}Du(e){return new CR}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}jo.provider={build:()=>new jo};class Tk extends jo{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ce(this.persistence.referenceDelegate instanceof ko,46915);const s=this.persistence.referenceDelegate.garbageCollector;return new iR(s,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Je.withCacheSize(this.cacheSizeBytes):Je.DEFAULT;return new g_(s=>ko.mi(s,n),this.serializer)}}class fl{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>Xm(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=xk.bind(null,this.syncEngine),await JR(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new ek}()}createDatastore(e){const n=oa(e.databaseInfo.databaseId),s=function(i){return new VR(i)}(e.databaseInfo);return function(i,o,c,l){return new FR(i,o,c,l)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return function(s,r,i,o,c){return new $R(s,r,i,o,c)}(this.localStore,this.datastore,e.asyncQueue,n=>Xm(this.syncEngine,n,0),function(){return zm.v()?new zm:new RR}())}createSyncEngine(e,n){return function(r,i,o,c,l,h,d){const m=new lk(r,i,o,c,l,h);return d&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(r){const i=X(r);W(zn,"RemoteStore shutting down."),i.Ea.add(5),await wi(i),i.Aa.shutdown(),i.Ra.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}fl.provider={build:()=>new fl};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ek{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Gt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tn="FirestoreClient";class Ik{constructor(e,n,s,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=We.UNAUTHENTICATED,this.clientId=vu.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,async o=>{W(Tn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(W(Tn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=$u(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function uc(t,e){t.asyncQueue.verifyOperationInProgress(),W(Tn,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async r=>{s.isEqual(r)||(await y_(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Zm(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Ak(t);W(Tn,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(s=>Gm(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,r)=>Gm(e.remoteStore,r)),t._onlineComponents=e}async function Ak(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){W(Tn,"Using user provided OfflineComponentProvider");try{await uc(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(r){return r.name==="FirebaseError"?r.code===F.FAILED_PRECONDITION||r.code===F.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(n))throw n;Ns("Error using user provided cache. Falling back to memory cache: "+n),await uc(t,new jo)}}else W(Tn,"Using default OfflineComponentProvider"),await uc(t,new Tk(void 0));return t._offlineComponents}async function V_(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(W(Tn,"Using user provided OnlineComponentProvider"),await Zm(t,t._uninitializedComponentsProvider._online)):(W(Tn,"Using default OnlineComponentProvider"),await Zm(t,new fl))),t._onlineComponents}function Sk(t){return V_(t).then(e=>e.syncEngine)}async function Nk(t){const e=await V_(t),n=e.eventManager;return n.onListen=uk.bind(null,e.syncEngine),n.onUnlisten=fk.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=hk.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=mk.bind(null,e.syncEngine),n}function Pk(t,e,n={}){const s=new fn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,c,l,h){const d=new Ek({next:p=>{d.Nu(),o.enqueueAndForget(()=>nk(i,m)),p.fromCache&&l.source==="server"?h.reject(new q(F.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(p)},error:p=>h.reject(p)}),m=new ik(c,d,{includeMetadataChanges:!0,qa:!0});return tk(i,m)}(await Nk(t),t.asyncQueue,e,n,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M_(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ep=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L_="firestore.googleapis.com",tp=!0;class np{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new q(F.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=L_,this.ssl=tp}else this.host=e.host,this.ssl=e.ssl??tp;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=p_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<sR)throw new q(F.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=M_(e.experimentalLongPollingOptions??{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new q(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new q(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new q(F.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class la{constructor(e,n,s,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new np({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new q(F.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new q(F.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new np(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new R2;switch(s.type){case"firstParty":return new V2(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new q(F.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const s=ep.get(n);s&&(W("ComponentProvider","Removing Datastore"),ep.delete(n),s.terminate())}(this),Promise.resolve()}}function Ck(t,e,n,s={}){var h;t=Cs(t,la);const r=Bs(e),i=t._getSettings(),o={...i,emulatorOptions:t._getEmulatorOptions()},c=`${e}:${n}`;r&&(ky(`https://${c}`),Dy("Firestore",!0)),i.host!==L_&&i.host!==c&&Ns("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...i,host:c,ssl:r,emulatorOptions:s};if(!yn(l,o)&&(t._setSettings(l),s.mockUserToken)){let d,m;if(typeof s.mockUserToken=="string")d=s.mockUserToken,m=We.MOCK_USER;else{d=BA(s.mockUserToken,(h=t._app)==null?void 0:h.options.projectId);const p=s.mockUserToken.sub||s.mockUserToken.user_id;if(!p)throw new q(F.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");m=new We(p)}t._authCredentials=new k2(new A0(d,m))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new ns(this.firestore,e,this._query)}}class Ce{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ce(this.firestore,e,this._key)}toJSON(){return{type:Ce._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,s){if(gi(n,Ce._jsonSchema))return new Ce(e,s||null,new H(ue.fromString(n.referencePath)))}}Ce._jsonSchemaVersion="firestore/documentReference/1.0",Ce._jsonSchema={type:Se("string",Ce._jsonSchemaVersion),referencePath:Se("string")};class mn extends ns{constructor(e,n,s){super(e,n,z0(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ce(this.firestore,null,new H(e))}withConverter(e){return new mn(this.firestore,e,this._path)}}function Rk(t,e,...n){if(t=Fe(t),S0("collection","path",e),t instanceof la){const s=ue.fromString(e,...n);return pm(s),new mn(t,null,s)}{if(!(t instanceof Ce||t instanceof mn))throw new q(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(ue.fromString(e,...n));return pm(s),new mn(t.firestore,null,s)}}function hc(t,e,...n){if(t=Fe(t),arguments.length===1&&(e=vu.newId()),S0("doc","path",e),t instanceof la){const s=ue.fromString(e,...n);return mm(s),new Ce(t,null,new H(s))}{if(!(t instanceof Ce||t instanceof mn))throw new q(F.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(ue.fromString(e,...n));return mm(s),new Ce(t.firestore,t instanceof mn?t.converter:null,new H(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sp="AsyncQueue";class rp{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new w_(this,"async_queue_retry"),this._c=()=>{const s=lc();s&&W(sp,"Visibility state changed to "+s.visibilityState),this.M_.w_()},this.ac=e;const n=lc();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=lc();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new fn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Gs(e))throw e;W(sp,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(s=>{throw this.nc=s,this.rc=!1,Gt("INTERNAL UNHANDLED ERROR: ",ip(s)),s}).then(s=>(this.rc=!1,s))));return this.ac=n,n}enqueueAfterDelay(e,n,s){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const r=Uu.createAndSchedule(this,e,n,s,i=>this.hc(i));return this.tc.push(r),r}uc(){this.nc&&K(47125,{Pc:ip(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function ip(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class ua extends la{constructor(e,n,s,r){super(e,n,s,r),this.type="firestore",this._queue=new rp,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new rp(e),this._firestoreClient=void 0,await e}}}function kk(t,e){const n=typeof t=="object"?t:lu(),s=typeof t=="string"?t:Ao,r=Qn(n,"firestore").getImmediate({identifier:s});if(!r._initialized){const i=UA("firestore");i&&Ck(r,...i)}return r}function O_(t){if(t._terminated)throw new q(F.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Dk(t),t._firestoreClient}function Dk(t){var s,r,i;const e=t._freezeSettings(),n=function(c,l,h,d){return new J2(c,l,h,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,M_(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((s=t._app)==null?void 0:s.options.appId)||"",t._persistenceKey,e);t._componentsProvider||(r=e.localCache)!=null&&r._offlineComponentProvider&&((i=e.localCache)!=null&&i._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new Ik(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(c){const l=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this._byteString=e}static fromBase64String(e){try{return new at(Ue.fromBase64String(e))}catch(n){throw new q(F.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new at(Ue.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:at._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(gi(e,at._jsonSchema))return at.fromBase64String(e.bytes)}}at._jsonSchemaVersion="firestore/bytes/1.0",at._jsonSchema={type:Se("string",at._jsonSchemaVersion),bytes:Se("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new q(F.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Oe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new q(F.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new q(F.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return se(this._lat,e._lat)||se(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:kt._jsonSchemaVersion}}static fromJSON(e){if(gi(e,kt._jsonSchema))return new kt(e.latitude,e.longitude)}}kt._jsonSchemaVersion="firestore/geoPoint/1.0",kt._jsonSchema={type:Se("string",kt._jsonSchemaVersion),latitude:Se("number"),longitude:Se("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Dt._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(gi(e,Dt._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Dt(e.vectorValues);throw new q(F.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Dt._jsonSchemaVersion="firestore/vectorValue/1.0",Dt._jsonSchema={type:Se("string",Dt._jsonSchemaVersion),vectorValues:Se("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jk=/^__.*__$/;class Vk{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new es(e,this.data,this.fieldMask,n,this.fieldTransforms):new yi(e,this.data,n,this.fieldTransforms)}}function U_(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw K(40011,{Ac:t})}}class Hu{constructor(e,n,s,r,i,o){this.settings=e,this.databaseId=n,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Hu({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var r;const n=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:n,fc:!1});return s.gc(e),s}yc(e){var r;const n=(r=this.path)==null?void 0:r.child(e),s=this.Vc({path:n,fc:!1});return s.Rc(),s}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Vo(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(U_(this.Ac)&&jk.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Mk{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=s||oa(e)}Cc(e,n,s,r=!1){return new Hu({Ac:e,methodName:n,Dc:s,path:Oe.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $_(t){const e=t._freezeSettings(),n=oa(t._databaseId);return new Mk(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Lk(t,e,n,s,r,i={}){const o=t.Cc(i.merge||i.mergeFields?2:0,e,n,r);W_("Data must be an object, but it was:",o,s);const c=B_(s,o);let l,h;if(i.merge)l=new mt(o.fieldMask),h=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const m of i.mergeFields){const p=Fk(e,m,n);if(!o.contains(p))throw new q(F.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);$k(d,p)||d.push(p)}l=new mt(d),h=o.fieldTransforms.filter(m=>l.covers(m.field))}else l=null,h=o.fieldTransforms;return new Vk(new ot(c),l,h)}function Ok(t,e,n,s=!1){return Gu(n,t.Cc(s?4:3,e))}function Gu(t,e){if(q_(t=Fe(t)))return W_("Unsupported field value:",e,t),B_(t,e);if(t instanceof F_)return function(s,r){if(!U_(r.Ac))throw r.Sc(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Sc(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return function(s,r){const i=[];let o=0;for(const c of s){let l=Gu(c,r.wc(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(t,e)}return function(s,r){if((s=Fe(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return vC(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=he.fromDate(s);return{timestampValue:Ro(r.serializer,i)}}if(s instanceof he){const i=new he(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:Ro(r.serializer,i)}}if(s instanceof kt)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof at)return{bytesValue:c_(r.serializer,s._byteString)};if(s instanceof Ce){const i=r.databaseId,o=s.firestore._databaseId;if(!o.isEqual(i))throw r.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Ru(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof Dt)return function(o,c){return{mapValue:{fields:{[M0]:{stringValue:L0},[So]:{arrayValue:{values:o.toArray().map(h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return Su(c.serializer,h)})}}}}}}(s,r);throw r.Sc(`Unsupported field value: ${Xo(s)}`)}(t,e)}function B_(t,e){const n={};return C0(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Jn(t,(s,r)=>{const i=Gu(r,e.mc(s));i!=null&&(n[s]=i)}),{mapValue:{fields:n}}}function q_(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof he||t instanceof kt||t instanceof at||t instanceof Ce||t instanceof F_||t instanceof Dt)}function W_(t,e,n){if(!q_(n)||!N0(n)){const s=Xo(n);throw s==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+s)}}function Fk(t,e,n){if((e=Fe(e))instanceof zu)return e._internalPath;if(typeof e=="string")return z_(t,e);throw Vo("Field path arguments must be of type string or ",t,!1,void 0,n)}const Uk=new RegExp("[~\\*/\\[\\]]");function z_(t,e,n){if(e.search(Uk)>=0)throw Vo(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new zu(...e.split("."))._internalPath}catch{throw Vo(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Vo(t,e,n,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let c=`Function ${e}() called with invalid data`;n&&(c+=" (via `toFirestore()`)"),c+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${s}`),o&&(l+=` in document ${r}`),l+=")"),new q(F.INVALID_ARGUMENT,c+t+l)}function $k(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H_{constructor(e,n,s,r,i){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ce(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Bk(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Ku("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Bk extends H_{data(){return super.data()}}function Ku(t,e){return typeof e=="string"?z_(t,e):e instanceof zu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qk(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new q(F.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Qu{}class G_ extends Qu{}function Wk(t,e,...n){let s=[];e instanceof Qu&&s.push(e),s=s.concat(n),function(i){const o=i.filter(l=>l instanceof Xu).length,c=i.filter(l=>l instanceof Yu).length;if(o>1||o>0&&c>0)throw new q(F.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)t=r._apply(t);return t}class Yu extends G_{constructor(e,n,s){super(),this._field=e,this._op=n,this._value=s,this.type="where"}static _create(e,n,s){return new Yu(e,n,s)}_apply(e){const n=this._parse(e);return K_(e._query,n),new ns(e.firestore,e.converter,sl(e._query,n))}_parse(e){const n=$_(e.firestore);return function(i,o,c,l,h,d,m){let p;if(h.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new q(F.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){ap(m,d);const x=[];for(const P of m)x.push(op(l,i,P));p={arrayValue:{values:x}}}else p=op(l,i,m)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||ap(m,d),p=Ok(c,o,m,d==="in"||d==="not-in");return Ae.create(h,d,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class Xu extends Qu{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Xu(e,n)}_parse(e){const n=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return n.length===1?n[0]:_t.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(r,i){let o=r;const c=i.getFlattenedFilters();for(const l of c)K_(o,l),o=sl(o,l)}(e._query,n),new ns(e.firestore,e.converter,sl(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ju extends G_{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Ju(e,n)}_apply(e){const n=function(r,i,o){if(r.startAt!==null)throw new q(F.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new q(F.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new si(i,o)}(e._query,this._field,this._direction);return new ns(e.firestore,e.converter,function(r,i){const o=r.explicitOrderBy.concat([i]);return new Ks(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}function zk(t,e="asc"){const n=e,s=Ku("orderBy",t);return Ju._create(s,n)}function op(t,e,n){if(typeof(n=Fe(n))=="string"){if(n==="")throw new q(F.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!H0(e)&&n.indexOf("/")!==-1)throw new q(F.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(ue.fromString(n));if(!H.isDocumentKey(s))throw new q(F.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return Tm(t,new H(s))}if(n instanceof Ce)return Tm(t,n._key);throw new q(F.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Xo(n)}.`)}function ap(t,e){if(!Array.isArray(t)||t.length===0)throw new q(F.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function K_(t,e){const n=function(r,i){for(const o of r)for(const c of o.getFlattenedFilters())if(i.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new q(F.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new q(F.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Hk{convertValue(e,n="none"){switch(vn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Te(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(xn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw K(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const s={};return Jn(e,(r,i)=>{s[r]=this.convertValue(i,n)}),s}convertVectorValue(e){var s,r,i;const n=(i=(r=(s=e.fields)==null?void 0:s[So].arrayValue)==null?void 0:r.values)==null?void 0:i.map(o=>Te(o.doubleValue));return new Dt(n)}convertGeoPoint(e){return new kt(Te(e.latitude),Te(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=ea(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(ei(e));default:return null}}convertTimestamp(e){const n=wn(e);return new he(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=ue.fromString(e);ce(m_(s),9688,{name:e});const r=new ti(s.get(1),s.get(3)),i=new H(s.popFirst(5));return r.isEqual(n)||Gt(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gk(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class zi{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ts extends H_{constructor(e,n,s,r,i,o){super(e,n,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new ao(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(Ku("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new q(F.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ts._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ts._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ts._jsonSchema={type:Se("string",Ts._jsonSchemaVersion),bundleSource:Se("string","DocumentSnapshot"),bundleName:Se("string"),bundle:Se("string")};class ao extends Ts{data(e={}){return super.data(e)}}class Es{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new zi(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new ao(this._firestore,this._userDataWriter,s.key,s,new zi(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new q(F.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(c=>{const l=new ao(r._firestore,r._userDataWriter,c.doc.key,c.doc,new zi(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);return c.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(c=>i||c.type!==3).map(c=>{const l=new ao(r._firestore,r._userDataWriter,c.doc.key,c.doc,new zi(r._snapshot.mutatedKeys.has(c.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,d=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),d=o.indexOf(c.doc.key)),{type:Kk(c.type),doc:l,oldIndex:h,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new q(F.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Es._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=vu.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],s=[],r=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),s.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),r.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Kk(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return K(61501,{type:t})}}Es._jsonSchemaVersion="firestore/querySnapshot/1.0",Es._jsonSchema={type:Se("string",Es._jsonSchemaVersion),bundleSource:Se("string","QuerySnapshot"),bundleName:Se("string"),bundle:Se("string")};class Qk extends Hk{constructor(e){super(),this.firestore=e}convertBytes(e){return new at(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ce(this.firestore,null,n)}}function Yk(t){t=Cs(t,ns);const e=Cs(t.firestore,ua),n=O_(e),s=new Qk(e);return qk(t._query),Pk(n,t._query).then(r=>new Es(e,s,t,r))}function cp(t,e,n){t=Cs(t,Ce);const s=Cs(t.firestore,ua),r=Gk(t.converter,e,n);return Q_(s,[Lk($_(s),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,Ct.none())])}function Xk(t){return Q_(Cs(t.firestore,ua),[new Nu(t._key,Ct.none())])}function Q_(t,e){return function(s,r){const i=new fn;return s.asyncQueue.enqueueAndForget(async()=>pk(await Sk(s),r,i)),i.promise}(O_(t),e)}(function(e,n=!0){(function(r){zs=r})(qs),jt(new yt("firestore",(s,{instanceIdentifier:r,options:i})=>{const o=s.getProvider("app").getImmediate(),c=new ua(new D2(s.getProvider("auth-internal")),new M2(o,s.getProvider("app-check-internal")),function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new q(F.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ti(h.options.projectId,d)}(o,r),o);return i={useFetchStreams:n,...i},c._setSettings(i),c},"PUBLIC").setMultipleInstances(!0)),lt(um,hm,e),lt(um,hm,"esm2020")})();const Y_="@firebase/installations",Zu="0.6.19";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X_=1e4,J_=`w:${Zu}`,Z_="FIS_v2",Jk="https://firebaseinstallations.googleapis.com/v1",Zk=60*60*1e3,eD="installations",tD="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nD={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Hn=new Kn(eD,tD,nD);function ew(t){return t instanceof vt&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tw({projectId:t}){return`${Jk}/projects/${t}/installations`}function nw(t){return{token:t.token,requestStatus:2,expiresIn:rD(t.expiresIn),creationTime:Date.now()}}async function sw(t,e){const s=(await e.json()).error;return Hn.create("request-failed",{requestName:t,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})}function rw({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function sD(t,{refreshToken:e}){const n=rw(t);return n.append("Authorization",iD(e)),n}async function iw(t){const e=await t();return e.status>=500&&e.status<600?t():e}function rD(t){return Number(t.replace("s","000"))}function iD(t){return`${Z_} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oD({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const s=tw(t),r=rw(t),i=e.getImmediate({optional:!0});if(i){const h=await i.getHeartbeatsHeader();h&&r.append("x-firebase-client",h)}const o={fid:n,authVersion:Z_,appId:t.appId,sdkVersion:J_},c={method:"POST",headers:r,body:JSON.stringify(o)},l=await iw(()=>fetch(s,c));if(l.ok){const h=await l.json();return{fid:h.fid||n,registrationStatus:2,refreshToken:h.refreshToken,authToken:nw(h.authToken)}}else throw await sw("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aD(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cD=/^[cdef][\w-]{21}$/,ml="";function lD(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=uD(t);return cD.test(n)?n:ml}catch{return ml}}function uD(t){return aD(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ha(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aw=new Map;function cw(t,e){const n=ha(t);lw(n,e),hD(n,e)}function lw(t,e){const n=aw.get(t);if(n)for(const s of n)s(e)}function hD(t,e){const n=dD();n&&n.postMessage({key:t,fid:e}),fD()}let Un=null;function dD(){return!Un&&"BroadcastChannel"in self&&(Un=new BroadcastChannel("[Firebase] FID Change"),Un.onmessage=t=>{lw(t.data.key,t.data.fid)}),Un}function fD(){aw.size===0&&Un&&(Un.close(),Un=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mD="firebase-installations-database",pD=1,Gn="firebase-installations-store";let dc=null;function eh(){return dc||(dc=Ly(mD,pD,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Gn)}}})),dc}async function Mo(t,e){const n=ha(t),r=(await eh()).transaction(Gn,"readwrite"),i=r.objectStore(Gn),o=await i.get(n);return await i.put(e,n),await r.done,(!o||o.fid!==e.fid)&&cw(t,e.fid),e}async function uw(t){const e=ha(t),s=(await eh()).transaction(Gn,"readwrite");await s.objectStore(Gn).delete(e),await s.done}async function da(t,e){const n=ha(t),r=(await eh()).transaction(Gn,"readwrite"),i=r.objectStore(Gn),o=await i.get(n),c=e(o);return c===void 0?await i.delete(n):await i.put(c,n),await r.done,c&&(!o||o.fid!==c.fid)&&cw(t,c.fid),c}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function th(t){let e;const n=await da(t.appConfig,s=>{const r=gD(s),i=yD(t,r);return e=i.registrationPromise,i.installationEntry});return n.fid===ml?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function gD(t){const e=t||{fid:lD(),registrationStatus:0};return hw(e)}function yD(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(Hn.create("app-offline"));return{installationEntry:e,registrationPromise:r}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},s=_D(t,n);return{installationEntry:n,registrationPromise:s}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:wD(t)}:{installationEntry:e}}async function _D(t,e){try{const n=await oD(t,e);return Mo(t.appConfig,n)}catch(n){throw ew(n)&&n.customData.serverCode===409?await uw(t.appConfig):await Mo(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function wD(t){let e=await lp(t.appConfig);for(;e.registrationStatus===1;)await ow(100),e=await lp(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:s}=await th(t);return s||n}return e}function lp(t){return da(t,e=>{if(!e)throw Hn.create("installation-not-found");return hw(e)})}function hw(t){return xD(t)?{fid:t.fid,registrationStatus:0}:t}function xD(t){return t.registrationStatus===1&&t.registrationTime+X_<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vD({appConfig:t,heartbeatServiceProvider:e},n){const s=bD(t,n),r=sD(t,n),i=e.getImmediate({optional:!0});if(i){const h=await i.getHeartbeatsHeader();h&&r.append("x-firebase-client",h)}const o={installation:{sdkVersion:J_,appId:t.appId}},c={method:"POST",headers:r,body:JSON.stringify(o)},l=await iw(()=>fetch(s,c));if(l.ok){const h=await l.json();return nw(h)}else throw await sw("Generate Auth Token",l)}function bD(t,{fid:e}){return`${tw(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nh(t,e=!1){let n;const s=await da(t.appConfig,i=>{if(!dw(i))throw Hn.create("not-registered");const o=i.authToken;if(!e&&ID(o))return i;if(o.requestStatus===1)return n=TD(t,e),i;{if(!navigator.onLine)throw Hn.create("app-offline");const c=SD(i);return n=ED(t,c),c}});return n?await n:s.authToken}async function TD(t,e){let n=await up(t.appConfig);for(;n.authToken.requestStatus===1;)await ow(100),n=await up(t.appConfig);const s=n.authToken;return s.requestStatus===0?nh(t,e):s}function up(t){return da(t,e=>{if(!dw(e))throw Hn.create("not-registered");const n=e.authToken;return ND(n)?{...e,authToken:{requestStatus:0}}:e})}async function ED(t,e){try{const n=await vD(t,e),s={...e,authToken:n};return await Mo(t.appConfig,s),n}catch(n){if(ew(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await uw(t.appConfig);else{const s={...e,authToken:{requestStatus:0}};await Mo(t.appConfig,s)}throw n}}function dw(t){return t!==void 0&&t.registrationStatus===2}function ID(t){return t.requestStatus===2&&!AD(t)}function AD(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+Zk}function SD(t){const e={requestStatus:1,requestTime:Date.now()};return{...t,authToken:e}}function ND(t){return t.requestStatus===1&&t.requestTime+X_<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PD(t){const e=t,{installationEntry:n,registrationPromise:s}=await th(e);return s?s.catch(console.error):nh(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CD(t,e=!1){const n=t;return await RD(n),(await nh(n,e)).token}async function RD(t){const{registrationPromise:e}=await th(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kD(t){if(!t||!t.options)throw fc("App Configuration");if(!t.name)throw fc("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw fc(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function fc(t){return Hn.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fw="installations",DD="installations-internal",jD=t=>{const e=t.getProvider("app").getImmediate(),n=kD(e),s=Qn(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:s,_delete:()=>Promise.resolve()}},VD=t=>{const e=t.getProvider("app").getImmediate(),n=Qn(e,fw).getImmediate();return{getId:()=>PD(n),getToken:r=>CD(n,r)}};function MD(){jt(new yt(fw,jD,"PUBLIC")),jt(new yt(DD,VD,"PRIVATE"))}MD();lt(Y_,Zu);lt(Y_,Zu,"esm2020");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lo="analytics",LD="firebase_id",OD="origin",FD=60*1e3,UD="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",sh="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const et=new Ho("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $D={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},nt=new Kn("analytics","Analytics",$D);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BD(t){if(!t.startsWith(sh)){const e=nt.create("invalid-gtag-resource",{gtagURL:t});return et.warn(e.message),""}return t}function mw(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function qD(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function WD(t,e){const n=qD("firebase-js-sdk-policy",{createScriptURL:BD}),s=document.createElement("script"),r=`${sh}?l=${t}&id=${e}`;s.src=n?n==null?void 0:n.createScriptURL(r):r,s.async=!0,document.head.appendChild(s)}function zD(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function HD(t,e,n,s,r,i){const o=s[r];try{if(o)await e[o];else{const l=(await mw(n)).find(h=>h.measurementId===r);l&&await e[l.appId]}}catch(c){et.error(c)}t("config",r,i)}async function GD(t,e,n,s,r){try{let i=[];if(r&&r.send_to){let o=r.send_to;Array.isArray(o)||(o=[o]);const c=await mw(n);for(const l of o){const h=c.find(m=>m.measurementId===l),d=h&&e[h.appId];if(d)i.push(d);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",s,r||{})}catch(i){et.error(i)}}function KD(t,e,n,s){async function r(i,...o){try{if(i==="event"){const[c,l]=o;await GD(t,e,n,c,l)}else if(i==="config"){const[c,l]=o;await HD(t,e,n,s,c,l)}else if(i==="consent"){const[c,l]=o;t("consent",c,l)}else if(i==="get"){const[c,l,h]=o;t("get",c,l,h)}else if(i==="set"){const[c]=o;t("set",c)}else t(i,...o)}catch(c){et.error(c)}}return r}function QD(t,e,n,s,r){let i=function(...o){window[s].push(arguments)};return window[r]&&typeof window[r]=="function"&&(i=window[r]),window[r]=KD(i,t,e,n),{gtagCore:i,wrappedGtag:window[r]}}function YD(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(sh)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD=30,JD=1e3;class ZD{constructor(e={},n=JD){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const pw=new ZD;function ej(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function tj(t){var o;const{appId:e,apiKey:n}=t,s={method:"GET",headers:ej(n)},r=UD.replace("{app-id}",e),i=await fetch(r,s);if(i.status!==200&&i.status!==304){let c="";try{const l=await i.json();(o=l.error)!=null&&o.message&&(c=l.error.message)}catch{}throw nt.create("config-fetch-failed",{httpStatus:i.status,responseMessage:c})}return i.json()}async function nj(t,e=pw,n){const{appId:s,apiKey:r,measurementId:i}=t.options;if(!s)throw nt.create("no-app-id");if(!r){if(i)return{measurementId:i,appId:s};throw nt.create("no-api-key")}const o=e.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new ij;return setTimeout(async()=>{c.abort()},FD),gw({appId:s,apiKey:r,measurementId:i},o,c,e)}async function gw(t,{throttleEndTimeMillis:e,backoffCount:n},s,r=pw){var c;const{appId:i,measurementId:o}=t;try{await sj(s,e)}catch(l){if(o)return et.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:i,measurementId:o};throw l}try{const l=await tj(t);return r.deleteThrottleMetadata(i),l}catch(l){const h=l;if(!rj(h)){if(r.deleteThrottleMetadata(i),o)return et.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${h==null?void 0:h.message}]`),{appId:i,measurementId:o};throw l}const d=Number((c=h==null?void 0:h.customData)==null?void 0:c.httpStatus)===503?Df(n,r.intervalMillis,XD):Df(n,r.intervalMillis),m={throttleEndTimeMillis:Date.now()+d,backoffCount:n+1};return r.setThrottleMetadata(i,m),et.debug(`Calling attemptFetch again in ${d} millis`),gw(t,m,s,r)}}function sj(t,e){return new Promise((n,s)=>{const r=Math.max(e-Date.now(),0),i=setTimeout(n,r);t.addEventListener(()=>{clearTimeout(i),s(nt.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function rj(t){if(!(t instanceof vt)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class ij{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function oj(t,e,n,s,r){if(r&&r.global){t("event",n,s);return}else{const i=await e,o={...s,send_to:i};t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aj(){if(ou())try{await au()}catch(t){return et.warn(nt.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return et.warn(nt.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function cj(t,e,n,s,r,i,o){const c=nj(t);c.then(p=>{n[p.measurementId]=p.appId,t.options.measurementId&&p.measurementId!==t.options.measurementId&&et.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${p.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(p=>et.error(p)),e.push(c);const l=aj().then(p=>{if(p)return s.getId()}),[h,d]=await Promise.all([c,l]);YD(i)||WD(i,h.measurementId),r("js",new Date);const m=(o==null?void 0:o.config)??{};return m[OD]="firebase",m.update=!0,d!=null&&(m[LD]=d),r("config",h.measurementId,m),h.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lj{constructor(e){this.app=e}_delete(){return delete Mr[this.app.options.appId],Promise.resolve()}}let Mr={},hp=[];const dp={};let mc="dataLayer",uj="gtag",fp,yw,mp=!1;function hj(){const t=[];if(iu()&&t.push("This is a browser extension environment."),jy()||t.push("Cookies are not available."),t.length>0){const e=t.map((s,r)=>`(${r+1}) ${s}`).join(" "),n=nt.create("invalid-analytics-context",{errorInfo:e});et.warn(n.message)}}function dj(t,e,n){hj();const s=t.options.appId;if(!s)throw nt.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)et.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw nt.create("no-api-key");if(Mr[s]!=null)throw nt.create("already-exists",{id:s});if(!mp){zD(mc);const{wrappedGtag:i,gtagCore:o}=QD(Mr,hp,dp,mc,uj);yw=i,fp=o,mp=!0}return Mr[s]=cj(t,hp,dp,e,fp,mc,n),new lj(t)}function fj(t=lu()){t=Fe(t);const e=Qn(t,Lo);return e.isInitialized()?e.getImmediate():mj(t)}function mj(t,e={}){const n=Qn(t,Lo);if(n.isInitialized()){const r=n.getImmediate();if(yn(e,n.getOptions()))return r;throw nt.create("already-initialized")}return n.initialize({options:e})}async function pj(){if(iu()||!jy()||!ou())return!1;try{return await au()}catch{return!1}}function gj(t,e,n,s){t=Fe(t),oj(yw,Mr[t.app.options.appId],e,n,s).catch(r=>et.error(r))}const pp="@firebase/analytics",gp="0.10.18";function yj(){jt(new yt(Lo,(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();return dj(s,r,n)},"PUBLIC")),jt(new yt("analytics-internal",t,"PRIVATE")),lt(pp,gp),lt(pp,gp,"esm2020");function t(e){try{const n=e.getProvider(Lo).getImmediate();return{logEvent:(s,r,i)=>gj(n,s,r,i)}}catch(n){throw nt.create("interop-component-reg-failed",{reason:n})}}}yj();const _w={apiKey:"AIzaSyDq9HWelvEjFMnI6Ju5dnYwZ0G4wZVgth0",authDomain:"therapy-nav-poc-quan.firebaseapp.com",projectId:"therapy-nav-poc-quan",storageBucket:"therapy-nav-poc-quan.firebasestorage.app",messagingSenderId:"385615458061",appId:"1:385615458061:web:2625ec8d10bab824020a44",measurementId:"G-3RJYXCDYTB"},_j=()=>{const e=["apiKey","authDomain","projectId"].filter(n=>!_w[n]);if(e.length>0)throw console.error("Missing Firebase configuration:",e),new Error(`Missing required Firebase configuration: ${e.join(", ")}`)};let mr=null,ve=null,Lt=null,wj=null;try{_j(),mr=Oy(_w),ve=P2(mr),Lt=kk(mr),pj().then(t=>{t&&mr&&(wj=fj(mr))})}catch(t){console.error("Firebase initialization error:",t)}const fa=new Ot;fa.setCustomParameters({prompt:"select_account"});fa.addScope("profile");fa.addScope("email");async function Pe(t,e={}){const n=ve==null?void 0:ve.currentUser;if(n)try{const s=await n.getIdToken();e.headers={...e.headers,Authorization:`Bearer ${s}`}}catch(s){console.error("Failed to get auth token:",s)}return fetch(t,e)}const yp=({onSessionSelect:t,showActiveOnly:e=!1})=>{const[n,s]=b.useState([]),[r,i]=b.useState([]),[o,c]=b.useState([]),[l,h]=b.useState(!0),[d,m]=b.useState(null);b.useEffect(()=>{p()},[]);const p=async()=>{try{const[T,k,L]=await Promise.all([Pe(be("/api/therapists")),Pe(be("/api/patients")),Pe(be("/api/sessions"))]),[D,V,E]=await Promise.all([T.json(),k.json(),L.json()]);console.log("SessionsManagement loaded data:",{therapistsData:D,patientsData:V,sessionsData:E});const v=Array.isArray(D)?D:[],I=Array.isArray(V)?V:(V==null?void 0:V.patients)||[],N=Array.isArray(E)?E:[],R=(await Promise.all(N.map(async _=>{let B=_.phase||"intake",Z=_.status||"active",ae=_.message_count||0;if(e)return null;try{const[te,O]=await Promise.all([Pe(be(`/api/sessions/${_.id}/workflow/status`)),Pe(be(`/api/sessions/${_.id}/messages`))]);if(te.ok){const J=await te.json(),fe={intake:"Intake",identify_activate:"Identify & Activate",setup:"Setup",focused_mindfulness:"Focused Mindfulness",status_check:"Status Check",micro_reprocessing:"Micro-Reprocessing",squeeze_lemon:"Squeeze Lemon",expansion_work:"Expansion Work",dtm_passive:"DTM Passive",checkin:"Check-in",active:"Active Processing",integration:"Integration",stabilization:"Stabilization",resolution:"Resolution"},je=J.current_state||"intake";B=fe[je]||je,Z=J.status||Z}if(O.ok){const J=await O.json();ae=(Array.isArray(J)?J:J.messages||[]).length,console.log(`Session ${_.id} has ${ae} messages`)}else ae=0,console.warn(`Failed to fetch messages for session ${_.id}: ${O.status}`)}catch(te){console.warn(`Failed to fetch session data for ${_.id}:`,te),ae=_.message_count||0}return{..._,phase:B,status:Z,message_count:ae}}))).filter(_=>_!==null);console.log("SessionsManagement arrays:",{therapists:v.length,patients:I.length,sessions:R.length,showActiveOnly:e}),s(v),i(I),c(R),m(null)}catch(T){console.error("Failed to load data:",T),m(`Failed to load data: ${T}`)}finally{h(!1)}},y=async(T,k)=>{try{const L=await Pe(be("/api/sessions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:k,therapist_id:T,simulation_mode:!1,conversation_turns:10})});if(L.ok){const D=await L.json();console.log("✅ New session created:",D.session_id),t(D.session_id),p()}}catch(L){console.error("Failed to create session:",L)}},x=(T,k)=>o.filter(L=>L.therapist_id===T&&L.client_id===k),P=T=>{if(!Array.isArray(o)||!Array.isArray(r))return console.warn("getPatientsForTherapist: sessions or patients not arrays",{sessions:o,patients:r}),[];const k=o.filter(D=>D.therapist_id===T),L=[...new Set(k.map(D=>D.client_id))];return r.filter(D=>L.includes(D.id))},C=T=>{switch(T.toLowerCase().replace(/\s+/g,"_")){case"intake":return Gr;case"identify_&_activate":case"identify_activate":return Ey;case"setup":return ru;case"focused_mindfulness":return ys;case"status_check":return zr;case"micro-reprocessing":case"micro_reprocessing":return vy;case"squeeze_lemon":return YI;case"expansion_work":return zI;case"dtm_passive":return NA;case"check-in":case"checkin":return _s;case"integration":return by;case"stabilization":return xy;case"resolution":return Ty;default:return cn}},S=T=>{switch(T.toLowerCase().replace(/\s+/g,"_")){case"intake":return{text:"text-orange-400",bg:"bg-orange-500/10",border:"border-orange-500/20"};case"identify_&_activate":case"identify_activate":return{text:"text-amber-400",bg:"bg-amber-500/10",border:"border-amber-500/20"};case"setup":return{text:"text-blue-400",bg:"bg-blue-500/10",border:"border-blue-500/20"};case"focused_mindfulness":return{text:"text-purple-400",bg:"bg-purple-500/10",border:"border-purple-500/20"};case"status_check":return{text:"text-yellow-400",bg:"bg-yellow-500/10",border:"border-yellow-500/20"};case"micro-reprocessing":case"micro_reprocessing":return{text:"text-cyan-400",bg:"bg-cyan-500/10",border:"border-cyan-500/20"};case"squeeze_lemon":return{text:"text-lime-400",bg:"bg-lime-500/10",border:"border-lime-500/20"};case"expansion_work":return{text:"text-indigo-400",bg:"bg-indigo-500/10",border:"border-indigo-500/20"};case"dtm_passive":return{text:"text-sky-400",bg:"bg-sky-500/10",border:"border-sky-500/20"};case"check-in":case"checkin":return{text:"text-emerald-400",bg:"bg-emerald-500/10",border:"border-emerald-500/20"};case"integration":return{text:"text-teal-400",bg:"bg-teal-500/10",border:"border-teal-500/20"};case"stabilization":return{text:"text-rose-400",bg:"bg-rose-500/10",border:"border-rose-500/20"};case"resolution":return{text:"text-violet-400",bg:"bg-violet-500/10",border:"border-violet-500/20"};default:return{text:"text-gray-400",bg:"bg-gray-500/10",border:"border-gray-500/20"}}};return l?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"text-white/60",children:"Loading sessions..."})}):d?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"text-red-400",children:d})}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-white/90",children:"Therapy Sessions"}),u.jsx("p",{className:"text-white/60 text-sm mt-1",children:'Click "New Session" under any patient to start, or click existing sessions to continue'})]}),r.filter(T=>!o.some(k=>k.client_id===T.id)).length>0&&u.jsxs("div",{className:"border border-white/10 rounded-xl p-6 bg-white/[0.02] mb-8",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[u.jsx("div",{className:"w-10 h-10 bg-gray-500/20 rounded-lg flex items-center justify-center",children:u.jsx(Nr,{className:"w-5 h-5 text-gray-400"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-white/90 font-medium",children:"Unassigned Patients"}),u.jsx("p",{className:"text-white/60 text-sm",children:"Patients not yet assigned to any therapist"})]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.filter(T=>!o.some(k=>k.client_id===T.id)).map(T=>u.jsxs("div",{className:"border border-white/5 rounded-lg p-4 bg-white/[0.01]",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[u.jsx("div",{className:"w-8 h-8 bg-blue-500/20 rounded-lg flex items-center justify-center",children:u.jsx(Nr,{className:"w-4 h-4 text-blue-400"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h4",{className:"text-white/80 font-medium text-sm truncate",children:T.name}),u.jsx("p",{className:"text-white/40 text-xs truncate",children:T.email})]})]}),u.jsxs("div",{className:"text-center py-4",children:[u.jsx($c,{className:"w-8 h-8 text-white/20 mx-auto mb-2"}),u.jsx("p",{className:"text-white/40 text-xs mb-3",children:"No sessions yet"})]}),u.jsx("div",{className:"space-y-2",children:n.map(k=>u.jsxs(oe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>y(k.id,T.id),className:`w-full p-2 border border-dashed border-purple-500/30 rounded-lg 
                                 bg-purple-500/5 text-purple-400/80 hover:text-purple-400 hover:border-purple-500/50 
                                 hover:bg-purple-500/10 transition-all text-xs font-medium flex items-center justify-center gap-2`,children:[u.jsx(go,{className:"w-3 h-3"}),"Assign to ",k.name]},k.id))})]},T.id))})]}),u.jsx("div",{className:"space-y-8",children:n.map(T=>{const k=P(T.id);return k.length===0?u.jsxs("div",{className:"border border-white/10 rounded-xl p-6 bg-white/[0.02]",children:[u.jsx("div",{className:"flex items-center justify-between mb-4",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-purple-500/20 rounded-lg flex items-center justify-center",children:u.jsx(ys,{className:"w-5 h-5 text-purple-400"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-white/90 font-medium",children:T.name}),u.jsx("p",{className:"text-white/60 text-sm",children:T.specialty})]})]})}),u.jsxs("div",{className:"text-center py-8",children:[u.jsx(cn,{className:"w-12 h-12 text-white/20 mx-auto mb-3"}),u.jsx("p",{className:"text-white/40 text-sm",children:"No sessions yet"})]})]},T.id):u.jsxs("div",{className:"border border-white/10 rounded-xl p-6 bg-white/[0.02]",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 bg-purple-500/20 rounded-lg flex items-center justify-center",children:u.jsx(ys,{className:"w-5 h-5 text-purple-400"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-white/90 font-medium",children:T.name}),u.jsx("p",{className:"text-white/60 text-sm",children:T.specialty})]})]}),u.jsxs("span",{className:"text-white/40 text-xs",children:[k.length," patients"]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(L=>{const D=x(T.id,L.id);return u.jsxs("div",{className:"border border-white/5 rounded-lg p-4 bg-white/[0.01]",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[u.jsx("div",{className:"w-8 h-8 bg-blue-500/20 rounded-lg flex items-center justify-center",children:u.jsx(Nr,{className:"w-4 h-4 text-blue-400"})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h4",{className:"text-white/80 font-medium text-sm truncate",children:L.name}),u.jsx("p",{className:"text-white/40 text-xs truncate",children:L.email})]})]}),u.jsx("div",{className:"space-y-2",children:D.length===0?u.jsxs("div",{className:"text-center py-4",children:[u.jsx($c,{className:"w-8 h-8 text-white/20 mx-auto mb-2"}),u.jsx("p",{className:"text-white/40 text-xs",children:"No sessions"})]}):D.sort((V,E)=>new Date(E.start_time).getTime()-new Date(V.start_time).getTime()).map(V=>u.jsxs(oe.div,{whileHover:{scale:1.02,x:2},onClick:()=>t(V.id),className:`p-3 border rounded-lg cursor-pointer transition-all group
                                         ${S(V.phase).bg} ${S(V.phase).border}
                                         hover:brightness-110`,children:[u.jsx("div",{className:"flex items-center justify-between mb-2",children:u.jsxs("div",{className:"flex items-center gap-2",children:[co.createElement(C(V.phase),{className:`w-4 h-4 ${S(V.phase).text}`}),u.jsx("span",{className:`text-xs font-medium ${S(V.phase).text}`,children:V.phase})]})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("div",{className:"text-xs text-white/60",children:(()=>{const E=new Date(V.start_time),v={weekday:"long",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0};return E.toLocaleDateString("en-US",v)})()}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("div",{className:"w-20 h-2 bg-white/10 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-gradient-to-r from-blue-400 to-purple-400 transition-all duration-300",style:{width:`${Math.min(100,V.message_count/50*100)}%`}})}),u.jsxs("span",{className:"text-white/40 text-[10px]",children:[V.message_count," msgs"]})]}),u.jsx(cn,{className:"w-3 h-3 text-white/30 group-hover:text-white/60 transition-colors"})]})]})]},V.id))}),u.jsxs(oe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>y(T.id,L.id),className:`w-full mt-3 p-3 border border-dashed border-blue-500/30 rounded-lg 
                                   bg-blue-500/5 text-blue-400/80 hover:text-blue-400 hover:border-blue-500/50 
                                   hover:bg-blue-500/10 transition-all text-xs font-medium flex items-center justify-center gap-2`,children:[u.jsx(go,{className:"w-4 h-4"}),"Start New Session"]})]},L.id)})})]},T.id)})})]})},_p=({type:t})=>u.jsxs(oe.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"flex flex-col items-center justify-center py-20",children:[u.jsxs("svg",{width:"150",height:"150",viewBox:"0 0 150 150",className:"mb-6",children:[u.jsx("defs",{children:u.jsxs("linearGradient",{id:`${t}-gradient`,x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[u.jsx("stop",{offset:"0%",stopColor:t==="patients"?"#3b82f6":"#8b5cf6",stopOpacity:"0.6"}),u.jsx("stop",{offset:"100%",stopColor:t==="patients"?"#8b5cf6":"#3b82f6",stopOpacity:"0.6"})]})}),u.jsxs(oe.g,{animate:{y:[0,-5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},children:[u.jsx("circle",{cx:"75",cy:"50",r:"25",fill:`url(#${t}-gradient)`}),u.jsx("path",{d:"M 40 100 Q 75 70 110 100",fill:`url(#${t}-gradient)`,opacity:"0.8"})]}),u.jsxs(oe.g,{animate:{rotate:[0,90,180,270,360]},transition:{duration:8,repeat:1/0,ease:"linear"},children:[u.jsx("circle",{cx:"120",cy:"120",r:"20",fill:"none",stroke:`url(#${t}-gradient)`,strokeWidth:"2"}),u.jsx("line",{x1:"120",y1:"110",x2:"120",y2:"130",stroke:`url(#${t}-gradient)`,strokeWidth:"2"}),u.jsx("line",{x1:"110",y1:"120",x2:"130",y2:"120",stroke:`url(#${t}-gradient)`,strokeWidth:"2"})]})]}),u.jsxs("h3",{className:"text-lg font-medium text-white/80 mb-2",children:["No ",t==="patients"?"Patients":"Therapists"," Yet"]}),u.jsxs("p",{className:"text-white/60 text-sm",children:['Click the "New ',t==="patients"?"Patient":"Therapist",'" button to add your first one']})]}),xj=({message:t,onEdit:e})=>{const[n,s]=b.useState(!1),[r,i]=b.useState(t.content||""),o=t.role==="coach",c=t.message_type==="tool_call",l=c&&(()=>{let y={};if(t.metadata)try{y=typeof t.metadata=="string"?JSON.parse(t.metadata):t.metadata}catch{y={}}const x=y.tool_name||y.name||"",P=y.continuation;return x==="therapy_session_transition"&&P})(),[h,d]=b.useState(l);if(c){let y={},x="unknown_tool";if(t.metadata){if(typeof t.metadata=="string")try{y=JSON.parse(t.metadata)}catch{y={}}else typeof t.metadata=="object"&&(y=t.metadata);x=y.tool_name||y.name||"unknown_tool"}if(x==="unknown_tool"&&t.content){if(t.content.includes("Starting formal brainspotting session"))x="therapy_session_transition";else if(t.content.includes("Recording stress level"))x="therapy_session_record_suds";else if(t.content.includes("Saving session data"))x="therapy_session_set_field";else if(t.content.startsWith("Called ")){const D=t.content.match(/Called (.+)/);D&&(x=D[1])}}const P=y.arguments||y.tool_args,C=y.tool_result,S=y.status||(C?"completed":"pending"),T=y.success===!0,k=y.continuation,L=x.replace(/_/g," ").replace(/therapy session /gi,"").split(" ").map(D=>D.charAt(0).toUpperCase()+D.slice(1)).join(" ");return u.jsx(oe.div,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},className:"flex justify-center my-4",children:u.jsxs("div",{className:"bg-slate-500/5 border border-slate-500/20 rounded-lg overflow-hidden w-full max-w-[600px] transition-all duration-200",children:[u.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 cursor-pointer hover:bg-slate-500/10 transition-colors",onClick:()=>d(!h),children:[S==="pending"||S==="executing"?u.jsx(Sr,{className:"w-4 h-4 text-gray-400 animate-pulse"}):T?u.jsx(Sr,{className:"w-4 h-4 text-green-400"}):u.jsx(Sr,{className:"w-4 h-4 text-red-400"}),u.jsx("span",{className:"font-mono text-slate-300 text-sm",children:L}),u.jsx("span",{className:`text-xs ml-auto ${S==="pending"||S==="executing"?"text-yellow-400":T?"text-green-400":"text-red-400"}`,children:S==="pending"||S==="executing"?"⏳":T?"✓":"✗"}),u.jsx("span",{className:`text-slate-400 text-xs ml-1 transition-transform duration-200 ${h?"rotate-180":""}`,children:"▼"})]}),u.jsx(oe.div,{initial:{height:0,opacity:0},animate:{height:h?"auto":0,opacity:h?1:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden",children:u.jsxs("div",{className:"px-4 pb-3 border-t border-slate-500/10",children:[k&&x==="therapy_session_transition"&&u.jsxs("div",{className:"mb-4",children:[u.jsx("div",{className:"text-xs text-slate-300/60 mb-2",children:"🚀 Therapy Session Start:"}),u.jsx("div",{className:"bg-gradient-to-r from-blue-500/10 to-purple-500/10 border border-blue-500/20 p-3 rounded-lg",children:u.jsx("div",{className:"text-sm text-slate-200 whitespace-pre-wrap leading-relaxed",children:k})})]}),u.jsxs("div",{className:"mb-3",children:[u.jsx("div",{className:"text-xs text-slate-300/60 mb-1",children:"Request:"}),u.jsx("pre",{className:"text-xs bg-black/20 p-2 rounded overflow-x-auto max-w-full text-slate-300/80 break-words",children:P?JSON.stringify(P,null,2):"No arguments data"})]}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs text-slate-300/60 mb-1",children:"Response:"}),u.jsx("pre",{className:"text-xs bg-black/20 p-2 rounded overflow-x-auto max-w-full text-slate-300/80 break-words",children:C?JSON.stringify(C,null,2):"No result data"})]})]})})]})})}const m=()=>{e&&r.trim()!==t.content&&e(t.id||"",r.trim()),s(!1)},p=()=>{i(t.content||""),s(!1)};return u.jsx(oe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`mb-4 group flex ${o?"justify-start":"justify-end"}`,children:u.jsxs("div",{className:`
        max-w-[75%] rounded-xl p-4 relative
        ${o?"bg-white/5 border border-white/10":"bg-blue-600/20 border border-blue-500/30"}
      `,children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("div",{className:`text-xs font-medium ${o?"text-white/70":"text-blue-200"}`,children:o?"Brainspotting Coach":"You"}),!o&&!n&&e&&u.jsx("button",{onClick:()=>s(!0),className:"opacity-0 group-hover:opacity-100 transition-opacity p-1 hover:bg-white/10 rounded",title:"Edit message",children:u.jsx(eA,{className:"w-3 h-3 text-white/60"})})]}),n?u.jsxs("div",{className:"space-y-3",children:[u.jsx("textarea",{value:r,onChange:y=>i(y.target.value),className:"w-full bg-black/30 border border-white/30 rounded-lg p-3 text-white/90 resize-none focus:outline-none focus:border-slate-400",rows:Math.max(2,(r.match(/\n/g)||[]).length+1),autoFocus:!0}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{onClick:m,className:"flex items-center gap-1 px-3 py-1.5 bg-green-600 hover:bg-green-700 rounded text-xs text-white font-medium",children:[u.jsx(wy,{className:"w-3 h-3"}),"Save & regenerate"]}),u.jsxs("button",{onClick:p,className:"flex items-center gap-1 px-3 py-1.5 bg-gray-600 hover:bg-gray-700 rounded text-xs text-white",children:[u.jsx(Iy,{className:"w-3 h-3"}),"Cancel"]})]})]}):u.jsx("div",{className:`leading-relaxed whitespace-pre-wrap ${o?"text-white/90":"text-white/95"}`,children:t.content}),!n&&t.created_at&&u.jsx("div",{className:`text-xs mt-2 ${o?"text-white/40":"text-blue-200/60"}`,children:new Date(t.created_at).toLocaleTimeString()})]})})},vj=({messages:t,className:e=""})=>{const n=b.useRef(null);if(b.useEffect(()=>{var r;(r=n.current)==null||r.scrollIntoView({behavior:"smooth"})},[t]),t.length===0)return u.jsx("div",{className:`flex items-center justify-center text-white/40 ${e}`,children:u.jsx("p",{children:"No messages yet. Start a conversation!"})});const s=t.filter(r=>r.content!=="[Generate initial greeting]");return u.jsxs("div",{className:`overflow-y-auto p-4 space-y-4 ${e}`,children:[s.map(r=>u.jsx(xj,{message:r},r.id)),u.jsx("div",{ref:n})]})},bj=({onSendMessage:t,disabled:e=!1,isCompleted:n=!1})=>{const[s,r]=b.useState(""),i=o=>{o.preventDefault(),s.trim()&&!e&&(t(s.trim()),r(""))};return u.jsx("form",{onSubmit:i,className:"border-t border-white/[0.05] p-4",children:u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"text",value:s,onChange:o=>r(o.target.value),placeholder:n?"Session Complete - No further input needed":e?"Connecting...":"Type your message...",disabled:e,className:`flex-1 px-4 py-2 border rounded-lg text-white/90 placeholder-white/30 outline-none transition-all ${n?"bg-green-500/5 border-green-400/20 cursor-not-allowed":"bg-white/[0.05] border-white/[0.1] focus:border-white/20 focus:bg-white/[0.08]"} disabled:opacity-50`}),!n&&u.jsx("button",{type:"submit",disabled:e||!s.trim(),className:"px-4 py-2 bg-blue-500/20 hover:bg-blue-500/30 border border-blue-500/30 rounded-lg text-blue-300 font-medium transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"Send"})]})})},Tj=({isConnected:t})=>t?null:u.jsx("div",{className:"bg-yellow-500/10 border-b border-yellow-500/20 px-4 py-2",children:u.jsx("p",{className:"text-sm text-yellow-300",children:"Connecting to session..."})}),Ej=({messages:t,isConnected:e,onSendMessage:n,onEditMessage:s,className:r="",isCompleted:i=!1})=>u.jsxs("div",{className:`flex flex-col h-full ${r}`,children:[u.jsx(Tj,{isConnected:e}),u.jsx(vj,{messages:t,onEditMessage:s,className:"flex-1"}),u.jsx(bj,{onSendMessage:n,disabled:!e||i,isCompleted:i})]}),Ij=({sessionId:t})=>{const[e,n]=b.useState([]);b.useEffect(()=>{s();const r=setInterval(s,2e3);return()=>clearInterval(r)},[t]);const s=async()=>{try{const r=await Pe(be(`/api/sessions/${t}/prompts`));if(r.ok){const i=await r.json();n(i)}}catch(r){console.error("Failed to fetch prompt logs:",r)}};return u.jsxs("div",{className:"h-full overflow-y-auto p-3 bg-black/20 font-mono text-xs",children:[u.jsxs("div",{className:"text-white/80 mb-4",children:[u.jsx("div",{className:"text-sm font-semibold mb-2",children:"RAW PROMPT LOG"}),u.jsxs("div",{className:"text-white/60",children:["Session: ",t]}),u.jsxs("div",{className:"text-white/60",children:["Total entries: ",e.length]})]}),u.jsxs("div",{className:"space-y-4",children:[e.map((r,i)=>{var o;return u.jsxs("div",{className:"border-l-2 border-white/20 pl-4",children:[u.jsxs("div",{className:"text-slate-400 mb-1",children:["[",r.timestamp,"] ",r.turn_type," - Phase: ",r.phase]}),r.turn_type==="REQUEST"&&r.user_message&&u.jsxs("div",{className:"mb-2",children:[u.jsx("div",{className:"text-blue-400/60 mb-1",children:"USER MESSAGE:"}),u.jsx("div",{className:"text-white/70 whitespace-pre-wrap bg-blue-500/10 p-2 rounded",children:r.user_message})]}),r.turn_type==="REQUEST"&&r.prompt&&u.jsxs("details",{className:"mt-2 mb-2",children:[u.jsxs("summary",{className:"cursor-pointer text-xs text-white/40 hover:text-white/60",children:["📝 Full Prompt (",r.prompt.length," chars)"]}),u.jsx("pre",{className:"mt-2 p-2 bg-black/40 rounded text-xs overflow-x-auto text-white/50 max-h-96 overflow-y-auto",children:r.prompt})]}),r.turn_type==="RESPONSE"&&u.jsxs("div",{className:"mb-2",children:[u.jsxs("div",{className:"text-green-400/60 mb-1",children:["AI RESPONSE (tokens: ",r.token_total||0,", tools: ",((o=r.function_calls)==null?void 0:o.length)||0,"):"]}),u.jsx("div",{className:"text-white/70 whitespace-pre-wrap bg-green-500/10 p-2 rounded",children:r.response_text}),r.function_calls&&r.function_calls.length>0&&u.jsxs("div",{className:"mt-2",children:[u.jsx("div",{className:"text-amber-400/60 mb-1",children:"TOOL CALLS:"}),u.jsx("div",{className:"text-white/60 bg-amber-500/10 p-2 rounded",children:u.jsx("pre",{children:JSON.stringify(r.function_calls,null,2)})})]})]})]},i)}),e.length===0&&u.jsx("div",{className:"text-white/40 text-center py-8",children:"No prompt logs yet. Start a conversation to see AI prompts and responses."})]})]})},Aj=({text:t})=>{const[e,n]=b.useState(!1),s=120,r=t.length>s?t.substring(0,s)+"...":t;return u.jsxs("div",{className:"w-full",children:[u.jsx("div",{className:"px-3 py-2 rounded-lg bg-gray-500/10 border border-gray-500/20",children:u.jsx("p",{className:"text-sm text-gray-200 leading-relaxed",children:e?t:r})}),t.length>s&&u.jsxs("div",{className:"flex items-center gap-3 mt-1.5 px-3",children:[u.jsx("button",{onClick:()=>n(!e),className:"text-[11px] text-blue-400 hover:text-blue-300 transition-colors",children:e?"Show less":"Show more"}),u.jsxs("span",{className:"text-[11px] text-gray-500",children:[t.length," chars"]})]})]})},Sj=({phaseData:t,data:e={},recentlyUpdatedFields:n=new Set,className:s=""})=>{const[r,i]=b.useState([]);return b.useEffect(()=>{const o=t.map(c=>{let l={};try{c.schema&&c.schema.startsWith("{")?l=JSON.parse(c.schema):l={type:c.schema||"string"}}catch{l={type:c.schema||"string"}}return{id:c.id||"",name:c.name||"",description:c.description,type:l.type||"string",required:c.required||!1,properties:l.properties,enum:l.enum,minimum:l.minimum,maximum:l.maximum,default:l.default}});i(o)},[t]),r.length?u.jsx("div",{className:`space-y-2 ${s}`,children:r.map(o=>u.jsx(Nj,{field:o,value:e[o.name],hasValue:e[o.name]!==void 0&&e[o.name]!==null&&e[o.name]!=="",isRecentlyUpdated:n.has(o.name),phaseData:t},o.id))}):u.jsx("div",{className:`text-center py-4 ${s}`,children:u.jsx("p",{className:"text-xs text-white/60",children:"No data fields defined for this phase"})})},Nj=({field:t,value:e,hasValue:n,isRecentlyUpdated:s=!1,phaseData:r})=>{const i=m=>m.replace(/_/g," ").split(" ").map(p=>p.toLowerCase()==="suds"?"SUDS":p.toLowerCase()==="id"?"ID":p.charAt(0).toUpperCase()+p.slice(1).toLowerCase()).join(" "),c=(()=>{const m=r.find(p=>p.id===t.id);if(!(m!=null&&m.schema))return{};try{return JSON.parse(m.schema)}catch{return{}}})(),l=m=>{if(t.type==="boolean")return m===!0?u.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-md bg-emerald-500/15 border border-emerald-500/25 text-xs text-emerald-400 font-medium",children:[u.jsx(wy,{className:"w-3 h-3 mr-1"}),"Yes"]}):m===!1?u.jsxs("span",{className:"inline-flex items-center px-2.5 py-1 rounded-md bg-red-500/15 border border-red-500/25 text-xs text-red-400 font-medium",children:[u.jsx(Iy,{className:"w-3 h-3 mr-1"}),"No"]}):null;if(t.type==="integer"){const p=(c==null?void 0:c.min)||t.minimum||0,y=(c==null?void 0:c.max)||t.maximum||10,x=(m-p)/(y-p)*100;return u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:"px-3 py-1.5 rounded-lg bg-slate-500/10 border border-slate-500/20",children:[u.jsx("span",{className:"text-sm font-semibold text-slate-300",children:m}),(p!==0||y!==10)&&u.jsxs("span",{className:"text-[10px] text-slate-400/60 ml-2",children:[p,"-",y]})]}),u.jsx("div",{className:"w-12 h-1 bg-gray-700/30 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-slate-400/40 transition-all duration-300",style:{width:`${Math.max(0,Math.min(100,x))}%`}})})]})}if(t.type==="number"){const p=typeof m=="number"?m.toFixed(2):m,y=(c==null?void 0:c.min)||t.minimum,x=(c==null?void 0:c.max)||t.maximum;return u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:"px-3 py-1.5 rounded-lg bg-purple-500/10 border border-purple-500/20",children:[u.jsx("span",{className:"text-sm font-semibold text-purple-300",children:p}),y!==void 0&&x!==void 0&&u.jsxs("span",{className:"text-[10px] text-purple-400/60 ml-2",children:[y,"-",x]})]}),y!==void 0&&x!==void 0&&u.jsx("div",{className:"w-12 h-1 bg-gray-700/30 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-purple-400/40 transition-all duration-300",style:{width:`${Math.max(0,Math.min(100,(m-y)/(x-y)*100))}%`}})})]})}if(t.type==="string"){const p=m&&m.length>150,y=m&&m.length>80&&m.length<=150;return p&&(m.includes(`
`)||m.length>200)?u.jsxs("div",{className:"w-full space-y-2",children:[u.jsx("div",{className:"px-4 py-3 rounded-xl bg-gray-500/8 border border-gray-500/15 max-w-full",children:u.jsx("div",{className:"text-sm text-gray-200 leading-relaxed whitespace-pre-wrap max-h-32 overflow-y-auto",children:m})}),u.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-gray-400",children:[u.jsxs("span",{children:[m.length," characters"]}),m.includes(`
`)&&u.jsx("span",{children:"• Multi-line"})]})]}):p||y?u.jsx(Aj,{text:m}):u.jsx("div",{className:"flex-1",children:u.jsx("div",{className:"px-3 py-1.5 rounded-lg bg-gray-500/10 border border-gray-500/20",children:u.jsx("span",{className:"text-sm text-gray-200 break-words",children:m})})})}if(t.enum&&t.enum.includes(m))return u.jsx("span",{className:"px-2.5 py-1 rounded-md bg-violet-500/15 border border-violet-500/25 text-xs text-violet-300 font-medium",children:String(m)});if(t.type==="array"&&Array.isArray(m))return u.jsx("div",{className:"flex items-center gap-2",children:u.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[m.slice(0,3).map((p,y)=>u.jsx("div",{className:"px-2.5 py-1 text-xs bg-indigo-500/10 border border-indigo-500/20 text-indigo-300 rounded-md",children:String(p)},y)),m.length>3&&u.jsxs("span",{className:"text-xs text-gray-400",children:["+",m.length-3," more"]})]})});if(t.type==="object"&&m&&typeof m=="object"){const p=Object.keys(m);return u.jsx("div",{className:"px-3 py-1.5 rounded-lg bg-cyan-500/10 border border-cyan-500/20",children:u.jsxs("span",{className:"text-sm font-medium text-cyan-300",children:[p.length," ",p.length===1?"field":"fields"]})})}return m!=null&&m!==""?u.jsx("span",{className:"text-white/80 text-sm",children:String(m)}):null},h=()=>t.type==="boolean"?u.jsx(yA,{className:"w-3.5 h-3.5 text-emerald-400/40"}):t.enum?u.jsx(Sf,{className:"w-3.5 h-3.5 text-violet-400/40"}):t.type==="integer"?u.jsx(Af,{className:"w-3.5 h-3.5 text-blue-400/40"}):t.type==="number"?u.jsx(Af,{className:"w-3.5 h-3.5 text-purple-400/40"}):t.type==="string"?u.jsx(TA,{className:"w-3.5 h-3.5 text-gray-400/40"}):t.type==="array"?u.jsx(Sf,{className:"w-3.5 h-3.5 text-indigo-400/40"}):t.type==="object"?u.jsx(JI,{className:"w-3.5 h-3.5 text-cyan-400/40"}):u.jsx(Hr,{className:"w-3.5 h-3.5 text-white/20"}),d=n&&t.type==="string"&&e&&e.length>40;return u.jsxs("div",{className:`
      relative rounded-lg px-4 py-3 transition-all duration-200
      ${n?"bg-white/[0.03] border border-white/15":"bg-white/[0.01] border border-white/5"}
      ${s?"ring-1 ring-emerald-400/40":""}
      backdrop-blur-sm hover:bg-white/[0.04]
    `,children:[d?u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[h(),u.jsx("span",{className:"text-white/80 text-sm font-medium",children:i(t.name)})]}),u.jsx("div",{className:"pl-5",children:l(e)})]}):u.jsxs("div",{className:"flex items-center justify-between gap-3",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[h(),u.jsx("span",{className:"text-white/80 text-sm font-medium",children:i(t.name)}),t.required&&!n&&u.jsx("span",{className:"text-amber-400/60 text-xs",children:"Required"})]}),u.jsx("div",{className:"flex-shrink-0",children:n?l(e):u.jsx(Hr,{className:"w-4 h-4 text-white/20"})})]}),!n&&t.description&&u.jsx("p",{className:"text-xs text-white/40 mt-1 pl-5",children:t.description})]})},ww={MessageCircle:GI,Target:Ey,Search:Bc,Settings:su,Brain:ys,BarChart2:lI,Zap:ru,Citrus:vI,Sprout:hA,CheckCircle2:Sr,Circle:Hr,Hand:PI,User:Nr,Eye:II,TrendingUp:vA,Heart:xy,Sparkles:Ty},Pj=(t,e,n=16)=>{const s=ww[t]||Hr;return u.jsx(s,{className:e,size:n})},Oo=({icon:t,className:e="",size:n=16})=>!ww[t]&&t.length<=2?u.jsx("span",{className:e,children:t}):Pj(t,e,n),Cj=({workflowStatus:t,currentPhase:e,phases:n=[],availableTransitions:s=[],isCompleted:r=!1})=>{const[i,o]=b.useState(new Set),[c]=b.useState(new Set),l=(t==null?void 0:t.phase_data_values)||{};console.log("🔍 WorkflowExplorer DEBUG:",{workflowStatus:t,phaseDataValues:l,phaseDataValuesKeys:Object.keys(l),phases:n==null?void 0:n.length,availableTransitions:s==null?void 0:s.length}),(n==null?void 0:n.length)>0&&console.log("🔍 First phase data structure:",n[0]);const h=b.useMemo(()=>n!=null&&n.length?n.map((x,P)=>{const C=x.phase_data||[],S={};let T=!1,k=0,L=0;C.forEach(E=>{E.required&&k++,E.name&&l[E.name]!==void 0&&l[E.name]!==null&&l[E.name]!==""&&(S[E.name]=l[E.name],T=!0,E.required&&L++)});const D=r?100:k>0?Math.round(L/k*100):100,V=s==null?void 0:s.some(E=>E.to_phase_id===x.id);return{...x,index:P,phaseData:C,values:S,hasData:T,isCurrent:!r&&x.id===e,hasTransition:V,requiredCount:k,requiredFilled:L,requiredPercentage:D,isSessionCompleted:r}}):[],[n,l,e,s,r]);b.useEffect(()=>{e&&!i.has(e)&&o(new Set([e]))},[e]);const d=x=>{o(P=>{const C=new Set(P);return C.has(x)?C.delete(x):C.add(x),C})},m=h.reduce((x,P)=>x+P.phaseData.length,0),p=Object.keys(l).filter(x=>l[x]!==void 0&&l[x]!==null&&l[x]!=="").length,y=r?100:m>0?p/m*100:0;return h.length?u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"flex items-center justify-between",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"p-2 rounded-lg bg-white/5 border border-white/10 backdrop-blur-sm",children:u.jsx(Kr,{className:"w-4 h-4 text-white/70"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-semibold text-white/90 tracking-wide",children:"Session Explorer"}),u.jsxs("p",{className:"text-xs text-white/50 mt-0.5",children:[p," of ",m," data points • ",h.length," phases"]})]})]})}),u.jsxs("div",{className:"relative rounded-xl p-3 backdrop-blur-md bg-gradient-to-br from-white/[0.03] to-transparent border border-white/10",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("span",{className:"text-xs text-white/60",children:r?"Session Complete!":"Session Progress"}),u.jsxs("span",{className:`text-xs font-medium ${r?"text-green-400":"text-white/70"}`,children:[Math.round(y),"%"]})]}),u.jsx("div",{className:"h-1 bg-black/20 rounded-full overflow-hidden",children:u.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${r?"bg-gradient-to-r from-green-500/60 to-green-600/60":"bg-gradient-to-r from-violet-500/60 to-violet-600/60"}`,style:{width:`${y}%`}})})]}),u.jsx("div",{className:"space-y-2",children:h.map(x=>{const P=i.has(x.id),C=Object.keys(x.values).length,S=x.phaseData.length;return u.jsxs("div",{className:`
                relative rounded-xl transition-all duration-300
                ${x.isCurrent?"ring-2 shadow-2xl scale-[1.02]":""}
                backdrop-blur-md
              `,style:{background:x.color?x.isCurrent?`linear-gradient(135deg, ${x.color}15 0%, ${x.color}08 100%)`:x.hasData?`linear-gradient(135deg, ${x.color}0A 0%, ${x.color}05 100%)`:"linear-gradient(135deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.01) 100%)":"linear-gradient(135deg, rgba(255,255,255,0.03) 0%, rgba(255,255,255,0.01) 100%)",borderColor:x.color?x.isCurrent?`${x.color}30`:`${x.color}15`:"rgba(255,255,255,0.1)",borderWidth:"1px",borderStyle:"solid",boxShadow:x.isCurrent&&x.color?`0 4px 12px ${x.color}10`:""},children:[u.jsxs("button",{onClick:()=>d(x.id),className:"w-full p-4 flex items-center gap-3 hover:bg-white/[0.02] transition-colors rounded-xl",children:[u.jsx("div",{className:`
                    w-10 h-10 rounded-lg flex items-center justify-center
                    backdrop-blur-sm border
                  `,style:{background:x.color?`linear-gradient(135deg, ${x.color}0A 0%, ${x.color}05 100%)`:"linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%)",borderColor:x.color?`${x.color}15`:"rgba(255,255,255,0.1)"},children:u.jsx(Oo,{icon:x.icon,className:"w-5 h-5",size:20})}),u.jsxs("div",{className:"flex-1 text-left",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-sm font-semibold",style:{color:x.isCurrent&&x.color?x.color:"rgba(255,255,255,0.9)"},children:x.display_name}),x.isCurrent&&u.jsx(ru,{className:"w-3.5 h-3.5",style:{color:`${x.color||"#10b981"}80`}})]}),u.jsxs("p",{className:"text-xs text-white/50 mt-0.5",children:[x.description,S>0&&u.jsxs(u.Fragment,{children:[x.description&&" • ",x.requiredCount>0?u.jsxs("span",{style:{color:x.requiredPercentage===100?`${x.color}99`:`${x.color||"#f59e0b"}99`},children:[x.requiredPercentage,"% complete"]}):u.jsxs("span",{className:"text-white/40",children:[C,"/",S," optional"]})]})]})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[x.hasData?u.jsx(Sr,{className:"w-5 h-5",style:{color:`${x.color}60`}}):u.jsx(Hr,{className:"w-5 h-5 text-white/20"}),u.jsx(nu,{className:`w-4 h-4 text-white/40 transition-transform ${P?"rotate-90":""}`})]})]}),P&&u.jsx("div",{className:"px-4 pb-4",children:u.jsx("div",{className:"border-t border-white/5 pt-4",children:x.phaseData&&x.phaseData.length>0?u.jsxs("div",{className:"space-y-3",children:[x.phaseData.length>0&&u.jsx("div",{className:"text-xs text-white/30 uppercase tracking-wider mb-3",children:"Required Data"}),u.jsx(Sj,{phaseData:x.phaseData,data:x.values,recentlyUpdatedFields:c})]}):u.jsx("p",{className:"text-xs text-white/40 text-center py-2",children:"No data requirements for this phase"})})})]},x.id)})})]}):u.jsxs("div",{className:"text-center py-8",children:[u.jsx(Kr,{className:"w-8 h-8 mx-auto mb-3 text-white/30"}),u.jsx("p",{className:"text-sm text-white/60",children:"Loading session data..."})]})};function Rj(t){const{protocol:e,hostname:n,port:s}=window.location;if(s==="5173"||s==="3000"){const c=`${e==="https:"?"wss:":"ws:"}//${n}:8083${t.startsWith("/")?t:`/${t}`}`;return console.log("Using local dev WebSocket URL:",c),c}const i=`${e==="https:"?"wss:":"ws:"}//${n}${s?`:${s}`:""}${t.startsWith("/")?t:`/${t}`}`;return console.log("Using same-origin WebSocket URL:",i),i}const kj={GET_WORKFLOW_STATUS:"get_workflow_status"},Dj=t=>{const[e,n]=b.useState(!1),s=b.useRef(null),r=b.useRef(),i=b.useRef(!1),o=b.useCallback(async()=>{var p;if(((p=s.current)==null?void 0:p.readyState)===WebSocket.OPEN||i.current)return;let h=Rj(`/api/sessions/${t}/ws`);const d=ve==null?void 0:ve.currentUser;if(d)try{const y=await d.getIdToken(),x=h.includes("?")?"&":"?";h=`${h}${x}token=${encodeURIComponent(y)}`}catch(y){console.error("Failed to get auth token for WebSocket:",y)}console.log("Connecting to WebSocket:",h.replace(/token=.*/,"token=***")),i.current=!0;const m=new WebSocket(h);return s.current=m,m.onopen=()=>{console.log("WebSocket connected"),i.current=!1,n(!0),r.current&&clearTimeout(r.current),console.log("🔄 WebSocket connected, requesting workflow status for session:",t),m.send(JSON.stringify({type:kj.GET_WORKFLOW_STATUS}))},m.onclose=y=>{console.log("WebSocket disconnected",{code:y.code,reason:y.reason}),i.current=!1,n(!1),!y.wasClean&&y.code!==1e3&&(console.log("Scheduling reconnect in 3 seconds..."),r.current=setTimeout(()=>{o()},3e3))},m.onerror=y=>{console.error("WebSocket error:",y),i.current=!1,n(!1)},m},[t]),c=b.useCallback(h=>{var d;((d=s.current)==null?void 0:d.readyState)===WebSocket.OPEN?s.current.send(JSON.stringify(h)):console.warn("WebSocket not connected, cannot send message")},[]),l=b.useCallback(h=>{var d;((d=s.current)==null?void 0:d.readyState)===WebSocket.OPEN?s.current.send(JSON.stringify(h)):console.warn("WebSocket not connected, cannot send typed message")},[]);return b.useEffect(()=>(o(),()=>{var h;r.current&&clearTimeout(r.current),((h=s.current)==null?void 0:h.readyState)===WebSocket.OPEN&&s.current.close()}),[o]),{ws:s.current,isConnected:e,sendMessage:c,sendTypedMessage:l,reconnect:o}},jj=t=>{const[e,n]=b.useState([]);return b.useEffect(()=>{if(!t)return;const i=o=>{var c,l;try{const h=JSON.parse(o.data);if(h.type==="initial_state"&&h.recent_messages){const d=h.recent_messages;if(Array.isArray(d)){const m=d.reverse().map(p=>({...p,metadata:p.metadata||(typeof p.metadata=="string"?p.metadata:null),tool_calls:p.tool_calls||[]}));console.log(`✅ Loaded ${m.length} initial messages from WebSocket initial_state`),n(m)}}else if(h.type==="message"&&h.message){console.log("Received message:",h.message);const d={...h.message,metadata:h.message.metadata||h.metadata||{},tool_calls:((c=h.message.metadata)==null?void 0:c.tool_calls)||((l=h.metadata)==null?void 0:l.tool_calls)||[]};n(m=>{var y;const p=m.findIndex(x=>x.id===h.message.id);if(p>=0){console.log("🔄 Updating existing message:",h.message.id);const x=[...m];x[p]=d;const P=d.metadata;if(typeof P=="string")try{const S=(y=JSON.parse(P).tool_result)==null?void 0:y.data;S!=null&&S.to_phase&&(S!=null&&S.from_phase)&&(console.log("🔄 DETECTED PHASE TRANSITION:",S),window.dispatchEvent(new CustomEvent("phase_transition",{detail:{from_phase:S.from_phase,to_phase:S.to_phase,success:S.success,timestamp:Date.now()}})))}catch(C){console.error("Error parsing tool metadata for phase transition:",C)}return x}else return console.log("➕ Adding new message:",h.message.id),[...m,d]})}else if(h.type==="messages"&&h.messages){const d=h.messages.map(m=>({...m,metadata:m.metadata||(typeof m.metadata=="string"?m.metadata:null),tool_calls:m.tool_calls||[]}));console.log(`Loaded ${d.length} messages from WebSocket`),n(d)}}catch(h){console.error("Error parsing WebSocket message:",h)}};return t.addEventListener("message",i),()=>{t.removeEventListener("message",i)}},[t]),{messages:e,addMessage:i=>{n(o=>[...o,i])},clearMessages:()=>{n([])}}};var wp;(t=>{(e=>{e.SUGGESTION="suggestion",e.WARNING="warning",e.ENCOURAGEMENT="encouragement",e.TECHNIQUE="technique",e.QUESTION="question"})(t.type||(t.type={}))})(wp||(wp={}));var xp;(t=>{(e=>{e.SUGGESTION="suggestion",e.WARNING="warning",e.ENCOURAGEMENT="encouragement",e.TECHNIQUE="technique",e.QUESTION="question"})(t.type||(t.type={}))})(xp||(xp={}));var Vn;(t=>{(e=>{e.SCHEDULED="scheduled",e.IN_PROGRESS="in_progress",e.COMPLETED="completed",e.CANCELLED="cancelled"})(t.status||(t.status={}))})(Vn||(Vn={}));var vp;(t=>{(e=>{e.PENDING="pending",e.IN_PROGRESS="in_progress",e.COMPLETED="completed",e.SKIPPED="skipped"})(t.status||(t.status={}))})(vp||(vp={}));var bp;(t=>{(e=>{e.PENDING="pending",e.IN_PROGRESS="in_progress",e.COMPLETED="completed",e.SKIPPED="skipped"})(t.status||(t.status={}))})(bp||(bp={}));const Vj=(t,e)=>{const[n,s]=b.useState(null),[r,i]=b.useState(!0),[o,c]=b.useState(!1),[l,h]=b.useState(),[d,m]=b.useState(),[p,y]=b.useState(Vn.status.SCHEDULED),[x,P]=b.useState("");b.useEffect(()=>{if(!t)return;const T=V=>{var E,v,I,N;try{const A=JSON.parse(V.data);if(A.type==="initial_state"||A.type==="session_updated"){const R={phase:A.phase||"",current_state:A.phase||"",phase_data_values:A.phase_data_values||{},phases:A.phases||[],recent_messages:A.recent_messages||[],session_id:e,session_status:A.session_status||Vn.status.SCHEDULED};A.session_status&&y(A.session_status),console.log("🔄 SESSION STATUS UPDATE:",{type:A.type,phase:A.phase,phase_data_values:A.phase_data_values,phases:(E=A.phases)==null?void 0:E.length,fullData:A}),s(R),i(!1),A.type==="initial_state"&&A.recent_messages&&console.log("📨 Initial messages received:",A.recent_messages)}else if(A.type==="workflow_update"){const R=A.phase_data_values||{},_=A.phase;console.log("🔄 WORKFLOW UPDATE:",{phase:_,phase_data_values:R,fullData:A}),s(B=>B?{...B,phase:_||B.phase,current_state:_||B.current_state,phase_data_values:R}:{phase:_||"",current_state:_||"",phase_data_values:R,phases:[],recent_messages:[],session_id:e}),i(!1)}else if(A.type==="phase_transition"){const R=A.phase_data_values,_=(v=A.metadata)==null?void 0:v.from_phase,B=((I=A.metadata)==null?void 0:I.to_phase)||A.phase,Z=(N=A.metadata)==null?void 0:N.reason;console.log("🔄 PHASE TRANSITION EVENT:",{from:_,to:B,reason:Z,phase_data_values:R,data:A}),s(ae=>{if(!ae)return{phase:B||"",current_state:B||"",phase_data_values:R||{},phases:[],recent_messages:[],session_id:e,last_transition:{from:_||"",to:B||"",reason:Z||"Phase transition",timestamp:A.timestamp}};const te={...ae,current_state:B||ae.current_state,phase:B||ae.phase,...R&&{phase_data_values:R},last_transition:{from:_||"",to:B||"",reason:Z||"Phase transition",timestamp:A.timestamp}};return console.log("🔄 UPDATING WORKFLOW STATE:",{prevStatus:ae,newStatus:te}),te}),i(!1),t.readyState===WebSocket.OPEN&&setTimeout(()=>{t.send(JSON.stringify({type:"get_workflow_status"}))},500)}else if(A.type&&typeof A.type=="string"&&A.type.startsWith("phase_timer_")){const R=A.metadata||{};A.type==="phase_timer_completed"?(console.log("⏰ TIMER COMPLETED for phase:",R.phase),h({elapsed:Number(R.total??600),remaining:0,total:Number(R.total??600),phase:String(R.phase||"")})):h({elapsed:Number(R.elapsed??0),remaining:Number(R.remaining??0),total:Number(R.total??0),phase:String(R.phase||"")}),i(!1)}else if(A.type==="session_paused")console.log("⏸️ SESSION PAUSED"),c(!0);else if(A.type==="session_resumed")console.log("▶️ SESSION RESUMED"),c(!1);else if(A.type==="session_completed")console.log("🎉 SESSION COMPLETED EVENT:",A),s(R=>R&&{...R,session_status:Vn.status.COMPLETED,completion_timestamp:A.timestamp||new Date().toISOString()}),y(Vn.status.COMPLETED),i(!1);else if(A.type==="timer_update"){const R=A.metadata;R&&(console.log("⏱️ TIMER UPDATE received:",{session_elapsed:R.session_elapsed_seconds,phase_elapsed:R.phase_elapsed_seconds,is_paused:R.is_paused}),m(R),R.is_paused!==void 0&&c(R.is_paused))}}catch(A){console.error("Error parsing workflow update:",A)}};t.addEventListener("message",T);const k=V=>{const E=V;console.log("🔄 CUSTOM PHASE TRANSITION EVENT:",E.detail);const{from_phase:v,to_phase:I,timestamp:N}=E.detail;s(A=>{if(!A)return A;const R={...A,current_state:I,phase:I,last_transition:{from:v,to:I,reason:"Tool call detected transition",timestamp:N}};return console.log("🔄 UPDATING WORKFLOW STATE FROM CUSTOM EVENT:",{prevStatus:A,newStatus:R}),R}),i(!1),t&&t.readyState===WebSocket.OPEN&&setTimeout(()=>{t.send(JSON.stringify({type:"get_workflow_status"}))},500)};window.addEventListener("phase_transition",k);const L=()=>{t.readyState===WebSocket.OPEN&&t.send(JSON.stringify({type:"get_workflow_status"}))};L();const D=()=>{L()};return t.addEventListener("open",D),()=>{t.removeEventListener("message",T),t.removeEventListener("open",D),window.removeEventListener("phase_transition",k)}},[t,e]),b.useEffect(()=>{const T=(n==null?void 0:n.current_state)||"";n&&T!=="pre_session"&&T&&console.log("🎬 Session started:",new Date),T&&T!==x&&(P(T),console.log(`🔄 Phase changed to ${T}:`,new Date))},[n==null?void 0:n.current_state,x]);const C=(n==null?void 0:n.current_state)||"",S=p===Vn.status.COMPLETED;return{workflowStatus:n,currentPhase:C,isLoading:r,isPaused:o,timer:l,sessionTimer:d,sessionStatus:p,isCompleted:S}},Mj=({sessionId:t})=>{if(!t)return u.jsx("div",{className:"flex items-center justify-center h-full text-white/60",children:"No session ID provided"});const{ws:e,isConnected:n,sendMessage:s}=Dj(t),{messages:r}=jj(e),{workflowStatus:i,isPaused:o,sessionTimer:c,isCompleted:l}=Vj(e,t),[h,d]=b.useState("workflow"),[m,p]=b.useState(!1),[y,x]=b.useState(null),[P,C]=b.useState([]),S=(i==null?void 0:i.phase)||(i==null?void 0:i.current_state)||"",T=(i==null?void 0:i.phase_description)||"";co.useEffect(()=>{Pe(be("/api/phases")).then(V=>V.json()).then(V=>{if(console.log("Loaded phases with data:",V),C(V),S){const E=V.find(v=>v.id===S);E&&x(E)}}).catch(V=>console.error("Failed to load phases:",V))},[S]);const k=co.useMemo(()=>{if(S){const V=P.find(E=>E.id===S);return{id:S,display_name:(V==null?void 0:V.display_name)||S.replace(/_/g," ").replace(/\b\w/g,E=>E.toUpperCase()),description:T||(V==null?void 0:V.description)||"",color:V==null?void 0:V.color,icon:(V==null?void 0:V.icon)||"Circle",phase_data:(i==null?void 0:i.phase_data)||[],phase_data_values:(i==null?void 0:i.phase_data_values)||{},transitions:(i==null?void 0:i.transitions)||[],available_tools:(i==null?void 0:i.available_tools)||[]}}return y},[S,T,P,i,y]);console.log("🔧 SessionDashboard debug:",{workflowStatus:i,currentPhase:S,displayPhaseInfo:k,phases:i==null?void 0:i.phases,sessionTimer:c,isPaused:o}),console.log("⏱️ Timer Debug:",{sessionTimer:c,hasSessionTimer:!!c,phase_elapsed:c==null?void 0:c.phase_elapsed_seconds,session_elapsed:c==null?void 0:c.session_elapsed_seconds,is_paused:c==null?void 0:c.is_paused});const L=V=>{s({type:"message",content:V,role:"patient"})},D=k==null?void 0:k.color;return u.jsxs("div",{className:"flex flex-col h-screen bg-black overflow-hidden",children:[u.jsx("div",{className:"sticky top-0 z-50 backdrop-blur-xl border-b transition-all duration-500",style:{backgroundColor:`${D}18`,borderColor:`${D}40`,boxShadow:`0 4px 24px -4px ${D}25`},children:u.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[k?u.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 rounded-xl backdrop-blur-md transition-all duration-300 hover:scale-105",style:{background:`linear-gradient(135deg, ${k.color}25 0%, ${k.color}15 100%)`,border:`1px solid ${k.color}50`,boxShadow:`0 0 20px ${k.color}20, inset 0 0 20px ${k.color}10`},children:[u.jsx(Oo,{icon:l?"CheckCircle":k.icon,className:l?"text-white":"text-white animate-pulse",size:18}),u.jsxs("div",{className:"flex flex-col",children:[u.jsx("span",{className:"text-sm font-medium text-white/90",children:l?"Complete!":k.display_name}),(k.description||l)&&u.jsx("span",{className:"text-xs text-white/50 truncate max-w-[300px]",children:l?`Completed at ${i!=null&&i.completion_timestamp?new Date(i.completion_timestamp).toLocaleTimeString():new Date().toLocaleTimeString()}`:k.description})]})]}):u.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 rounded-xl backdrop-blur-md bg-white/5 border border-white/10",children:[u.jsx("div",{className:"w-5 h-5 bg-white/10 rounded-full animate-pulse"}),u.jsxs("div",{className:"flex flex-col gap-1",children:[u.jsx("div",{className:"w-24 h-3 bg-white/10 rounded animate-pulse"}),u.jsx("div",{className:"w-16 h-2 bg-white/5 rounded animate-pulse"})]})]}),u.jsx("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-xl backdrop-blur-md bg-white/[0.03] border border-white/10",children:u.jsxs("div",{className:"flex items-center gap-1.5",children:[u.jsx("button",{className:`p-2 rounded-lg transition-all ${o?"bg-green-500/10 border border-green-400/30 text-green-400/60 hover:bg-green-500/20 hover:scale-105 cursor-pointer":"bg-green-500/30 border-2 border-green-400 text-green-400 shadow-[0_0_20px_rgba(34,197,94,0.5)] cursor-default"}`,onClick:()=>{o&&s({type:"resume_session"})},title:"Play",children:u.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{d:"M6.3 2.841A1.5 1.5 0 004 4.11V15.89a1.5 1.5 0 002.3 1.269l9.344-5.89a1.5 1.5 0 000-2.538L6.3 2.84z"})})}),u.jsx("button",{className:`p-2 rounded-lg transition-all ${o?"bg-yellow-500/30 border-2 border-yellow-400 text-yellow-400 shadow-[0_0_20px_rgba(250,204,21,0.5)] cursor-default":"bg-yellow-500/10 border border-yellow-400/30 text-yellow-400/60 hover:bg-yellow-500/20 hover:scale-105 cursor-pointer"}`,onClick:()=>{o||s({type:"pause_session"})},title:"Pause",children:u.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{d:"M5.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75A.75.75 0 007.25 3h-1.5zM12.75 3a.75.75 0 00-.75.75v12.5c0 .414.336.75.75.75h1.5a.75.75 0 00.75-.75V3.75a.75.75 0 00-.75-.75h-1.5z"})})}),c&&S!=="pre_session"&&u.jsxs("div",{className:"flex items-center gap-1.5 ml-2",children:[u.jsxs("button",{className:"relative w-8 h-8 rounded-lg bg-white/[0.03] hover:bg-white/[0.08] border transition-all duration-200 group",style:{borderColor:`${D}30`},onClick:()=>p(!m),title:`Time in Current Phase: ${Math.floor((c.phase_elapsed_seconds||0)/60)} minutes`,children:[u.jsxs("svg",{className:"absolute inset-0 w-8 h-8 -rotate-90",children:[u.jsx("circle",{cx:"16",cy:"16",r:"12",fill:"none",stroke:`${D}20`,strokeWidth:"2"}),u.jsx("circle",{cx:"16",cy:"16",r:"12",fill:"none",stroke:D,strokeOpacity:"0.6",strokeWidth:"2",strokeDasharray:`${Math.min(75.4,(c.phase_elapsed_seconds||0)/900*75.4)} 75.4`,className:"transition-all duration-1000"})]}),u.jsx("span",{className:"absolute inset-0 flex items-center justify-center",children:u.jsx("span",{className:"text-[9px] font-bold",style:{color:`${D}`},children:Math.floor((c.phase_elapsed_seconds||0)/60)})}),u.jsx("span",{className:"absolute -bottom-5 left-1/2 -translate-x-1/2 text-[8px] opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",style:{color:`${D}60`},children:"Phase"})]}),u.jsxs("button",{className:"relative w-8 h-8 rounded-lg bg-white/[0.03] hover:bg-white/[0.08] border border-white/[0.08] transition-all duration-200 group",onClick:()=>p(!m),title:`Session Time: ${Math.floor((c.session_elapsed_seconds||0)/60)} minutes elapsed`,children:[u.jsxs("svg",{className:"absolute inset-0 w-8 h-8 -rotate-90",children:[u.jsx("circle",{cx:"16",cy:"16",r:"12",fill:"none",stroke:`${D}20`,strokeWidth:"2"}),u.jsx("circle",{cx:"16",cy:"16",r:"12",fill:"none",stroke:D,strokeOpacity:"0.6",strokeWidth:"2",strokeDasharray:`${Math.max(0,75.4-(c.session_elapsed_seconds||0)/3600*75.4)} 75.4`,className:"transition-all duration-1000"})]}),u.jsx("span",{className:"absolute inset-0 flex items-center justify-center",children:u.jsx("span",{className:"text-[9px] font-bold",style:{color:`${D}`},children:Math.floor((c.session_elapsed_seconds||0)/60)})}),u.jsx("span",{className:"absolute -bottom-5 left-1/2 -translate-x-1/2 text-[8px] opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap",style:{color:`${D}60`},children:"Phase"})]}),m&&u.jsxs("div",{className:"flex items-center gap-3 px-3 py-1.5 ml-2 rounded-lg backdrop-blur-md animate-fade-in",style:{background:`linear-gradient(135deg, ${D}08 0%, ${D}03 100%)`,border:`1px solid ${D}15`},children:[u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("span",{className:"text-[9px] uppercase tracking-wider",style:{color:`${D}60`},children:"Phase Time"}),u.jsx("span",{className:"text-sm font-mono tabular-nums",style:{color:`${D}`},children:(()=>{const V=c.phase_elapsed_seconds||0,E=Math.floor(V/60),v=V%60;return`${String(E).padStart(2,"0")}:${String(v).padStart(2,"0")}`})()}),u.jsx("span",{className:"text-[8px]",style:{color:`${D}50`},children:"elapsed"})]}),u.jsx("div",{className:"w-px h-8 bg-white/10"}),u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsx("span",{className:"text-[9px] text-white/40 uppercase tracking-wider",children:"Session Time"}),u.jsx("span",{className:"text-sm font-mono text-white/90 tabular-nums",children:(()=>{const V=c.session_elapsed_seconds||0,E=Math.floor(V/60),v=V%60;return`${String(E).padStart(2,"0")}:${String(v).padStart(2,"0")}`})()}),u.jsx("span",{className:"text-[8px] text-white/30",children:"elapsed"})]})]})]})]})})]}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"flex items-center backdrop-blur-md bg-white/[0.03] rounded-xl border border-white/10 p-1",children:[u.jsxs("button",{onClick:()=>d(h==="workflow"?null:"workflow"),className:`px-3 py-1.5 rounded-lg text-xs font-medium flex items-center gap-1.5 transition-all duration-200 ${h==="workflow"?"bg-white/[0.1] text-white shadow-lg shadow-white/5 border border-white/10":"text-white/60 hover:text-white/80 hover:bg-white/[0.05]"}`,children:[u.jsx(Kr,{className:"w-3.5 h-3.5"}),"Explorer"]}),u.jsxs("button",{onClick:()=>d(h==="prompts"?null:"prompts"),className:`px-3 py-1.5 rounded-lg text-xs font-medium flex items-center gap-1.5 transition-all duration-200 ${h==="prompts"?"bg-white/[0.1] text-white shadow-lg shadow-white/5 border border-white/10":"text-white/60 hover:text-white/80 hover:bg-white/[0.05]"}`,children:[u.jsx(Gr,{className:"w-3.5 h-3.5"}),"Prompts"]})]}),u.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-xl backdrop-blur-md bg-white/[0.03] border border-white/10",children:[u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:`w-2 h-2 rounded-full ${n?"bg-green-500":"bg-red-500"}`}),n&&u.jsx("div",{className:"absolute inset-0 w-2 h-2 rounded-full bg-green-500 animate-ping"})]}),u.jsx("span",{className:"text-xs font-medium text-white/60",children:n?"Connected":"Disconnected"}),u.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to end this session? This action cannot be undone.")&&s({type:"stop_session"})},className:"ml-2 text-[10px] text-red-400/40 hover:text-red-400/80 transition-colors",title:"End Session",children:"End"})]})]})]})}),u.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[u.jsx("div",{className:"flex-1 flex flex-col",children:u.jsx(Ej,{messages:r,isConnected:n,onSendMessage:L,isCompleted:l})}),h&&u.jsx("div",{className:"w-96 border-l border-cyan-400/30 bg-black/50 p-4",children:u.jsxs("div",{className:"h-full flex flex-col",children:[h==="workflow"&&u.jsx("div",{className:"flex-1 overflow-y-auto",children:u.jsx(Cj,{sessionId:t,workflowStatus:i,currentPhase:S,phases:P,availableTransitions:i==null?void 0:i.transitions,isCompleted:l})}),h==="prompts"&&u.jsxs(u.Fragment,{children:[u.jsxs("h3",{className:"text-white/80 text-sm font-medium mb-4 flex items-center gap-2",children:[u.jsx(Gr,{className:"w-4 h-4"}),"Prompt Explorer"]}),u.jsx("div",{className:"flex-1 overflow-hidden",children:u.jsx(Ij,{sessionId:t})})]})]})})]})]})},Lj=()=>{var Z,ae,te;const t=()=>{const O=window.location.hash.slice(1);return["phases","prompts","data","visualization"].includes(O)?O:"phases"},[e,n]=b.useState(t()),s=O=>{n(O),window.location.hash=O},[r,i]=b.useState([]),[o,c]=b.useState(null),[l,h]=b.useState({}),[d,m]=b.useState([]),[p,y]=b.useState({}),[x,P]=b.useState(!0),[C,S]=b.useState(!1),[T,k]=b.useState(null),[L,D]=b.useState(""),[V,E]=b.useState(!1);b.useEffect(()=>{v()},[]);const v=async()=>{try{P(!0);const O=await Pe(be("/api/phases"));if(O.ok){const je=await O.json();i(je.sort((Ke,$e)=>Ke.position-$e.position)),je.length>0&&!o&&c(je[0])}const J=await Pe(be("/api/workflow/prompts"));if(J.ok){const je=await J.json(),Ke={};je.forEach($e=>{const ht=$e.phase_id||$e.workflow_phase;ht&&(Ke[ht]={...$e,phase_id:ht})}),h(Ke)}const fe=await Pe(be("/api/phase-data"));if(fe.ok){const je=await fe.json(),Ke={};je.forEach($e=>{Ke[$e.phase_id]||(Ke[$e.phase_id]=[]),Ke[$e.phase_id].push($e)}),y(Ke)}}catch(O){console.error("Error loading workflow data:",O)}finally{P(!1)}},I=async()=>{if(T){S(!0);try{const O=await Pe(be(`/api/phases/${T.id}`),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({display_name:T.display_name,description:T.description,color:T.color,icon:T.icon,min_turns:T.minimum_turns||0,recommended_duration:T.recommended_duration_seconds||0,max_duration:T.duration_seconds||0})});if(O.ok){const J=await O.json();i(r.map(fe=>fe.id===J.id?J:fe)),c(J),k(null)}}catch(O){console.error("Error saving phase:",O)}finally{S(!1)}}},N=async()=>{if(!(!o||!L)){S(!0);try{const O=l[o.id],J=be(O?`/api/prompts/${O.id}`:"/api/prompts"),fe=await Pe(J,{method:O?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phase_id:o.id,content:L})});if(fe.ok){const je=await fe.json();h({...l,[o.id]:je}),D("")}}catch(O){console.error("Error saving prompt:",O)}finally{S(!1)}}},A=async O=>{try{const J=await Pe(be(`/api/prompts/history/${O}`));if(J.ok){const fe=await J.json();m(fe),E(!0)}}catch(J){console.error("Error loading prompt history:",J)}},R=async O=>{var J;if(o){S(!0);try{(await Pe(be(`/api/prompts/${(J=l[o.id])==null?void 0:J.id}/revert/${O}`),{method:"PUT"})).ok&&(await v(),E(!1))}catch(fe){console.error("Error reverting prompt:",fe)}finally{S(!1)}}},_=["Brain","Target","Eye","Lightbulb","Heart","Compass","Map","Activity","Zap","CheckCircle"],B=["#8b5cf6","#3b82f6","#10b981","#f59e0b","#ef4444","#ec4899","#6366f1","#14b8a6","#f97316","#84cc16"];return x?u.jsx("div",{className:"flex items-center justify-center min-h-screen",children:u.jsx("div",{className:"text-white/60",children:"Loading workflow data..."})}):u.jsx("div",{className:"min-h-screen bg-black text-white p-6",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("div",{className:"mb-8",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[u.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-violet-500/20 to-violet-600/10 border border-violet-500/20",children:u.jsx(Kr,{className:"w-6 h-6 text-violet-400"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold",children:"Workflow Studio"}),u.jsx("p",{className:"text-white/60 text-sm",children:"Configure phases, prompts, and workflow requirements"})]})]}),u.jsxs("div",{className:"flex gap-2 border-b border-white/10 pb-2",children:[u.jsxs("button",{onClick:()=>s("phases"),className:`px-4 py-2 rounded-lg flex items-center gap-2 transition-colors ${e==="phases"?"bg-white/10 text-white":"text-white/60 hover:text-white hover:bg-white/5"}`,children:[u.jsx(su,{className:"w-4 h-4"}),"Phases"]}),u.jsxs("button",{onClick:()=>s("prompts"),className:`px-4 py-2 rounded-lg flex items-center gap-2 transition-colors ${e==="prompts"?"bg-white/10 text-white":"text-white/60 hover:text-white hover:bg-white/5"}`,children:[u.jsx(Gr,{className:"w-4 h-4"}),"Prompts"]}),u.jsxs("button",{onClick:()=>s("data"),className:`px-4 py-2 rounded-lg flex items-center gap-2 transition-colors ${e==="data"?"bg-white/10 text-white":"text-white/60 hover:text-white hover:bg-white/5"}`,children:[u.jsx(Xa,{className:"w-4 h-4"}),"Phase Data"]}),u.jsxs("button",{onClick:()=>s("visualization"),className:`px-4 py-2 rounded-lg flex items-center gap-2 transition-colors ${e==="visualization"?"bg-white/10 text-white":"text-white/60 hover:text-white hover:bg-white/5"}`,children:[u.jsx(LI,{className:"w-4 h-4"}),"Visualization"]})]})]}),u.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[u.jsx("div",{className:"col-span-3",children:u.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 p-4",children:[u.jsx("h3",{className:"text-sm font-semibold text-white/70 mb-3",children:"Workflow Phases"}),u.jsx("div",{className:"space-y-2",children:r.map(O=>u.jsx("button",{onClick:()=>{var J;c(O),e==="prompts"&&D(((J=l[O.id])==null?void 0:J.content)||"")},className:`w-full text-left p-3 rounded-lg transition-all ${(o==null?void 0:o.id)===O.id?"bg-white/10 border border-white/20":"hover:bg-white/5 border border-transparent"}`,children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center backdrop-blur-sm border",style:{background:O.color?`linear-gradient(135deg, ${O.color}20 0%, ${O.color}10 100%)`:"linear-gradient(135deg, rgba(255,255,255,0.05) 0%, rgba(255,255,255,0.02) 100%)",borderColor:O.color?`${O.color}30`:"rgba(255,255,255,0.1)"},children:u.jsx(Oo,{icon:O.icon||"",className:"w-4 h-4"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("div",{className:"text-sm font-medium",children:O.display_name}),u.jsxs("div",{className:"text-xs text-white/40",children:["Order: ",O.position]})]}),u.jsx(nu,{className:"w-4 h-4 text-white/30"})]})},O.id))})]})}),u.jsx("div",{className:"col-span-9",children:u.jsxs(kc,{mode:"wait",children:[e==="phases"&&o&&u.jsxs(oe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-white/5 rounded-xl border border-white/10 p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h2",{className:"text-xl font-semibold",children:"Phase Configuration"}),T?u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>k(null),className:"px-4 py-2 rounded-lg bg-white/5 hover:bg-white/10",children:"Cancel"}),u.jsxs("button",{onClick:I,disabled:C,className:"px-4 py-2 rounded-lg bg-violet-500 hover:bg-violet-600 flex items-center gap-2",children:[u.jsx(Nf,{className:"w-4 h-4"}),"Save Changes"]})]}):u.jsxs("button",{onClick:()=>k({...o}),className:"px-4 py-2 rounded-lg bg-white/5 hover:bg-white/10 flex items-center gap-2",children:[u.jsx(nA,{className:"w-4 h-4"}),"Edit Phase"]})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-white/60 mb-2",children:"Display Name"}),u.jsx("input",{type:"text",value:(T==null?void 0:T.display_name)||o.display_name,onChange:O=>T&&k({...T,display_name:O.target.value}),disabled:!T,className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg focus:border-violet-500 focus:outline-none"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-white/60 mb-2",children:"Order"}),u.jsx("input",{type:"number",value:o.position,disabled:!0,className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg opacity-50"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-white/60 mb-2",children:"Description"}),u.jsx("textarea",{value:(T==null?void 0:T.description)||o.description,onChange:O=>T&&k({...T,description:O.target.value}),disabled:!T,rows:3,className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg focus:border-violet-500 focus:outline-none"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-white/60 mb-2",children:"Icon"}),u.jsxs("select",{value:(T==null?void 0:T.icon)||o.icon||"",onChange:O=>T&&k({...T,icon:O.target.value}),disabled:!T,className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg focus:border-violet-500 focus:outline-none",children:[u.jsx("option",{value:"",children:"Default"}),_.map(O=>u.jsx("option",{value:O,children:O},O))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm text-white/60 mb-2",children:"Color"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"text",value:(T==null?void 0:T.color)||o.color||"",onChange:O=>T&&k({...T,color:O.target.value}),disabled:!T,className:"flex-1 px-3 py-2 bg-white/5 border border-white/10 rounded-lg focus:border-violet-500 focus:outline-none"}),T&&u.jsx("div",{className:"flex gap-1",children:B.map(O=>u.jsx("button",{onClick:()=>k({...T,color:O}),className:"w-8 h-8 rounded",style:{backgroundColor:O}},O))})]})]})]}),u.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm text-white/60 mb-2",children:[u.jsx(cn,{className:"w-4 h-4 inline mr-1"}),"Min Turns"]}),u.jsx("input",{type:"number",value:(T==null?void 0:T.minimum_turns)||o.minimum_turns||0,onChange:O=>T&&k({...T,minimum_turns:parseInt(O.target.value)||0}),disabled:!T,min:"0",className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg focus:border-violet-500 focus:outline-none"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm text-white/60 mb-2",children:[u.jsx(If,{className:"w-4 h-4 inline mr-1"}),"Recommended Duration (sec)"]}),u.jsx("input",{type:"number",value:(T==null?void 0:T.recommended_duration_seconds)||o.recommended_duration_seconds||0,onChange:O=>T&&k({...T,recommended_duration_seconds:parseInt(O.target.value)||0}),disabled:!T,min:"0",className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg focus:border-violet-500 focus:outline-none"})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm text-white/60 mb-2",children:[u.jsx(pA,{className:"w-4 h-4 inline mr-1"}),"Max Duration (sec)"]}),u.jsx("input",{type:"number",value:(T==null?void 0:T.duration_seconds)||o.duration_seconds||0,onChange:O=>T&&k({...T,duration_seconds:parseInt(O.target.value)||0}),disabled:!T,min:"0",placeholder:"Optional",className:"w-full px-3 py-2 bg-white/5 border border-white/10 rounded-lg focus:border-violet-500 focus:outline-none"})]})]})]})]},"phases"),e==="prompts"&&o&&u.jsxs(oe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-white/5 rounded-xl border border-white/10 p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-semibold",children:"Prompt Configuration"}),l[o.id]&&u.jsxs("p",{className:"text-sm text-white/50 mt-1",children:["Version ",l[o.id].version," • Last updated: ",new Date(l[o.id].updated_at).toLocaleDateString()]})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{onClick:()=>A(o.id),className:"px-4 py-2 rounded-lg bg-white/5 hover:bg-white/10 flex items-center gap-2",children:[u.jsx(DI,{className:"w-4 h-4"}),"History"]}),u.jsxs("button",{onClick:N,disabled:C||!L,className:"px-4 py-2 rounded-lg bg-violet-500 hover:bg-violet-600 flex items-center gap-2",children:[u.jsx(Nf,{className:"w-4 h-4"}),"Save Prompt"]})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm text-white/60 mb-2",children:["Prompt Content for ",o.display_name]}),u.jsx("textarea",{value:L||((Z=l[o.id])==null?void 0:Z.content)||"",onChange:O=>D(O.target.value),placeholder:"Enter the prompt content for this phase...",rows:15,className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg focus:border-violet-500 focus:outline-none font-mono text-sm"})]}),L&&L!==((ae=l[o.id])==null?void 0:ae.content)&&u.jsxs("div",{className:"flex items-center gap-2 text-yellow-400 text-sm",children:[u.jsx(zr,{className:"w-4 h-4"}),u.jsx("span",{children:"You have unsaved changes"})]})]})]},"prompts"),e==="data"&&o&&u.jsxs(oe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-white/5 rounded-xl border border-white/10 p-6",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Phase Data Requirements"}),u.jsxs("p",{className:"text-sm text-white/50",children:["Configure the data fields required or optional for ",o.display_name]})]}),u.jsx("div",{className:"space-y-4",children:((te=p[o.id])==null?void 0:te.length)>0?p[o.id].map(O=>u.jsx("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10",children:u.jsx("div",{className:"flex items-start justify-between",children:u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("span",{className:"font-medium",children:O.name}),u.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${O.required?"bg-red-500/20 text-red-400 border border-red-500/30":"bg-green-500/20 text-green-400 border border-green-500/30"}`,children:O.required?"Required":"Optional"}),u.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-violet-500/20 text-violet-400 border border-violet-500/30",children:O.data_type})]}),u.jsx("p",{className:"text-sm text-white/60",children:O.description})]})})},O.id)):u.jsxs("div",{className:"text-center py-12 text-white/40",children:[u.jsx(Xa,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),u.jsx("p",{children:"No data fields configured for this phase"})]})})]},"data"),e==="visualization"&&u.jsxs(oe.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-white/5 rounded-xl border border-white/10 p-6",children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Workflow Overview"}),u.jsx("p",{className:"text-sm text-white/50",children:"Complete therapy session flow with phase requirements and statistics"})]}),u.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-8",children:[u.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[u.jsx("div",{className:"text-2xl font-bold text-violet-400",children:r.length}),u.jsx("div",{className:"text-xs text-white/50 mt-1",children:"Total Phases"})]}),u.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[u.jsx("div",{className:"text-2xl font-bold text-green-400",children:Object.keys(l).length}),u.jsx("div",{className:"text-xs text-white/50 mt-1",children:"Prompts Configured"})]}),u.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[u.jsx("div",{className:"text-2xl font-bold text-blue-400",children:r.reduce((O,J)=>O+(J.minimum_turns||0),0)}),u.jsx("div",{className:"text-xs text-white/50 mt-1",children:"Total Min Turns"})]}),u.jsxs("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:[u.jsxs("div",{className:"text-2xl font-bold text-amber-400",children:[Math.round(r.reduce((O,J)=>O+(J.recommended_duration_seconds||0),0)/60),"m"]}),u.jsx("div",{className:"text-xs text-white/50 mt-1",children:"Est. Duration"})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute left-12 top-0 bottom-0 w-0.5 bg-gradient-to-b from-violet-500/20 via-blue-500/20 to-green-500/20"}),u.jsx("div",{className:"space-y-6",children:r.map((O,J)=>{var ht,ss,rs;const fe=!!l[O.id],je=(((ht=p[O.id])==null?void 0:ht.length)||0)>0,Ke=((ss=p[O.id])==null?void 0:ss.filter(An=>An.required).length)||0,$e=((rs=p[O.id])==null?void 0:rs.filter(An=>!An.required).length)||0;return u.jsxs("div",{className:"flex items-start gap-4 relative",children:[u.jsxs("div",{className:"w-24 h-24 rounded-2xl flex flex-col items-center justify-center backdrop-blur-sm border-2 relative z-10",style:{background:O.color?`linear-gradient(135deg, ${O.color}30 0%, ${O.color}10 100%)`:"linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%)",borderColor:O.color||"rgba(255,255,255,0.2)"},children:[u.jsx(Oo,{icon:O.icon||"",className:"w-8 h-8 mb-1"}),u.jsxs("div",{className:"text-xs font-medium text-white/70",children:["Phase ",J+1]})]}),u.jsxs("div",{className:"flex-1 bg-white/5 rounded-xl border border-white/10 p-5",children:[u.jsxs("div",{className:"flex items-start justify-between mb-3",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-lg",style:{color:O.color||"white"},children:O.display_name}),u.jsx("p",{className:"text-sm text-white/60 mt-1",children:O.description})]}),u.jsxs("div",{className:"flex gap-2",children:[fe&&u.jsx("div",{className:"w-8 h-8 rounded-lg bg-green-500/20 border border-green-500/30 flex items-center justify-center",title:"Prompt configured",children:u.jsx(Gr,{className:"w-4 h-4 text-green-400"})}),je&&u.jsx("div",{className:"w-8 h-8 rounded-lg bg-blue-500/20 border border-blue-500/30 flex items-center justify-center",title:"Has data fields",children:u.jsx(Xa,{className:"w-4 h-4 text-blue-400"})})]})]}),u.jsxs("div",{className:"grid grid-cols-4 gap-3 text-xs",children:[(O.minimum_turns??0)>0&&u.jsxs("div",{className:"bg-white/5 rounded-lg px-3 py-2 flex items-center gap-2",children:[u.jsx(cn,{className:"w-3.5 h-3.5 text-violet-400"}),u.jsxs("span",{className:"text-white/70",children:[O.minimum_turns," min turns"]})]}),(O.recommended_duration_seconds??0)>0&&u.jsxs("div",{className:"bg-white/5 rounded-lg px-3 py-2 flex items-center gap-2",children:[u.jsx(If,{className:"w-3.5 h-3.5 text-amber-400"}),u.jsxs("span",{className:"text-white/70",children:[Math.round((O.recommended_duration_seconds??0)/60),"m duration"]})]}),Ke>0&&u.jsxs("div",{className:"bg-white/5 rounded-lg px-3 py-2 flex items-center gap-2",children:[u.jsx(zr,{className:"w-3.5 h-3.5 text-red-400"}),u.jsxs("span",{className:"text-white/70",children:[Ke," required"]})]}),$e>0&&u.jsxs("div",{className:"bg-white/5 rounded-lg px-3 py-2 flex items-center gap-2",children:[u.jsx(_s,{className:"w-3.5 h-3.5 text-green-400"}),u.jsxs("span",{className:"text-white/70",children:[$e," optional"]})]})]})]}),J===r.length-1&&u.jsx("div",{className:"absolute -bottom-16 left-12 transform -translate-x-1/2",children:u.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-green-500/30 to-green-600/20 border-2 border-green-500/50 flex items-center justify-center",children:u.jsx(_s,{className:"w-8 h-8 text-green-400"})})})]},O.id)})})]})]},"visualization")]})})]}),u.jsx(kc,{children:V&&u.jsx(oe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-6 z-50",onClick:()=>E(!1),children:u.jsxs(oe.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},className:"bg-gray-900 rounded-xl p-6 max-w-4xl w-full max-h-[80vh] overflow-y-auto",onClick:O=>O.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h3",{className:"text-xl font-semibold",children:"Prompt Version History"}),u.jsx("button",{onClick:()=>E(!1),className:"p-2 hover:bg-white/5 rounded-lg",children:"×"})]}),u.jsx("div",{className:"space-y-4",children:d.map(O=>u.jsxs("div",{className:"p-4 bg-white/5 rounded-lg border border-white/10",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("span",{className:"font-medium",children:["Version ",O.version]}),u.jsx("span",{className:"text-sm text-white/50",children:new Date(O.created_at).toLocaleString()}),O.created_by&&u.jsxs("span",{className:"text-sm text-white/50",children:["by ",O.created_by]})]}),u.jsxs("button",{onClick:()=>R(O.id),className:"px-3 py-1 text-sm bg-violet-500 hover:bg-violet-600 rounded-lg flex items-center gap-1",children:[u.jsx(vy,{className:"w-3 h-3"}),"Revert"]})]}),u.jsxs("pre",{className:"text-sm text-white/70 whitespace-pre-wrap font-mono",children:[O.content.substring(0,200),"..."]})]},O.id))})]})})})]})})},Tp=t=>{},xw=b.createContext({user:null,userPermissions:null,loading:!0,error:null,signInWithGoogle:async()=>{},signInWithEmail:async()=>{},signOut:async()=>{},checkAccess:()=>!1,isAuthenticated:!1,isAuthorized:!1,idToken:null}),vi=()=>{const t=b.useContext(xw);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t},Oj=["qshi@bangor-bsp.com","root@acadia.sh","demo@acadia.sh","test@acadia.sh"],Fj=({children:t})=>{const[e,n]=b.useState(null),[s,r]=b.useState(null),[i,o]=b.useState(!0),[c,l]=b.useState(null),[h,d]=b.useState(null),m=async T=>T.email?Oj.includes(T.email.toLowerCase())?(console.log(`Access granted for whitelisted email: ${T.email}`),{email:T.email,role:"therapist",permissions:["view","edit","create"],createdAt:new Date,isActive:!0}):(console.warn(`Access denied for email: ${T.email}`),null):(console.warn("No email found for user"),null),p=async T=>{try{const k=await T.getIdToken();d(k),sessionStorage.setItem("firebase_token",k),Tp(k),setTimeout(()=>{ve!=null&&ve.currentUser&&p(ve.currentUser)},55*60*1e3)}catch(k){console.error("Error getting ID token:",k)}};b.useEffect(()=>{if(!ve){o(!1),l("Authentication service not available");return}const T=_P(ve,async k=>{if(o(!0),l(null),k){n(k),await p(k);const L=await m(k);L?(r(L),console.log("User authenticated:",k.email)):(l("Access denied. Your account is not authorized to use this application."),r(null),ve&&await Zf(ve))}else n(null),r(null),d(null),sessionStorage.removeItem("firebase_token");o(!1)});return()=>T()},[]);const S={user:e,userPermissions:s,loading:i,error:c,signInWithGoogle:async()=>{if(!ve)throw new Error("Authentication service not available");l(null),o(!0);try{await OP(ve,fa)}catch(T){throw console.error("Google sign-in error:",T),l(T.message||"Failed to sign in with Google"),o(!1),T}},signInWithEmail:async(T,k)=>{if(!ve)throw new Error("Authentication service not available");l(null),o(!0);try{await pP(ve,T,k)}catch(L){throw console.error("Email sign-in error:",L),l(L.message||"Failed to sign in"),o(!1),L}},signOut:async()=>{if(ve){o(!0);try{console.log("User signing out:",e==null?void 0:e.email),await Zf(ve),n(null),r(null),d(null),sessionStorage.removeItem("firebase_token"),Tp(null)}catch(T){console.error("Sign out error:",T),l(T.message||"Failed to sign out")}finally{o(!1)}}},checkAccess:T=>s?!T||s.role==="admin"?!0:s.permissions.includes(T):!1,isAuthenticated:!!e,isAuthorized:!!s,idToken:h};return u.jsx(xw.Provider,{value:S,children:t})},Uj=()=>{const{user:t}=vi(),[e,n]=b.useState(!1),s=b.useRef(null),r=Os();b.useEffect(()=>{const l=h=>{s.current&&!s.current.contains(h.target)&&n(!1)};return document.addEventListener("mousedown",l),()=>document.removeEventListener("mousedown",l)},[]);const i=()=>{r("/logout")};if(!t)return null;console.log("User Avatar Debug:",{email:t.email,displayName:t.displayName,photoURL:t.photoURL,uid:t.uid});const o=(l,h)=>{if(h){const m=h.trim().split(" ");return m.length>=2?(m[0][0]+m[m.length-1][0]).toUpperCase():h.substring(0,2).toUpperCase()}const d=l.split("@")[0];if(d.includes(".")){const m=d.split(".");return(m[0][0]+m[m.length-1][0]).toUpperCase()}if(d.includes("_")){const m=d.split("_");return(m[0][0]+m[m.length-1][0]).toUpperCase()}if(d.includes("-")){const m=d.split("-");return(m[0][0]+m[m.length-1][0]).toUpperCase()}return d.substring(0,2).toUpperCase()},c=t.email?o(t.email,t.displayName):"U";return u.jsxs("div",{className:"relative",ref:s,children:[u.jsxs("button",{onClick:()=>n(!e),className:"flex items-center gap-2 p-2 rounded-lg hover:bg-gray-800 transition-colors",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden flex items-center justify-center",children:t.photoURL?u.jsx("img",{src:t.photoURL,alt:t.displayName||t.email||"User",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"}):u.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold",children:u.jsx("span",{children:c})})}),u.jsx(dI,{className:`w-4 h-4 text-gray-400 transition-transform ${e?"rotate-180":""}`})]}),e&&u.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-50",children:[u.jsx("div",{className:"p-4 border-b border-gray-700",children:u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden flex items-center justify-center",children:t.photoURL?u.jsx("img",{src:t.photoURL,alt:t.displayName||t.email||"User",className:"w-full h-full object-cover",referrerPolicy:"no-referrer"}):u.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold",children:u.jsx("span",{children:c})})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"text-sm font-medium text-white truncate",children:t.displayName||"User"}),u.jsx("p",{className:"text-xs text-gray-400 truncate",children:t.email})]})]})}),u.jsxs("div",{className:"p-2",children:[u.jsxs("button",{onClick:()=>{n(!1),r("/profile")},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-300 hover:bg-gray-700 rounded-md transition-colors",children:[u.jsx(Nr,{className:"w-4 h-4"}),u.jsx("span",{children:"Profile"})]}),u.jsxs("button",{onClick:()=>{n(!1),i()},className:"w-full flex items-center gap-3 px-3 py-2 text-sm text-red-400 hover:bg-red-900/20 rounded-md transition-colors",children:[u.jsx($I,{className:"w-4 h-4"}),u.jsx("span",{children:"Logout"})]})]})]})]})},Me={DASHBOARD:"dashboard",PATIENTS:"patients",THERAPISTS:"therapists",SESSIONS:"sessions",CHAT_SESSION:"chat-session",WORKFLOW_STUDIO:"workflow-studio"},$j=t=>{switch(t){case Me.DASHBOARD:return"Dashboard";case Me.PATIENTS:return"Patients";case Me.THERAPISTS:return"Therapists";case Me.SESSIONS:return"Sessions";case Me.CHAT_SESSION:return"";case Me.WORKFLOW_STUDIO:return"Workflow Studio";default:return""}},Bj=()=>{const t=Os(),e=xt(),[n,s]=b.useState(Me.DASHBOARD),[r,i]=b.useState([]),[o,c]=b.useState([]),[l,h]=b.useState(""),[d,m]=b.useState(!0),[p,y]=b.useState("");b.useEffect(()=>{(async()=>{try{const Z=await(await fetch(be("/version"))).json();y(Z.build_time||"unknown")}catch(B){console.error("Failed to fetch backend version:",B),y("offline")}})()},[]);const[x,P]=b.useState(null),[C,S]=b.useState(!1),[T,k]=b.useState(!1);b.useEffect(()=>{const _=e.pathname;console.log("🔄 Navigation effect triggered, path:",_,"current viewState:",n);let B=null,Z=null;if(_==="/"||_==="/dashboard")B=Me.DASHBOARD;else if(_==="/patients")B=Me.PATIENTS;else if(_==="/therapists")B=Me.THERAPISTS;else if(_==="/sessions")B=Me.SESSIONS;else if(_.startsWith("/sessions/"))Z=_.split("/")[2],B=Me.CHAT_SESSION;else if(_==="/workflow-studio")B=Me.WORKFLOW_STUDIO;else{console.log("❌ Unknown path:",_);return}B&&B!==n&&(console.log("✅ Setting viewState to",B),s(B)),Z&&Z!==x&&(console.log("✅ Setting activeSessionId to",Z),P(Z))},[e.pathname]);const L=(_,B)=>{switch(console.log("🚀 navigateToView called with:",_,B),s(_),_){case"dashboard":console.log("📍 Navigating to /"),t("/");break;case"patients":console.log("📍 Navigating to /patients"),t("/patients");break;case"therapists":console.log("📍 Navigating to /therapists"),t("/therapists");break;case"sessions":console.log("📍 Navigating to /sessions"),t("/sessions");break;case"chat-session":B&&(console.log("📍 Navigating to /sessions/"+B),t(`/sessions/${B}`));break;case Me.WORKFLOW_STUDIO:console.log("📍 Navigating to /workflow-studio"),t("/workflow-studio");break}};b.useEffect(()=>{(async()=>{await V(),await D()})()},[]);const D=async()=>{try{console.log("📊 Loading patients...");const _=await Pe(be("/api/patients"));if(!_.ok)throw console.error("❌ Patients API error:",_.status),new Error(`HTTP error! status: ${_.status}`);const B=await _.json();console.log("✅ Loaded patients:",B);const ae=(B.patients||B).map(te=>({id:te.id,name:te.name,email:te.email||"",lastSession:te.last_session_date?new Date(te.last_session_date).toLocaleDateString():"No sessions yet",intakeComplete:te.intake_complete||!1,primaryConcerns:te.primary_concerns||[],assignedTherapist:"Loading..."}));i(ae),console.log("✅ Patients state updated:",ae.length)}catch(_){console.error("❌ Failed to load patients:",_)}finally{m(!1)}},V=async()=>{try{console.log("Loading therapists...");const _=await Pe(be("/api/therapists"));if(!_.ok)throw new Error(`HTTP error! status: ${_.status}`);const B=await _.json();console.log("Loaded therapists:",B);const Z=B.map(ae=>({id:ae.id,name:ae.name,email:ae.email||"",specialty:ae.specialty||"General Practice",license:ae.license||"",active:!0}));c(Z),console.log("Therapists state updated:",Z.length)}catch(_){console.error("Failed to load therapists:",_)}},E=_=>{P(_),L("chat-session",_)},v=async _=>{var B;try{S(!1)}catch(Z){const ae=((B=Z==null?void 0:Z.body)==null?void 0:B.message)||(Z==null?void 0:Z.message)||"Failed to create patient";console.error("❌ Failed to create patient:",ae),alert(ae)}},I=async _=>{try{(await Pe(be("/api/therapists"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)})).ok?(console.log("✅ Therapist created successfully"),k(!1),V()):console.error("❌ Failed to create therapist")}catch(B){console.error("❌ Error creating therapist:",B)}},N=r.filter(_=>_.name.toLowerCase().includes(l.toLowerCase())||_.email.toLowerCase().includes(l.toLowerCase())),A=o.filter(_=>_.name.toLowerCase().includes(l.toLowerCase())||_.specialty.toLowerCase().includes(l.toLowerCase())),R=({icon:_,label:B,isActive:Z,onClick:ae})=>u.jsxs(oe.button,{whileHover:{x:2},whileTap:{scale:.98},onClick:ae,className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all ${Z?"bg-white/10 text-white border border-white/20":"text-white/60 hover:text-white/90 hover:bg-white/5"}`,children:[u.jsx(_,{className:"w-4 h-4"}),u.jsx("span",{className:"text-sm font-medium",children:B})]});return u.jsxs("div",{className:"min-h-screen bg-black flex",children:[u.jsxs("div",{className:"fixed inset-0",children:[u.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black via-gray-950 to-black"}),u.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-blue-600/10 rounded-full filter blur-[128px]"}),u.jsx("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-purple-600/10 rounded-full filter blur-[128px]"})]}),u.jsx("div",{className:"relative z-10 w-64 border-r border-white/5 backdrop-blur-xl bg-white/[0.01]",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[u.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center",children:u.jsx(ys,{className:"w-4 h-4 text-white"})}),u.jsx("span",{className:"text-sm font-medium text-white/90",children:"Therapy Navigation"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx(R,{icon:VI,label:"Dashboard",isActive:n==="dashboard",onClick:()=>L("dashboard")}),u.jsx(R,{icon:Pr,label:"Patients",isActive:n==="patients",onClick:()=>L("patients")}),u.jsx(R,{icon:Ja,label:"Therapists",isActive:n==="therapists",onClick:()=>L("therapists")}),u.jsx(R,{icon:cn,label:"Sessions",isActive:n==="sessions",onClick:()=>L("sessions")}),u.jsx("div",{className:"my-4 border-t border-white/[0.05]"}),u.jsx(R,{icon:Kr,label:"Workflow Studio",isActive:n===Me.WORKFLOW_STUDIO,onClick:()=>L("workflow-studio")})]}),p&&u.jsx("div",{className:"mt-auto pt-4 px-2",children:u.jsxs("div",{className:"text-xs text-white/40 font-mono",children:["Backend: ",p.split("_")[1]||p]})})]})}),u.jsxs("div",{className:"relative z-10 flex-1 flex flex-col",children:[n!==Me.CHAT_SESSION&&u.jsx("nav",{className:"sticky top-0 z-50 border-b backdrop-blur-xl",style:{backgroundColor:"rgba(255,255,255,0.01)",borderColor:"rgba(255,255,255,0.05)"},children:u.jsx("div",{className:"px-6 py-4",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("div",{children:u.jsx("h1",{className:"text-lg font-medium text-white/90",children:$j(n)})}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("button",{className:"text-white/60 hover:text-white/90 transition-colors",children:u.jsx(su,{className:"w-4 h-4"})}),u.jsx(Uj,{})]})]})})}),u.jsx(kc,{mode:"wait",children:u.jsxs("div",{className:"flex-1 overflow-hidden",children:[n==="dashboard"&&u.jsx(oe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"p-8",children:u.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsx("div",{className:"p-6 bg-white/[0.02] border border-white/[0.05] rounded-2xl backdrop-blur-xl",children:u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:"w-12 h-12 rounded-xl bg-blue-500/20 flex items-center justify-center",children:u.jsx(Pr,{className:"w-6 h-6 text-blue-400"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-2xl font-bold text-white/90",children:r.length}),u.jsx("p",{className:"text-sm text-white/60",children:"Total Patients"})]})]})}),u.jsx("div",{className:"p-6 bg-white/[0.02] border border-white/[0.05] rounded-2xl backdrop-blur-xl",children:u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-500/20 flex items-center justify-center",children:u.jsx(Ja,{className:"w-6 h-6 text-purple-400"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-2xl font-bold text-white/90",children:o.length}),u.jsx("p",{className:"text-sm text-white/60",children:"Active Therapists"})]})]})}),u.jsx("div",{className:"p-6 bg-white/[0.02] border border-white/[0.05] rounded-2xl backdrop-blur-xl",children:u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:"w-12 h-12 rounded-xl bg-green-500/20 flex items-center justify-center",children:u.jsx(cn,{className:"w-6 h-6 text-green-400"})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-2xl font-bold text-white/90",children:"-"}),u.jsx("p",{className:"text-sm text-white/60",children:"Sessions Available Below"})]})]})})]}),u.jsxs("div",{className:"mb-8",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-light text-white/90",children:"Active Sessions"}),u.jsx("p",{className:"text-sm text-white/60",children:"Sessions with live WebSocket connections"})]}),u.jsx(oe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>L("sessions"),className:"px-4 py-2 bg-white/[0.02] border border-white/[0.05] rounded-lg text-white/60 hover:text-white/80 text-sm",children:"View All Sessions →"})]}),u.jsx("div",{className:"bg-white/[0.02] border border-white/[0.05] rounded-2xl backdrop-blur-xl p-6",children:u.jsx(yp,{onSessionSelect:E,showActiveOnly:!1})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsx(oe.button,{whileHover:{y:-2},onClick:async()=>{try{console.log("Creating quick coach session...");const _=await Pe(be("/api/sessions"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:"3b9e936b-476b-4dd7-93bc-357943438334",therapist_id:"5b69a8ad-eeda-48ef-9a97-80725c88308a",start_time:new Date().toISOString()})});if(!_.ok)throw new Error(`API error: ${_.status}`);const B=await _.json();console.log("✅ Quick coach session created:",B.id),L("chat-session",B.id)}catch(_){console.error("Failed to create coaching session:",_)}},className:"p-8 bg-gradient-to-br from-green-600/20 to-blue-600/20 border border-green-400/20 rounded-2xl backdrop-blur-xl text-left group",children:u.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[u.jsx("div",{className:"w-16 h-16 rounded-2xl bg-green-400/10 flex items-center justify-center",children:u.jsx(Tf,{className:"w-8 h-8 text-green-400/80"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-medium text-white/90 mb-1",children:"🧠 Quick Coach Session"}),u.jsx("p",{className:"text-white/60",children:"Start brainspotting coaching immediately"})]})]})}),u.jsx(oe.button,{whileHover:{y:-2},onClick:()=>L("sessions"),className:"p-8 bg-gradient-to-br from-blue-600/10 to-purple-600/10 border border-white/10 rounded-2xl backdrop-blur-xl text-left group",children:u.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[u.jsx("div",{className:"w-16 h-16 rounded-2xl bg-white/10 flex items-center justify-center",children:u.jsx(Tf,{className:"w-8 h-8 text-white/80"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-medium text-white/90 mb-1",children:"Manage Sessions"}),u.jsx("p",{className:"text-white/60",children:"Full session management (future clinical use)"})]})]})}),u.jsx(oe.button,{whileHover:{y:-2},onClick:()=>L("patients"),className:"p-8 bg-white/[0.02] border border-white/[0.05] rounded-2xl backdrop-blur-xl text-left group",children:u.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[u.jsx("div",{className:"w-16 h-16 rounded-2xl bg-white/[0.05] flex items-center justify-center",children:u.jsx(Pr,{className:"w-8 h-8 text-white/60"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-medium text-white/90 mb-1",children:"Manage Patients"}),u.jsx("p",{className:"text-white/60",children:"View and manage patient profiles"})]})]})})]})]})},"dashboard"),n==="patients"&&u.jsx(oe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"p-8",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[u.jsxs("div",{className:"flex-1 relative",children:[u.jsx(Bc,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-white/40"}),u.jsx("input",{type:"text",placeholder:"Search patients...",value:l,onChange:_=>h(_.target.value),className:"w-full pl-12 pr-4 py-3 bg-white/[0.03] border border-white/[0.05] rounded-xl text-white/80 placeholder-white/30 text-sm focus:outline-none focus:border-white/10 backdrop-blur-xl"})]}),u.jsxs(oe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>S(!0),className:"px-6 py-3 bg-gradient-to-r from-blue-600/20 to-purple-600/20 border border-white/10 rounded-xl text-white/90 text-sm font-medium backdrop-blur-xl flex items-center gap-2",children:[u.jsx(go,{className:"w-4 h-4"}),"New Patient"]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d?u.jsx("div",{className:"col-span-full flex items-center justify-center py-20",children:u.jsx("div",{className:"w-8 h-8 border-2 border-white/20 border-t-white/60 rounded-full animate-spin"})}):N.length===0?u.jsx("div",{className:"col-span-full",children:u.jsx(_p,{type:"patients"})}):N.map(_=>u.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileHover:{y:-2},className:"group cursor-pointer",children:u.jsxs("div",{className:"p-6 bg-white/[0.02] border border-white/[0.05] rounded-2xl backdrop-blur-xl hover:bg-white/[0.04] transition-all",children:[u.jsxs("div",{className:"flex items-start justify-between mb-4",children:[u.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500/20 to-purple-600/20 flex items-center justify-center",children:u.jsx("span",{className:"text-white/80 font-medium",children:_.name?_.name.split(" ").map(B=>B[0]).join(""):"?"})}),u.jsx(nu,{className:"w-4 h-4 text-white/20 group-hover:text-white/40 transition-colors"})]}),u.jsx("h3",{className:"text-white/90 font-medium mb-1",children:_.name}),u.jsx("p",{className:"text-white/40 text-sm mb-3",children:_.email}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center justify-between text-xs",children:[u.jsx("span",{className:"text-white/30",children:"Therapist"}),u.jsx("span",{className:"text-white/60",children:_.assignedTherapist||"Not assigned"})]}),u.jsxs("div",{className:"flex items-center justify-between text-xs",children:[u.jsx("span",{className:"text-white/30",children:"Last Session"}),u.jsx("span",{className:"text-white/60",children:_.lastSession})]}),_.intakeComplete?u.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-green-400/80",children:[u.jsx("div",{className:"w-1.5 h-1.5 bg-green-400 rounded-full"}),"Intake Complete"]}):u.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-amber-400/80",children:[u.jsx("div",{className:"w-1.5 h-1.5 bg-amber-400 rounded-full"}),"Intake Pending"]})]})]})},_.id))})]})},"patients"),n==="therapists"&&u.jsx(oe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"p-8",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[u.jsxs("div",{className:"flex-1 relative",children:[u.jsx(Bc,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-4 h-4 text-white/40"}),u.jsx("input",{type:"text",placeholder:"Search therapists...",value:l,onChange:_=>h(_.target.value),className:"w-full pl-12 pr-4 py-3 bg-white/[0.03] border border-white/[0.05] rounded-xl text-white/80 placeholder-white/30 text-sm focus:outline-none focus:border-white/10 backdrop-blur-xl"})]}),u.jsxs(oe.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>k(!0),className:"px-6 py-3 bg-gradient-to-r from-purple-600/20 to-blue-600/20 border border-white/10 rounded-xl text-white/90 text-sm font-medium backdrop-blur-xl flex items-center gap-2",children:[u.jsx(go,{className:"w-4 h-4"}),"New Therapist"]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d?u.jsx("div",{className:"col-span-full flex items-center justify-center py-20",children:u.jsx("div",{className:"w-8 h-8 border-2 border-white/20 border-t-white/60 rounded-full animate-spin"})}):A.length===0?u.jsx("div",{className:"col-span-full",children:u.jsx(_p,{type:"therapists"})}):A.map(_=>u.jsx(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},whileHover:{y:-2},className:"group cursor-pointer",children:u.jsxs("div",{className:"p-6 bg-white/[0.02] border border-white/[0.05] rounded-2xl backdrop-blur-xl hover:bg-white/[0.04] transition-all",children:[u.jsxs("div",{className:"flex items-start justify-between mb-4",children:[u.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-purple-500/20 to-blue-600/20 flex items-center justify-center",children:u.jsx("span",{className:"text-white/80 font-medium",children:_.name?_.name.split(" ").map(B=>B[0]).join(""):"?"})}),u.jsx("div",{className:`w-2 h-2 rounded-full ${_.active?"bg-green-400":"bg-red-400"}`})]}),u.jsx("h3",{className:"text-white/90 font-medium mb-1",children:_.name}),u.jsx("p",{className:"text-white/40 text-sm mb-3",children:_.email}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center justify-between text-xs",children:[u.jsx("span",{className:"text-white/30",children:"Specialty"}),u.jsx("span",{className:"text-white/60",children:_.specialty})]}),u.jsxs("div",{className:"flex items-center gap-1.5 text-xs text-purple-400/80",children:[u.jsx(Ja,{className:"w-3 h-3"}),"Licensed Professional"]})]})]})},_.id))})]})},"therapists"),n==="sessions"&&u.jsx(oe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"p-8 h-full",children:u.jsxs("div",{className:"h-full flex flex-col",children:[u.jsxs("div",{className:"mb-6",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[u.jsx(cn,{className:"w-6 h-6 text-white/80"}),u.jsx("h2",{className:"text-2xl font-light text-white/90",children:"Sessions"})]}),u.jsx("p",{className:"text-sm text-white/60",children:"Manage therapy sessions between patients and therapists"})]}),u.jsx("div",{className:"flex-1",children:u.jsx(yp,{onSessionSelect:E,showActiveOnly:!1})})]})},"sessions"),n==="chat-session"&&x&&u.jsx(oe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"h-full",children:u.jsx(Mj,{sessionId:x})},"chat-session"),n===Me.WORKFLOW_STUDIO&&u.jsx(oe.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"h-full overflow-auto",children:u.jsx(Lj,{})},"workflow-studio")]})})]}),C&&u.jsx(qj,{onClose:()=>S(!1),onSubmit:v}),T&&u.jsx(Wj,{onClose:()=>k(!1),onSubmit:I})]})},qj=({onClose:t,onSubmit:e})=>{const[n,s]=b.useState({name:""}),r=i=>{i.preventDefault(),e({name:n.name})};return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-black/80 border border-white/20 rounded-xl p-6 w-96 backdrop-blur-xl",children:[u.jsx("h3",{className:"text-white/90 font-medium mb-4",children:"Add New Patient"}),u.jsxs("form",{onSubmit:r,className:"space-y-4",children:[u.jsx("input",{type:"text",placeholder:"Full Name",value:n.name,onChange:i=>s(o=>({...o,name:i.target.value})),className:"w-full p-2 bg-white/5 border border-white/20 rounded text-white/80 text-sm",required:!0}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{type:"button",onClick:t,className:"flex-1 p-2 border border-white/20 rounded text-white/60 hover:text-white/80 transition-colors text-sm",children:"Cancel"}),u.jsx("button",{type:"submit",className:"flex-1 p-2 bg-blue-500/20 border border-blue-500/30 rounded text-blue-400 hover:bg-blue-500/30 transition-colors text-sm",children:"Add Patient"})]})]})]})})},Wj=({onClose:t,onSubmit:e})=>{const[n,s]=b.useState({name:"",email:"",specialty:"",license_number:"",years_experience:"",bio:""}),r=i=>{i.preventDefault(),e({...n,years_experience:parseInt(n.years_experience)||0})};return u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-black/80 border border-white/20 rounded-xl p-6 w-96 backdrop-blur-xl",children:[u.jsx("h3",{className:"text-white/90 font-medium mb-4",children:"Add New Therapist"}),u.jsxs("form",{onSubmit:r,className:"space-y-4",children:[u.jsx("input",{type:"text",placeholder:"Full Name",value:n.name,onChange:i=>s(o=>({...o,name:i.target.value})),className:"w-full p-2 bg-white/5 border border-white/20 rounded text-white/80 text-sm",required:!0}),u.jsx("input",{type:"email",placeholder:"Email",value:n.email,onChange:i=>s(o=>({...o,email:i.target.value})),className:"w-full p-2 bg-white/5 border border-white/20 rounded text-white/80 text-sm",required:!0}),u.jsx("input",{type:"text",placeholder:"Specialty",value:n.specialty,onChange:i=>s(o=>({...o,specialty:i.target.value})),className:"w-full p-2 bg-white/5 border border-white/20 rounded text-white/80 text-sm",required:!0}),u.jsx("input",{type:"text",placeholder:"License Number",value:n.license_number,onChange:i=>s(o=>({...o,license_number:i.target.value})),className:"w-full p-2 bg-white/5 border border-white/20 rounded text-white/80 text-sm"}),u.jsx("input",{type:"number",placeholder:"Years Experience",value:n.years_experience,onChange:i=>s(o=>({...o,years_experience:i.target.value})),className:"w-full p-2 bg-white/5 border border-white/20 rounded text-white/80 text-sm"}),u.jsx("textarea",{placeholder:"Bio",value:n.bio,onChange:i=>s(o=>({...o,bio:i.target.value})),className:"w-full p-2 bg-white/5 border border-white/20 rounded text-white/80 text-sm h-20"}),u.jsxs("div",{className:"flex gap-3",children:[u.jsx("button",{type:"button",onClick:t,className:"flex-1 p-2 border border-white/20 rounded text-white/60 hover:text-white/80 transition-colors text-sm",children:"Cancel"}),u.jsx("button",{type:"submit",className:"flex-1 p-2 bg-purple-500/20 border border-purple-500/30 rounded text-purple-400 hover:bg-purple-500/30 transition-colors text-sm",children:"Add Therapist"})]})]})]})})};var zj=(t,e,n,s,r,i,o,c)=>{let l=document.documentElement,h=["light","dark"];function d(y){(Array.isArray(t)?t:[t]).forEach(x=>{let P=x==="class",C=P&&i?r.map(S=>i[S]||S):r;P?(l.classList.remove(...C),l.classList.add(i&&i[y]?i[y]:y)):l.setAttribute(x,y)}),m(y)}function m(y){c&&h.includes(y)&&(l.style.colorScheme=y)}function p(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(s)d(s);else try{let y=localStorage.getItem(e)||n,x=o&&y==="system"?p():y;d(x)}catch{}},Ep=["light","dark"],vw="(prefers-color-scheme: dark)",Hj=typeof window>"u",bw=b.createContext(void 0),Gj=t=>b.useContext(bw)?b.createElement(b.Fragment,null,t.children):b.createElement(Qj,{...t}),Kj=["light","dark"],Qj=({forcedTheme:t,disableTransitionOnChange:e=!1,enableSystem:n=!0,enableColorScheme:s=!0,storageKey:r="theme",themes:i=Kj,defaultTheme:o=n?"system":"light",attribute:c="data-theme",value:l,children:h,nonce:d,scriptProps:m})=>{let[p,y]=b.useState(()=>Xj(r,o)),[x,P]=b.useState(()=>p==="system"?pc():p),C=l?Object.values(l):i,S=b.useCallback(D=>{let V=D;if(!V)return;D==="system"&&n&&(V=pc());let E=l?l[V]:V,v=e?Jj(d):null,I=document.documentElement,N=A=>{A==="class"?(I.classList.remove(...C),E&&I.classList.add(E)):A.startsWith("data-")&&(E?I.setAttribute(A,E):I.removeAttribute(A))};if(Array.isArray(c)?c.forEach(N):N(c),s){let A=Ep.includes(o)?o:null,R=Ep.includes(V)?V:A;I.style.colorScheme=R}v==null||v()},[d]),T=b.useCallback(D=>{let V=typeof D=="function"?D(p):D;y(V);try{localStorage.setItem(r,V)}catch{}},[p]),k=b.useCallback(D=>{let V=pc(D);P(V),p==="system"&&n&&!t&&S("system")},[p,t]);b.useEffect(()=>{let D=window.matchMedia(vw);return D.addListener(k),k(D),()=>D.removeListener(k)},[k]),b.useEffect(()=>{let D=V=>{V.key===r&&(V.newValue?y(V.newValue):T(o))};return window.addEventListener("storage",D),()=>window.removeEventListener("storage",D)},[T]),b.useEffect(()=>{S(t??p)},[t,p]);let L=b.useMemo(()=>({theme:p,setTheme:T,forcedTheme:t,resolvedTheme:p==="system"?x:p,themes:n?[...i,"system"]:i,systemTheme:n?x:void 0}),[p,T,t,x,n,i]);return b.createElement(bw.Provider,{value:L},b.createElement(Yj,{forcedTheme:t,storageKey:r,attribute:c,enableSystem:n,enableColorScheme:s,defaultTheme:o,value:l,themes:i,nonce:d,scriptProps:m}),h)},Yj=b.memo(({forcedTheme:t,storageKey:e,attribute:n,enableSystem:s,enableColorScheme:r,defaultTheme:i,value:o,themes:c,nonce:l,scriptProps:h})=>{let d=JSON.stringify([n,e,i,t,c,o,s,r]).slice(1,-1);return b.createElement("script",{...h,suppressHydrationWarning:!0,nonce:typeof window>"u"?l:"",dangerouslySetInnerHTML:{__html:`(${zj.toString()})(${d})`}})}),Xj=(t,e)=>{if(Hj)return;let n;try{n=localStorage.getItem(t)||void 0}catch{}return n||e},Jj=t=>{let e=document.createElement("style");return t&&e.setAttribute("nonce",t),e.appendChild(document.createTextNode("*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(e),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(e)},1)}},pc=t=>(t||(t=window.matchMedia(vw)),t.matches?"dark":"light");const Zj=b.createContext(void 0);function eV({children:t}){const[e,n]=b.useState("slate");return b.useEffect(()=>{const s=localStorage.getItem("app-theme");s&&n(s)},[]),b.useEffect(()=>{localStorage.setItem("app-theme",e),document.documentElement.className=`theme-${e}`},[e]),u.jsx(Gj,{attribute:"class",defaultTheme:"dark",enableSystem:!1,children:u.jsx(Zj.Provider,{value:{theme:e,setTheme:n},children:t})})}const Ip=({children:t,requirePermission:e,fallbackPath:n="/login"})=>{const{isAuthenticated:s,isAuthorized:r,loading:i,checkAccess:o}=vi(),c=xt();return i?u.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx(Qr,{className:"w-8 h-8 text-blue-500 animate-spin mx-auto mb-4"}),u.jsx("p",{className:"text-gray-400",children:"Verifying authentication..."})]})}):s?r?e&&!o(e)?u.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-gray-800 rounded-lg border border-yellow-500/20 p-8 max-w-md w-full text-center",children:[u.jsx("div",{className:"w-16 h-16 bg-yellow-500/10 rounded-full flex items-center justify-center mx-auto mb-4",children:u.jsx("svg",{className:"w-8 h-8 text-yellow-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),u.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Insufficient Permissions"}),u.jsx("p",{className:"text-gray-400 mb-6",children:"You don't have the required permissions to access this feature."}),u.jsx("button",{onClick:()=>window.history.back(),className:"px-6 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Go Back"})]})}):u.jsx(u.Fragment,{children:t}):u.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-gray-800 rounded-lg border border-red-500/20 p-8 max-w-md w-full text-center",children:[u.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4",children:u.jsx("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),u.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Access Denied"}),u.jsx("p",{className:"text-gray-400 mb-6",children:"Your account is not authorized to access this application. Please contact your administrator for access."}),u.jsx("button",{onClick:()=>window.location.href=n,className:"px-6 py-2 bg-gray-700 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Return to Login"})]})}):u.jsx($x,{to:n,state:{from:c},replace:!0})},tV=()=>{var m,p;const{signInWithGoogle:t,isAuthenticated:e,isAuthorized:n,loading:s,error:r}=vi(),i=Os(),o=xt(),[c,l]=b.useState(!1),h=((p=(m=o.state)==null?void 0:m.from)==null?void 0:p.pathname)||"/";b.useEffect(()=>{e&&n&&i(h,{replace:!0})},[e,n,i,h]);const d=async()=>{l(!0);try{await t()}catch(y){console.error("Sign in error:",y)}finally{l(!1)}};return s?u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx(Qr,{className:"w-8 h-8 text-blue-500 animate-spin mx-auto mb-4"}),u.jsx("p",{className:"text-gray-400",children:"Loading..."})]})}):u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 flex items-center justify-center p-4",children:u.jsxs(oe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md",children:[u.jsxs("div",{className:"backdrop-blur-xl bg-white/5 rounded-3xl border border-white/10 shadow-2xl overflow-hidden",children:[u.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-8 text-center",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-white/20 backdrop-blur-md rounded-full mb-4",children:u.jsx(ys,{className:"w-10 h-10 text-white"})}),u.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Therapy Navigation System"}),u.jsx("p",{className:"text-white/80 text-sm",children:"AI-Powered Brainspotting Platform"})]}),u.jsxs("div",{className:"p-8",children:[r&&u.jsxs(oe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 p-4 bg-red-500/10 border border-red-500/20 rounded-lg flex items-start gap-3",children:[u.jsx(zr,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-red-400",children:r}),r.includes("not authorized")&&u.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Please contact your administrator to request access."})]})]}),u.jsx("button",{onClick:d,disabled:c||s,className:`
                w-full flex items-center justify-center gap-3 px-6 py-3
                bg-white text-gray-900 rounded-lg font-medium
                hover:bg-gray-100 active:bg-gray-200
                disabled:opacity-50 disabled:cursor-not-allowed
                transition-all duration-200 transform hover:scale-[1.02]
              `,children:c?u.jsxs(u.Fragment,{children:[u.jsx(Qr,{className:"w-5 h-5 animate-spin"}),u.jsx("span",{children:"Signing in..."})]}):u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[u.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),u.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),u.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),u.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),u.jsx("span",{children:"Sign in with Google"})]})}),u.jsxs("div",{className:"mt-6 text-center",children:[u.jsx("p",{className:"text-xs text-gray-400",children:"Secure authentication powered by Firebase"}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Only authorized accounts can access this system"})]})]}),u.jsx("div",{className:"px-8 py-4 bg-white/5 backdrop-blur-sm border-t border-white/10",children:u.jsx("p",{className:"text-xs text-center text-gray-500",children:"By signing in, you agree to our Terms of Service and Privacy Policy"})})]}),u.jsxs("div",{className:"mt-8 text-center",children:[u.jsx("p",{className:"text-sm text-gray-400",children:"Need access? Contact your administrator"}),u.jsx("a",{href:"mailto:support@therapy-nav.com",className:"text-sm text-blue-400 hover:text-blue-300 mt-2 inline-block",children:"support@therapy-nav.com"})]})]})})},nV=()=>{const{signOut:t}=vi(),e=Os();return b.useEffect(()=>{(async()=>{try{await t()}catch(s){console.error("Logout error:",s)}finally{e("/login")}})()},[t,e]),u.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),u.jsx("p",{className:"text-white/60",children:"Signing out..."})]})})},sV=()=>{const{user:t,checkAccess:e}=vi(),[n,s]=b.useState([]),[r,i]=b.useState(!0),[o,c]=b.useState(""),[l,h]=b.useState("viewer"),[d,m]=b.useState(!1),[p,y]=b.useState(null),[x,P]=b.useState(null),C=e("admin")||e("manage_users");b.useEffect(()=>{S()},[]);const S=async()=>{if(Lt){i(!0);try{const D=Wk(Rk(Lt,"allowed_users"),zk("createdAt","desc")),V=await Yk(D),E=[];V.forEach(v=>{var N;const I=v.data();E.push({email:v.id,role:I.role||"viewer",permissions:I.permissions||[],createdAt:((N=I.createdAt)==null?void 0:N.toDate())||new Date,createdBy:I.createdBy,isActive:I.isActive!==!1})}),s(E)}catch(D){console.error("Error loading users:",D),y("Failed to load users")}finally{i(!1)}}},T=async()=>{if(!Lt||!o)return;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o)){y("Please enter a valid email address");return}m(!0),y(null),P(null);try{const V={admin:["admin","manage_users","view","create","edit","delete"],therapist:["view","create","edit"],client:["view","create"],viewer:["view"]};await cp(hc(Lt,"allowed_users",o),{email:o,role:l,permissions:V[l],createdAt:he.now(),createdBy:t==null?void 0:t.email,isActive:!0}),P(`Successfully added ${o} as ${l}`),c(""),h("viewer"),await S()}catch(V){console.error("Error adding user:",V),y("Failed to add user")}finally{m(!1)}},k=async(D,V)=>{if(Lt)try{await cp(hc(Lt,"allowed_users",D),{isActive:!V},{merge:!0}),P(`User ${D} ${V?"deactivated":"activated"}`),await S()}catch(E){console.error("Error toggling user status:",E),y("Failed to update user status")}},L=async D=>{if(Lt&&confirm(`Are you sure you want to remove ${D}? This action cannot be undone.`))try{await Xk(hc(Lt,"allowed_users",D)),P(`Successfully removed ${D}`),await S()}catch(V){console.error("Error deleting user:",V),y("Failed to delete user")}};return C?u.jsx("div",{className:"min-h-screen bg-gray-900 p-6",children:u.jsxs("div",{className:"max-w-6xl mx-auto",children:[u.jsxs("div",{className:"mb-8",children:[u.jsxs("h1",{className:"text-3xl font-bold text-white mb-2 flex items-center gap-3",children:[u.jsx(Pr,{className:"w-8 h-8 text-blue-500"}),"User Management"]}),u.jsx("p",{className:"text-gray-400",children:"Manage authorized users and their permissions"})]}),p&&u.jsxs(oe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 p-4 bg-red-500/10 border border-red-500/20 rounded-lg flex items-start gap-3",children:[u.jsx(zr,{className:"w-5 h-5 text-red-400 flex-shrink-0"}),u.jsx("p",{className:"text-red-400",children:p})]}),x&&u.jsxs(oe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-6 p-4 bg-green-500/10 border border-green-500/20 rounded-lg flex items-start gap-3",children:[u.jsx(_s,{className:"w-5 h-5 text-green-400 flex-shrink-0"}),u.jsx("p",{className:"text-green-400",children:x})]}),u.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6 mb-8",children:[u.jsxs("h2",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[u.jsx(Pf,{className:"w-5 h-5"}),"Add New User"]}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[u.jsx("input",{type:"email",placeholder:"user@example.com",value:o,onChange:D=>c(D.target.value),className:"flex-1 px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-blue-500"}),u.jsxs("select",{value:l,onChange:D=>h(D.target.value),className:"px-4 py-2 bg-gray-900 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-blue-500",children:[u.jsx("option",{value:"viewer",children:"Viewer"}),u.jsx("option",{value:"client",children:"Client"}),u.jsx("option",{value:"therapist",children:"Therapist"}),u.jsx("option",{value:"admin",children:"Admin"})]}),u.jsx("button",{onClick:T,disabled:d||!o,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:d?u.jsxs(u.Fragment,{children:[u.jsx(Qr,{className:"w-4 h-4 animate-spin"}),"Adding..."]}):u.jsxs(u.Fragment,{children:[u.jsx(Pf,{className:"w-4 h-4"}),"Add User"]})})]})]}),u.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[u.jsx("div",{className:"p-6 border-b border-gray-700",children:u.jsx("h2",{className:"text-lg font-semibold text-white",children:"Authorized Users"})}),r?u.jsxs("div",{className:"p-12 text-center",children:[u.jsx(Qr,{className:"w-8 h-8 text-blue-500 animate-spin mx-auto mb-4"}),u.jsx("p",{className:"text-gray-400",children:"Loading users..."})]}):n.length===0?u.jsxs("div",{className:"p-12 text-center",children:[u.jsx(Pr,{className:"w-12 h-12 text-gray-600 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-400",children:"No users added yet"})]}):u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"border-b border-gray-700",children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Email"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Role"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Status"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Added"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-700",children:n.map(D=>u.jsxs("tr",{className:"hover:bg-gray-700/50 transition-colors",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(qI,{className:"w-4 h-4 text-gray-400"}),u.jsx("span",{className:"text-white",children:D.email})]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${D.role==="admin"?"bg-purple-500/20 text-purple-400":D.role==="therapist"?"bg-blue-500/20 text-blue-400":D.role==="client"?"bg-green-500/20 text-green-400":"bg-gray-500/20 text-gray-400"}`,children:D.role})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:D.isActive?u.jsxs("span",{className:"flex items-center gap-1 text-green-400",children:[u.jsx(_s,{className:"w-4 h-4"}),"Active"]}):u.jsxs("span",{className:"flex items-center gap-1 text-red-400",children:[u.jsx(Ef,{className:"w-4 h-4"}),"Inactive"]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm",children:[u.jsx($c,{className:"w-4 h-4"}),D.createdAt.toLocaleDateString()]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>k(D.email,D.isActive),className:"p-1 text-yellow-400 hover:bg-yellow-400/10 rounded",title:D.isActive?"Deactivate":"Activate",children:D.isActive?u.jsx(Ef,{className:"w-4 h-4"}):u.jsx(_s,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>L(D.email),className:"p-1 text-red-400 hover:bg-red-400/10 rounded",title:"Delete",children:u.jsx(wA,{className:"w-4 h-4"})})]})})]},D.email))})]})})]})]})}):u.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-4",children:u.jsxs("div",{className:"text-center",children:[u.jsx(by,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),u.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Admin Access Required"}),u.jsx("p",{className:"text-gray-400",children:"You don't have permission to access this page."})]})})};function rV(){return u.jsx(eV,{children:u.jsx(dv,{children:u.jsx(Fj,{children:u.jsx("div",{className:"min-h-screen bg-background",children:u.jsxs(qx,{children:[u.jsx(pr,{path:"/login",element:u.jsx(tV,{})}),u.jsx(pr,{path:"/logout",element:u.jsx(nV,{})}),u.jsx(pr,{path:"/admin",element:u.jsx(Ip,{requirePermission:"admin",children:u.jsx(sV,{})})}),u.jsx(pr,{path:"/*",element:u.jsx(Ip,{children:u.jsx(Bj,{})})})]})})})})})}const gc=document.getElementById("loading-screen");gc&&(gc.style.opacity="0",setTimeout(()=>{gc.style.display="none"},500));yc.createRoot(document.getElementById("root")).render(u.jsx(co.StrictMode,{children:u.jsx(rV,{})}));
//# sourceMappingURL=index-BLu4YIA_.js.map
